<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<section id="reference.dependencies">
  <title>Dependencies</title>

  <para>Free and open source software is highly modular, and MacPorts ports
  often require that other ports be installed beforehand; these prerequisites
  for a given port are called a port's <quote>dependencies</quote>.</para>

  <para>There are three ways to specify dependencies in a Portfile: library,
  build, and run dependencies. Specifying dependencies correctly is important
  for proper port upgrade and uninstall behavior. For example, you may not
  uninstall a port that is a library dependency for another port, though you
  may remove one with a build dependency; likewise, upgrading a port will
  upgrade its library and build dependencies also, but not its run
  dependencies.</para>

  <variablelist>
    <varlistentry>
      <term>depends_lib</term>

      <term>depends_lib-append</term>

      <term>depends_lib-delete</term>

      <listitem>
        <para>The list of dependencies to check before phases
        <option>configure</option>, <option>build</option>,
        <option>destroot</option>, <option>install</option>, and
        <option>package</option>. Library dependencies are needed both at
        build time (for headers and libraries to link against) and at run
        time.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>depends_build</term>

      <term>depends_build-append</term>

      <term>depends_build-delete</term>

      <listitem>
        <para>The list of dependencies to check before phases
        <option>configure</option>,
        <option>build</option>, <option>destroot</option>,
        <option>install</option>, and <option>package</option>. Build
        dependencies are needed when software is compiled, but not needed at
        all once the software is compiled and installed.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>depends_run</term>

      <term>depends_run-append</term>

      <term>depends_run-delete</term>

      <listitem>
        <para>The list of dependencies to check before phases
        <option>destroot</option>, <option>install</option>, and
        <option>package</option>. Run dependencies are needed when the
        software is run, but not to compile it.</para>
      </listitem>
    </varlistentry>
  </variablelist>

  <section id="reference.dependencies.types">
    <title>Port and File Dependencies</title>

    <para>Port dependencies can be satisfied by reference to a port (in this
    case the MacPorts' registry is queried), or by reference to a file
    (whether provided by a port or not). The most commonly-used type of
    dependencies in Portfiles are port dependencies, because dependencies
    should be provided by MacPorts ported software whenever possible, and
    usually only one port can provide the needed libraries and files.</para>

    <para>But when satisfying a dependency with vendor-supplied software is
    preferred for justifiable reasons, or when it is possible for more than
    one port to satisfy a dependency, then file dependencies may be used. An
    example of the former is with X11 —Apple's is widely preferred; an example
    of the latter is with "-devel" named ports —these ports provide identical
    files (only one can be activated at a time).</para>

    <para>Port dependencies, the preferred type, are specified as shown in
    these examples:</para>

    <programlisting>depends_lib         port:rrdtool port:apache2

depends_build       port:libtool

depends_run         port:apache2 port:php5</programlisting>

    <para>File dependencies may be of three types: <option>bin</option> for
    programs, <option>lib</option> for libraries, and <option>path</option>
    for any file. File dependencies are specifed in the form:
    <replaceable>&lt;type&gt;</replaceable>:<replaceable>&lt;filename&gt;</replaceable>:<replaceable>&lt;port&gt;</replaceable>.
    Note that the <replaceable>&lt;port&gt;</replaceable> specified is only
    installed if the file the specified library, binary, or file is not found.
    See the examples below:</para>

    <programlisting>depends_lib         lib:libX11.6:xorg

depends_build       bin:glibtool:libtool

depends_run         path:${prefix}/lib/libltdl.a:libtool</programlisting>

    <note>
      <para> When using lib dependencies, only the library name is specified
      —not its extension (e.g. ".dylib" ".so", etc.).</para>
    </note>
  </section>
</section>