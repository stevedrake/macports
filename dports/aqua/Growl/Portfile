# $Id$

PortSystem 1.0

name			Growl
set base_version	1.1
version			${base_version}-beta1
categories		aqua
platforms		darwin
maintainers		boeyms@macports.org openmaintainer@macports.org
description		global notification system for Mac OS X (BETA)
long_description	Growl is a global notification system for Mac OS X. Any \
				application can send a notification to Growl, which will \
				display an attractive message on your screen.

homepage		http://growl.info/

# At present, the only working sources are in an SVN repository; will switch
# back to a tarball once a working one is available.

#master_sites	${homepage}/files/source/
#checksums		md5 064016b759349360018ded19dde6c0eb \
#				sha1 f14b89257653377765acac81fb0d9a525ea6c8f2 \
#				rmd160 2b16fcbb87e566efbff237324dc4df61476be27f
#use_bzip2		yes
#worksrcdir		${distname}
#distname		${distname}-src

fetch.type		svn
svn.url			http://src.growl.info/growl/branches/growl-${base_version}
svn.tag			4293
worksrcdir		growl-${base_version}
depends_build	bin:svn:subversion

# The following patch selection makes the source build for a single
# architecture, rather than as universal binaries as the distributed source is
# configured to do.  This probably plays havoc with the MacPorts +universal
# variant, so I'll need to think further about this.
patchfiles		patch-Growl.xcodeproj__project.pbxproj.${os.arch}
use_configure		no
build.target		growl
destroot.destdir	PREFIX=${destroot}

# The old behaviour of automatically installing the contributed extras in the
# source distribution has been disabled for now, as it is not apparent that
# every Growl user will want these.  They should probably go into other ports,
# in any case.
#
#post-build {
#	foreach extra { growlnotify growlctl growlpinger GrowlTunes GrowlMail HardwareGrowler } {
#		system "cd ${worksrcpath}/Extras/${extra} && \
#			MACOSX_DEPLOYMENT_TARGET=10.3 xcodebuild"
#	}
#}

#destroot {
#	xinstall -m 755 -d ${destroot}/Applications/MacPorts/ \
#		${destroot}/Library/Mail/Bundles/ \
#		${destroot}/Library/PreferencePanes/ \
#		${destroot}${prefix}/share/growl/
#	file copy ${worksrcpath}/build/Growl.prefPane \
#		${destroot}/Library/PreferencePanes/
#	file copy ${worksrcpath}/Extras/GrowlMail/build/GrowlMail.mailbundle \
#		${destroot}/Library/Mail/Bundles
#	file copy ${worksrcpath}/Extras/GrowlTunes/build/GrowlTunes.app \
#		${destroot}/Applications/MacPorts/
#	file copy ${worksrcpath}/Extras/HardwareGrowler/build/HardwareGrowler.app \
#		${destroot}/Applications/MacPorts/
#	foreach item { growlnotify growlctl growlpinger } {
#		xinstall -m 755 ${worksrcpath}/Extras/${item}/build/${item} \
#			${destroot}${prefix}/bin
#		xinstall -m 644 ${worksrcpath}/Extras/${item}/${item}.1 \
#			${destroot}${prefix}/share/man/man1
#	}
#	xinstall -m 644 ${filespath}/darwinports.png \
#		${destroot}${prefix}/share/growl
#	xinstall -m 755 ${filespath}/iport ${destroot}${prefix}/bin
#	reinplace "s|__PREFIX__|${prefix}|g" ${destroot}${prefix}/bin/iport
#}

variant universal {
	patchfiles-delete \
		patch-Growl.xcodeproj__project.pbxproj.${os.arch}
}
