# $Id: Portfile,v 1.2 2005/07/04 05:34:13 pguyot Exp $

PortSystem 1.0

name                JHymn
version             0.8.3
platforms           darwin
categories          aqua audio
description         iTMS DRM removal utility
long_description    The purpose of JHymn is to allow you to exercise your \
                    fair-use rights under copyright law. It allows you to free \
                    your iTunes Music Store (protected AAC/m4p) purchases from \
                    their DRM restrictions with no sound quality loss. These \
                    songs can then be played outside of the iTunes \
                    environment, even on operating systems not supported by \
                    iTunes.
maintainers         dms@freeshell.org
homepage            http://www.hymn-project.org/jhymndoc/
master_sites        http://www.hymn-project.org/download/
distname            [regsub -all {[\.-]} ${distname} _]_source
use_zip             yes
checksums           md5 531949f97d8c4b1c7522d03aac0ae15e
worksrcdir          ${name}
configure           {}
depends_build       bin:faad:faad2 \
                    bin:lame:lame
pre-build           { xinstall "[binaryInPath faad]" "[binaryInPath lame]" \
                        "${worksrcpath}" }
build.type          pbx
build.target        -target ${name}
build.args          -buildstyle Deployment
set xcodebuilddir		build
platform darwin 8 {
	if {$xcodeversion == "2.1"} {
		set xcodebuilddir	build/Deployment
		patchfiles-append	patch-JHymn.xcode-project.pbxproj
	}
}
destroot            { xinstall -m 755 -d "${destroot}/Applications/DarwinPorts"
                      file copy "${worksrcpath}/${xcodebuilddir}/JHymn.app" \
                        "${destroot}/Applications/Darwinports" }
