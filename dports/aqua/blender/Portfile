# $Id: Portfile,v 1.5 2004/05/26 12:13:32 pguyot Exp $

PortSystem		1.0
name			blender
version			20040526
revision		1
categories		aqua graphics
platforms		darwin
maintainers		krugazor@free.fr
description		3D modeler / renderer
long_description	Blender, the open source software for 3D modeling, \
			animation, rendering, post-production, interactive \
			creation and playback. Available for Windows, \
			Linux, Irix, Sun Solaris, FreeBSD or Mac OS X. \
			This is the CVS version that includes patches for Quicktime.

# blender requires DP's Python 2.3
depends_lib		lib:libintl.3:gettext \
			lib:libftgl:ftgl \
			bin:sdl-config:libsdl \
			lib:libjpeg:jpeg \
			lib:libpng:libpng \
			bin:${prefix}/bin/python2.3:python23

fetch.type		cvs
cvs.root		:pserver:anonymous@cvs.blender.org:/cvsroot/bf-blender
cvs.args		-D"${version}"
cvs.module		blender
worksrcdir		blender

patchfiles		patch-all-blender

configure		{}

pre-build {
	# ./bootstrap fails, but it's ok.
	system "cd ${workpath}/blender && ./bootstrap ; mkdir -p ${workpath}/lib"
}

build.args		dports_prefix=${prefix}

destroot {
	xinstall -m 755 -d ${destroot}/Applications/DarwinPorts
	system "ditto -rsrcFork ${workpath}/blender/obj/*/bin/blender.app \
		${destroot}/Applications/DarwinPorts/blender.app"
	if { [variant_isset GameEngine] } {
		system "ditto -rsrcFork ${workpath}/blender/obj/*/bin/blenderplayer.app \
			${destroot}/Applications/DarwinPorts/blenderplayer.app"
	}
}
