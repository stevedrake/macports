# $Id$

PortSystem 1.0
PortGroup xcode 1.0
name            gimp-app
version         2.3.18
maintainers     yves
description     Gimp.app application bundle
long_description ${description}

categories      aqua graphics
homepage        http://gimp-app.sourceforge.net/

depends_run     bin:gimp:gimp2

master_sites    sourceforge
distfiles       ScriptExec.tar.gz \
                gimp.app.skel.tar.gz
checksums       ScriptExec.tar.gz md5 fc444a1e18cf2664f29af6ca6ca335ef \
                gimp.app.skel.tar.gz md5 66ad4912a3c71056c479c8eeef11fd43
worksrcdir      ScriptExec

patch {
    cd ${workpath}/Gimp.app/Contents
    delete Info.plist PkgInfo
    xinstall -m 644 ${filespath}/Info.plist ${filespath}/PkgInfo .
    reinplace "s|__VERSION__|${version}|g" Info.plist
    reinplace "s|`dirname \\\\\"\$0\\\\\"`|${prefix}|g" \
        Resources/openDoc Resources/script
}

destroot {
    xinstall -m 755 \
        ${worksrcpath}/build/Deployment/ScriptExec.app/Contents/MacOS/ScriptExec \
            ${workpath}/Gimp.app/Contents/MacOS/Gimp
    
    cd ${workpath}/Gimp.app/Contents/Resources
    xinstall -m 755 bin/getdisplay.sh ${destroot}${prefix}/bin
    delete Gimp.icns bin etc lib share
    xinstall -m 644 ${filespath}/Gimp.icns .
    xinstall -m 644 ${filespath}/xcf.icns .

    xinstall -d ${destroot}/Applications/MacPorts
    copy ${workpath}/Gimp.app ${destroot}/Applications/MacPorts
}
