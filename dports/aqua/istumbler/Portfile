# $Id: Portfile,v 1.3 2004/05/01 01:52:03 rshaw Exp $
PortSystem		1.0

name			istumbler
version			86
categories		aqua
maintainers		rshaw@opendarwin.org
description		iStumbler is an Aqua GUI for finding wireless networks
long_description	iStumbler is a free, open source tool for finding \
					802.11b & 802.11g  wireless networks. iStumbler \
					combines a compact Aqua user interface  with visual \
					feedback of signal strength and encryption.
homepage		http://www.istumbler.net/
master_sites	http://www.istumbler.net/downloads/
distname		${name}-${version}-src
extract.suffix	.tgz
checksums		md5 a2f5a43b7547563ec207545890833ffd
platforms		darwin

set appName		iStumbler
worksrcdir		${appName}

use_configure	no

pre-build {
	if {[catch {set xcodebuild [binaryInPath xcodebuild]}] == 0} {
		set cmd "${xcodebuild} -buildstyle Deployment -target"
		cd ${worksrcpath}
		file mkdir build
		system "cd Plugins/Log && ${cmd} Log"
		system "ln -s ../Plugins/Log/build/Log.plugin build"
		system "cd Plugins/AirPort && ${cmd} AirPort.plugin"
		system "ln -s ../Plugins/AirPort/build/AirPort.plugin build"
		#system "cd Plugins/Bluetooth && ${cmd} BluetoothPlugin"
		#system "ln -s ../Plugins/Bluetooth/build/Bluetooth.plugin build"
		#system "cd ${worksrcpath}/Plugins/GPS && ${cmd} GPS"
		#system "ln -s ../Plugins/GPS/build/GPS.plugin build"
	} else {
		ui_error "xcodebuild required in order to build ${appName}!"
		exit 1
	}
}
build.type		pbx
build.target
build.args		-buildstyle Deployment -target ${appName}

destroot {
	cd ${worksrcpath}
	set appPath ${destroot}/Applications/DarwinPorts
	xinstall -d -m 0755 ${appPath}
	set cmd "cp -R build/${appName}.app ${appPath}/${appName}.app"
	ui_info ${cmd}; system ${cmd}
}

