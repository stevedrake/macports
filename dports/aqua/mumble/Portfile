# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                mumble
version             1.2.2
revision            2
categories          aqua audio
license             GPL
maintainers         snc openmaintainer
description         low-latency voice chat for gaming
long_description \
    Mumble is an open source, low-latency, high quality \
    voice chat software primarily intended for use while gaming.
homepage            http://mumble.sourceforge.net/
platforms           macosx
supported_archs     ppc i386

master_sites        sourceforge

checksums           md5     de30ee85170e183b66568b53b04c5727 \
                    sha1    b2a7fd50e70147b3ea2361cbc5a577b0e1ae45ea \
                    rmd160  501aa1c4c170fb5aad2841cdfe3421376e62a07b

livecheck.type      regex
livecheck.url       http://sourceforge.net/project/showfiles.php?group_id=147372&package_id=162594
livecheck.regex     "${name}-(\\d+\\.\\d+\\.\\d+)${extract.suffix}"

depends_lib \
    port:qt4-mac \
    port:openssl \
    port:portaudio \
    port:ice-cpp \
    port:libsndfile \
    port:protobuf-cpp

depends_build \
    port:boost

configure.env       QMAKESPEC=${prefix}/libexec/qt4-mac/mkspecs/macx-g++
configure.cmd       ${prefix}/libexec/qt4-mac/bin/qmake
configure.pre_args  CONFIG+=\"
configure.post_args \" DEFINES+=NO_UPDATE_CHECK main.pro
configure.args      release no-dbus no-universal no-server

variant dbus description {Build DBus support} {
    configure.args-delete no-dbus
}

variant universal {
    configure.args-delete no-universal
}

build.env       QMAKESPEC=${prefix}/libexec/qt4-mac/mkspecs/macx-g++

destroot {
    file copy ${worksrcpath}/release/Mumble.app ${prefix}${applications_dir}/Mumble.app
    file copy ${worksrcpath}/release/plugins ${prefix}${applications_dir}/Mumble.app/Contents/Plugins
}
