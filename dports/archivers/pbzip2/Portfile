# $Id$

PortSystem      1.0

name            pbzip2
version         1.0.2
categories      archivers
platforms       darwin
maintainers     nomaintainer
description     parallel bzip2

long_description \
    PBZIP2 is a parallel implementation of the bzip2 block-sorting file compressor that \
    uses pthreads and achieves near-linear speedup on SMP machines.

homepage		http://compression.ca/pbzip2/
master_sites	${homepage}

depends_lib		port:bzip2

checksums       md5 7c959f0554695bc484865b938e791aaf \
                sha1 8ae0ebcd08761332ade6baa4b1172a3f97f71169 \
                rmd160 c8ea882ae9d2739250ae3bea514c14537995ed37

set CFLAGS      "${configure.ldflags} ${configure.cppflags}"

configure {
    cd ${worksrcpath}

    reinplace "s|-pthread -lpthread|${CFLAGS}|" Makefile
    reinplace "s|man|share/man|" Makefile
}

destroot.destdir    PREFIX=${destroot}${prefix}

post-destroot {
    set docdir ${prefix}/share/doc/${name}-${version}
    xinstall -d ${destroot}${docdir}
    xinstall -m 0644 -W ${worksrcpath} AUTHORS COPYING ChangeLog README \
        ${destroot}${docdir}
}

variant universal {
    set CFLAGS "${CFLAGS} ${configure.universal_cflags}"
}

