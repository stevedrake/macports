# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem      1.0

name            unrar
set my_name     ${name}src
version         3.8.4
categories      archivers
platforms       darwin freebsd
maintainers     nox openmaintainer
description     Extract, view & test RAR archives

long_description \
    The unRAR utility is a minor part of the RAR archiver and \
    contains RAR uncompression algorithm. unRAR requires very \
    small volume of memory to operate.

homepage        http://www.rarlab.com/
master_sites    ${homepage}rar/
distname        ${my_name}-${version}

checksums       md5     b40b43e28dee42abd9840bfc9e2909ee \
                sha1    42ed2c4ed86756f150252870e8285776f458fdff \
                rmd160  6f013bfdcf726799cad64c80ac265ed15f331e44

worksrcdir      ${name}

# configure.universal_ldflags-append  -isysroot ${sysroot}
configure.universal_ldflags-append  -isysroot /Developer/SDKs/MacOSX10.4u.sdk

configure {
    reinplace -E "/^CXXFLAGS/s|\$| [join ${configure.cflags}]\\\n\
		LDFLAGS=[join ${configure.ldflags}]|" \
        ${worksrcpath}/makefile.unix
}

build.args      -f makefile.unix

use_parallel_build  yes

destroot {
	set docdir ${prefix}/share/doc/${name}-${version}

	xinstall -d ${destroot}${docdir}
	xinstall ${worksrcpath}/${name} ${destroot}${prefix}/bin
	xinstall -m 0644 ${worksrcpath}/license.txt ${destroot}${docdir}
}

livecheck.check regex
livecheck.url   ${master_sites}?C=M&O=D
livecheck.regex ${my_name}-(\\d+(?:\\.\\d+)*)

