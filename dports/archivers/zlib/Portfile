# $Id$

PortSystem 1.0

name		zlib
version		1.2.3
revision	1
categories	archivers
maintainers	landonf@macports.org ryandesign \
		openmaintainer
description	zlib lossless data-compression library
long_description \
	zlib is designed to be a free, general-purpose, \
	legally unencumbered, lossless data-compression \
	library for use on virtually any computer hardware \
	and operating system.
homepage	http://www.zlib.net/
platforms	darwin freebsd

master_sites	${homepage} http://www.gzip.org/zlib/ \
				sourceforge:libpng

use_bzip2	yes
checksums	md5 dee233bf288ee795ac96a98cc2e369b6 \
            sha1 967e280f284d02284b0cd8872a8e2e04bfdc7283 \
            rmd160 cfba9984b354dcc38da49331457e6bfc861c6f51

patchfiles	patch-Makefile-static.diff
if {[variant_isset universal]} {
	patchfiles-append	patch-Makefile-universal.diff
}

post-patch {
    # Add the universal CFLAGS, if they're needed
    reinplace s|@UNIVERSAL_CFLAGS@|${configure.universal_cflags}|g ${worksrcpath}/Makefile.in
}

configure.args	--shared
configure.universal_args    

test.run	yes

set docdir  ${prefix}/share/doc/${name}-${version}

destroot.destdir prefix=${destroot}${prefix}

post-destroot {
    xinstall -m 0755 -d ${destroot}${docdir}
    xinstall -m 0644 -W ${worksrcpath} ChangeLog FAQ README ${destroot}${docdir}
}

variant examples description {Install code examples} {
    post-destroot {
        set examplesdir ${docdir}/examples

        xinstall -m 0755 -d ${destroot}${examplesdir}
        eval xinstall -m 0644 [glob ${worksrcpath}/example{.c,s/*}] ${destroot}${examplesdir}
    }
}

livecheck.check regex
livecheck.url   ${homepage}
livecheck.regex ${name}-(\[0-9.\]+)\\.tar
