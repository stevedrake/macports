# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem              1.0

name                    ardour2
version                 2.7.1
distname                ardour-${version}
maintainers             devans
categories              audio x11
platforms               darwin
homepage                http://ardour.org/

description             Ardour is a digital audio workstation.

long_description \
                        Ardour is a digital audio workstation. \
                        You can use it to record, edit and mix multi-track audio. \
                        Capabilities include: multichannel recording, non-destructive \
                        editing with unlimited undo/redo, full automation support, \
                        a powerful mixer, unlimited tracks/busses/plugins, timecode \
                        synchronization, and hardware control from surfaces like \
                        the Mackie Control Universal.

use_parallel_build      yes
use_bzip2               yes
master_sites            http://releases.ardour.org/

checksums               md5     0fd4b1a600c75447d633b796bad321e1 \
                        sha1    3e8a6425bcfe5efbba0cfba44f0f63799e735cdb \
                        rmd160  7488169a28610550a93b700dd7949b8ffad2431e

depends_build           port:gettext \
                        port:pkgconfig \
                        port:libtool \
                        port:python25 \
                        port:scons

depends_lib             port:jack \
                        port:libxslt \
                        port:libxml2 \
                        port:libart_lgpl \
                        port:libsamplerate \
                        port:raptor \
                        port:liblrdf \
                        port:glib2 \
                        port:gtk2 \
                        port:libgnomecanvas \
                        port:liblo \
                        port:flac \
                        port:boost \
                        port:fftw-3 \
                        port:fftw-3-single \
                        port:aubio \
                        port:slv2

post-extract {
    file copy ${worksrcpath}/SConstruct ${worksrcpath}/SConstruct.orig
}

patchfiles              patch-SConstruct.diff

post-patch {
    reinplace "s%/opt/local%${prefix}%" ${worksrcpath}/SConstruct
    reinplace "s%ParseConfig.*('pkg-config%ParseConfig('${prefix}/bin/pkg-config%" ${worksrcpath}/SConstruct
}

use_configure           no

build.cmd               scons
build.target
build.args              PREFIX=${prefix} FREESOUND=1

livecheck.check         regex
livecheck.url           ${homepage}/source_downloads
livecheck.regex         "ardour-(\[0-9.\]+).*${extract.suffix}"
