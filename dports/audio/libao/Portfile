# $Id$

PortSystem 1.0

name             libao
version          1.0.0
categories       audio
maintainers      nomaintainer
description      A Cross-platform Audio Library
long_description \
    libao is a way to easily add cross-platform audio output to your \
    program. Output devices are implemented as dynamic plugins, and \
    support for OSS, ESD, ALSA, aRTs, Solaris, and Irix outputs are \
    currently supported.
homepage         http://www.xiph.org/ao/
platforms        darwin
master_sites     http://downloads.xiph.org/releases/ao/
checksums           md5     08283fbe1f587619053a156254afecec \
                    sha1    47798bb0fad0c68cd2913ae8c6094aeaa18a23ca \
                    rmd160  3fa5bfcad9a5d6b09b46b2f32e52a261fe277d27

post-patch {
	reinplace "s|/etc/libao.conf|${prefix}/etc/libao.conf|" \
		${worksrcpath}/CHANGES \
		${worksrcpath}/doc/config.html \
		${worksrcpath}/libao.conf.5 \
		${worksrcpath}/include/ao/ao_private.h \
}

configure.args   --disable-arts --disable-esd \
                 --disable-oss --disable-X

platform darwin {
    if {${os.major} < 10} {
        patchfiles patch-AU-src__plugins__macosx__ao_macosx.c
    }
    post-destroot {
        system "echo default_driver=macosx >> ${destroot}${prefix}/etc/libao.conf"
    }
}

variant esd description {Enable Enlightened Sound Daemon support} {
    depends_lib-append    port:esound
    configure.args-delete --disable-esd
    configure.args-append --enable-esd
}

livecheck.type   regex
livecheck.url    ${master_sites}?C=M&O=D
livecheck.regex  ${name}-(\\d+(?:\\.\\d+)*)
