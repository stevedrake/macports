# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name             mpd
version          0.13.2
categories       audio
maintainers      milosh gmail.com:Ryan.Stonecipher.Fisher openmaintainer
description      Music Player Daemon
long_description \
	Music Player Daemon (MPD) allows remote access for playing music \
	(MP3, Ogg Vorbis, FLAC, AAC, Mod, and wave files) and managing \
	playlists. MPD is designed for integrating a computer into a stereo \
	system that provides control for music playback over a local network. \
	It also makes a great desktop music player, especially if you are a \
	console junkie, like frontend options, or restart X often.
homepage         http://www.musicpd.org/
platforms        darwin
master_sites     ${homepage}/uploads/files/
use_bzip2        yes
checksums        md5     b461896369949ff3cff955692ead9f8b \
                 sha1    3b826bc75c314e6db6715a978c9b405775d3478c \
                 rmd160  39825142d8f19ca04d7a2e025b59043a8adb53fa
depends_lib      lib:libmad.0:libmad \
                 lib:libid3tag.0:libid3tag \
                 port:libiconv port:pkgconfig port:zlib \
                 port:libogg port:libvorbis \
                 port:libao
configure.args   --mandir=${prefix}/share/man --enable-id3 --enable-ao \
                 --disable-flac --disable-aac --disable-audiofile
configure.cflags-append -I${prefix}/include
default_variants +aac +audiofile +flac
variant  aac description {Support for aac files (default)} {
        depends_lib-append    port:faad2
        configure.args-delete --disable-aac
}
variant audiofile description {Support for wave, aiff, au files (default)} {
        depends_lib-append    port:audiofile
        configure.args-delete --disable-audiofile
}
variant flac description {Support for flac files (default)} {
        depends_lib-append    port:flac
        configure.args-delete --disable-flac
}
variant mod description {Support for 669, AMF, DSM, FAR, GDM, IMF, IT, MED, MOD, MTM, OKT, S3M, STM, STX, ULT, and XM files via libmikmod} {
        depends_lib-append    port:libmikmod
        configure.args-append --enable-mod
}
variant modplug description {Support for MOD files via libmodplug} {
        depends_lib-append    port:libmodplug
        configure.args-append --enable-modplug
}
platform macosx {
        configure.args-delete --enable-ao
        depends_lib-delete    port:libao
}

post-activate {
ui_msg "You may get \"Problems shmget'ing\" message when launching mpd.
In this case, you can increase the values of kern.sysv.shmmax and
kern.sysv.shmall in /etc/rc."}

livecheck.check   regex
livecheck.url     http://mpd.wikia.com/wiki/Server
livecheck.regex "${name}-(\\d+(?:\\.\\d+)*)${extract.suffix}"
