# $Id: Portfile,v 1.3 2005/03/21 15:21:51 mww Exp $

PortSystem 1.0

name			openal
version			2004-08-10
categories		audio devel
platforms		darwin
maintainers		mww@opendarwin.org
description		OpenAL is a cross-platform 3D audio API
long_description	OpenAL is a cross-platform 3D audio API appropriate for \
					use with gaming applications and many other types of audio \
					applications. 

homepage		http://www.openal.org/
fetch.type		cvs
cvs.root		:pserver:guest@opensource.creative.com:/usr/local/cvs-repository
cvs.password	guest
cvs.args		-D"20050321"
cvs.module		${name}/macosx
patchfiles		patch-oalDevice.h

worksrcdir		openal/macosx

use_configure	no

build.type		pbx
build.target
build.args		-project al_osx.xcode
post-build	{
	system "g++ -o ${worksrcpath}/build/libopenal.1.0.0.dylib -L${worksrcpath}/build -F${worksrcpath}/build -filelist ${worksrcpath}/build/al_osx.build/openal.dylib.build/Objects-normal/LinkFileList -framework vecLib -framework CoreAudio -framework CoreFoundation -framework AudioToolbox -framework AudioUnit -framework CoreServices -arch ppc -prebind -Wl,-single_module -dynamiclib -compatibility_version 1 -current_version 1 -install_name ${prefix}/lib/libopenal.1.0.0.dylib"
}

destroot {
	xinstall -m 755 -d ${destroot}${prefix}/include/openal
	xinstall -m 644 -W ${worksrcpath}/build al.h alc.h alctypes.h altypes.h \
		alut.h ${destroot}${prefix}/include/openal
	xinstall -m 644 ${worksrcpath}/build/libopenal.1.0.0.dylib \
		${destroot}${prefix}/lib
	system "cd ${destroot}${prefix}/lib \
		&& ln -s libopenal.1.0.0.dylib libopenal.1.0.dylib \
		&& ln -s libopenal.1.0.0.dylib libopenal.1.dylib \
		&& ln -s libopenal.1.0.0.dylib libopenal.dylib"
}
