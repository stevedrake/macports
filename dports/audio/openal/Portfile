# $Id: Portfile,v 1.1 2004/09/22 20:11:29 mww Exp $

PortSystem 1.0

name			openal
version			2004-21-09
categories		audio devel
platforms		darwin
maintainers		mww@opendarwin.org
description		OpenAL is a cross-platform 3D audio API
long_description	OpenAL is a cross-platform 3D audio API appropriate for \
					use with gaming applications and many other types of audio \
					applications. 

homepage		http://www.openal.org/
master_sites	http://www.opendarwin.org/~mww/files/
checksums		md5 7fa4bfea0f86fca8b7a2365608b42cbb
use_bzip2		yes
patchfiles		patch-oalSource.cpp \
				patch-oalDevice.cpp

worksrcdir		openal/macosx

post-extract	{
	file delete -force ${worksrcpath}/al_osx.pbproj
}

use_configure	no

build.type		pbx
build.target
post-build	{
	system "g++ -o ${worksrcpath}/build/libopenal.1.0.0.dylib -L${worksrcpath}/build -F${worksrcpath}/build -filelist ${worksrcpath}/build/al_osx.build/openal.dylib.build/Objects-normal/LinkFileList -framework vecLib -framework CoreAudio -framework CoreFoundation -framework AudioToolbox -framework AudioUnit -framework CoreServices -arch ppc -prebind -Wl,-single_module -dynamiclib -compatibility_version 1 -current_version 1 -install_name ${prefix}/lib/libopenal.1.0.0.dylib"
}

destroot	{
	xinstall -m 755 -d ${destroot}${prefix}/include/openal
	xinstall -m 644 -W ${worksrcpath}/build al.h alc.h alctypes.h altypes.h \
		alut.h ${destroot}${prefix}/include/openal
	xinstall -m 644 ${worksrcpath}/build/libopenal.1.0.0.dylib \
		${destroot}${prefix}/lib
	system "cd ${destroot}${prefix}/lib \
		&& ln -s libopenal.1.0.0.dylib libopenal.1.0.dylib \
		&& ln -s libopenal.1.0.0.dylib libopenal.1.dylib \
		&& ln -s libopenal.1.0.0.dylib libopenal.dylib"
}
