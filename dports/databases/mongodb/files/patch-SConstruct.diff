--- SConstruct.orig	2009-07-08 11:25:25.000000000 -0600
+++ SConstruct	2009-07-09 23:47:17.000000000 -0600
@@ -304,23 +304,16 @@
 
     env.Append( CPPPATH=[ "-I/System/Library/Frameworks/JavaVM.framework/Versions/CurrentJDK/Headers/" ] )
 
-    env.Append( CPPFLAGS=" -mmacosx-version-min=10.4 " )
     if not nojni:
         env.Append( FRAMEWORKS=["JavaVM"] )
 
-    if os.path.exists( "/usr/bin/g++-4.2" ):
-        env["CXX"] = "g++-4.2"
-
     nix = True
 
-    if force64:
-        env.Append( CPPPATH=["/usr/64/include"] )
-        env.Append( LIBPATH=["/usr/64/lib"] )
-        if installDir == DEFAULT_INSTALl_DIR and not distBuild:
-            installDir = "/usr/64/"
-    else:
-        env.Append( CPPPATH=[ "/sw/include" , "/opt/local/include"] )
-        env.Append( LIBPATH=["/sw/lib/", "/opt/local/lib"] )
+    env.Append( CPPPATH=["/mp/include"] )
+    env.Append( LIBPATH=["/mp/lib/"] )
+    env["CC"] = os.environ["CC"]
+    env["CPP"] = os.environ["CPP"]
+    env["CXX"] = os.environ["CXX"]
 
 elif "linux2" == os.sys.platform:
     linux = True
@@ -624,11 +617,7 @@
         haveReadLine = False
         if darwin:
             myenv.Append( CPPDEFINES=[ "USE_READLINE" ] )
-            if force64:
-                myCheckLib( "readline" , True )
-                myCheckLib( "ncurses" , True )
-            else:
-                myenv.Append( LINKFLAGS=" /usr/lib/libreadline.dylib " )
+            myenv.Append( LINKFLAGS=" /mp/lib/libreadline.dylib " )
         elif myCheckLib( "readline" , release and nix , staticOnly=release ):
             myenv.Append( CPPDEFINES=[ "USE_READLINE" ] )
             myCheckLib( "ncurses" , staticOnly=release )
@@ -714,7 +703,7 @@
 clientEnv = env.Clone();
 clientEnv.Append( CPPPATH=["../"] )
 clientEnv.Prepend( LIBS=[ "mongoclient"] )
-clientEnv.Append( LIBPATH=["."] )
+clientEnv.Prepend( LIBPATH=["."] )
 l = clientEnv[ "LIBS" ]
 removeIfInList( l , "pcre" )
 removeIfInList( l , "pcrecpp" )
@@ -722,7 +711,7 @@
 testEnv = env.Clone()
 testEnv.Append( CPPPATH=["../"] )
 testEnv.Prepend( LIBS=[ "mongotestfiles" , "unittest" ] )
-testEnv.Append( LIBPATH=["."] )
+testEnv.Prepend( LIBPATH=["."] )
 
 
 # ----- TARGETS ------
@@ -793,8 +782,6 @@
         shellEnv["LINKFLAGS"].remove("-m64")
         shellEnv["CPPPATH"].remove( "/usr/64/include" )
         shellEnv["LIBPATH"].remove( "/usr/64/lib" )
-        shellEnv.Append( CPPPATH=[ "/sw/include" , "/opt/local/include"] )
-        shellEnv.Append( LIBPATH=[ "/sw/lib/", "/opt/local/lib" , "/usr/lib" ] )
 
     l = shellEnv["LIBS"]
     if linux64:
@@ -816,7 +803,7 @@
 
         shellEnv.VariantDir( "32bit" , "." )
     else:
-        shellEnv.Append( LIBPATH=[ "." ] )
+        shellEnv.Prepend( LIBPATH=[ "." ] )
 
     shellEnv = doConfigure( shellEnv , needPcre=False , needJava=False , shell=True )
 
