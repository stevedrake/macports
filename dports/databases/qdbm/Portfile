# $Id: Portfile,v 1.7 2006/05/20 00:01:50 takanori Exp $

PortSystem		1.0
name			qdbm
version         1.8.56
categories      databases
maintainers     rsky0711@gmail.com pelopor@nifty.com
platforms       darwin
description		QDBM is a library of routines for managing a database.
long_description	\
	QDBM is a library of routines for managing a database. The database is a\
	simple data file containing records, each is a pair of a key and a\
	value. Every key and value is serial bytes with variable length. Both binary\
	data and character string can be used as a key and a value. There is neither\
	concept of data tables nor data types. Records are organized in hash table\
	or B+ tree.
homepage	 	http://qdbm.sourceforge.net/
master_sites    ${homepage}
checksums       md5 624bef05db028c6a7040e1212d2635b4 \
                sha1 246e0a771cfea15d1e71829e81b0a37ea2872bab \
                rmd160 c547123f45dedba186cc3f0d35feec6cc1fbd6b2
#patchfiles 		patch-qdbm_def.diff

depends_lib		port:libiconv port:zlib

configure.args  --mandir=${prefix}/share/man \
                --datadir=${prefix}/share/doc \
                --enable-pthread \
                --enable-zlib --enable-iconv

post-extract	{
				#configure
				reinplace "s|\$HOME|\${prefix}|g" \
					${worksrcpath}/configure
				# Makefile.in
				reinplace "s|\$(HOME)|\$(prefix)|g" \
					${worksrcpath}/Makefile.in
    # myconf.c
    reinplace "s|lzo/|lzo2/|g" \
        ${worksrcpath}/myconf.c
				}

test.run yes

platform macosx   {
		  		build.target	mac
				test.target 	check-mac
				destroot.target	install-mac
}

variant debug {
		configure.args-append   --enable-debug
}

variant bzip2 {
		depends_lib-append      port:bzip2
		configure.args-append   --enable-bzip
}

variant lzo {
		depends_lib-append      port:lzo2
		configure.args-append   --enable-lzo
}
