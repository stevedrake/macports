# $Id: Portfile,v 1.4 2006/03/30 03:26:24 takanori Exp $

PortSystem		1.0
name			qdbm
version			1.8.47
categories		textproc
maintainers		pelopor@nifty.com
description		QDBM is a library of routines for managing a database.
long_description	\
	QDBM is a library of routines for managing a database. The database is a\
	simple data file containing records, each is a pair of a key and a\
	value. Every key and value is serial bytes with variable length. Both binary\
	data and character string can be used as a key and a value. There is neither\
	concept of data tables nor data types. Records are organized in hash table\
	or B+ tree.

homepage	 	http://qdbm.sourceforge.net/
platforms		darwin
master_sites	http://qdbm.sourceforge.net/
checksums			md5 0e536a6bc8edf092eae6f81428be3037 \
					sha1 c945fe39b6718de3d1c5b03bba5882fc8e567c94 \
					rmd160 1a44b37194eaf1e39181f6d99091e6942c4b6ce2
depends_lib		port:libiconv port:zlib

post-extract	{
				#configure
				reinplace "s|\$HOME|\${prefix}|g" \
					${worksrcpath}/configure
				reinplace "s|/usr/local|\${prefix}|g" \
					${worksrcpath}/configure
				# Makefile.in
				reinplace "s|\$(HOME)|\$(prefix)|g" \
					${worksrcpath}/Makefile.in
				reinplace "s|/usr/local/include -I/usr|\$(prefix)|g" \
					${worksrcpath}/Makefile.in
				reinplace "s|/usr/local|\$(prefix)|g" \
					${worksrcpath}/Makefile.in
				reinplace "s|install_name libqdbm.\$(LIBVER).dylib|install_name \$(MYLIBDIR)/libqdbm.\$(LIBVER).dylib|g" \
					${worksrcpath}/Makefile.in
				reinplace "s|lzo/|lzo2/|g" ${worksrcpath}/myconf.c
				}

configure.args	--mandir=${prefix}/share/man \
					--datadir=${prefix}/share/doc \
					--enable-pthread \
					--enable-zlib --enable-icon --enable-iconv

test.run yes

platform macosx   {
		  		build.target	mac
				test.target 	check-mac
				destroot.target	install-mac
}

platform darwin 8 {
		configure.env CC=/usr/bin/gcc-4.0 CPP=/usr/bin/cpp-4.0 CXX=/usr/bin/g++-4.0
}

variant debug {
		configure.args-append   --enable-debug
}
variant bzip2 {
		depends_lib-append      port:bzip2
		configure.args-append   --enable-bzip
}
variant lzo {
		depends_lib-append      port:lzo2
		configure.args-append   --enable-lzo
}
