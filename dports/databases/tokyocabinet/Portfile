# $Id:#

PortSystem      1.0
name            tokyocabinet
version         1.0.2
categories      databases
maintainers     rsky0711@gmail.com
platforms       darwin
description     Tokyo Cabinet is a library of routines for managing a database.
long_description    \
    Tokyo Cabinet is a library of routines for managing a database. The database\
    is a simple data file containing records, each is a pair of a key and a value.\
    Every key and value is serial bytes with variable length. Both binary data and\
    character string can be used as a key and a value. There is neither concept of\
    data tables nor data types. Records are organized in hash table or B+ tree.
homepage        http://tokyocabinet.sourceforge.net/
master_sites    ${homepage} \
                sourceforge:${name}
checksums       md5    8aeb7283c7bb91ea3069920fb3ee8a36 \
                sha1   5403071c2260b8dfe527f707cbf23f21b6a4af65 \
                rmd160 30b9d0a088180b295f68058f3b154599958e6d0b


depends_lib     port:zlib

configure.args  --mandir=${prefix}/share/man \
                --datadir=${prefix}/share/doc\

platform darwin {
    patchfiles-append patch-Makefile.in patch-configure
}

post-patch {
    # configure
    reinplace "s|\$HOME|\${prefix}|g" ${worksrcpath}/configure
    # Makefile.in
    reinplace "s|\$(HOME)|\$(prefix)|g" ${worksrcpath}/Makefile.in
}

post-configure {
    # tokyocabinet.pc
    reinplace "s|@MYLDOPTS@||g" ${worksrcpath}/tokyocabinet.pc
}

test.run yes
test.target check

#default_variants +fastest

variant debug conflicts devel profile fastest description {build for debugging} {
    configure.args-append   --enable-debug
}

variant devel conflicts debug profile fastest description {build for development} {
    configure.args-append   --enable-devel
}

variant profile conflicts debug devel fastest description {build for profiling} {
    configure.args-append   --enable-profile
}

variant fastest conflicts debug devel profile description {build for fastest run} {
    configure.args-append   --enable-fastest
}

variant swap description {build for swapping byte-orders} {
    configure.args-append   --enable-swap
}

livecheck.check sourceforge
