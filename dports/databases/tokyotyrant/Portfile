# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem      1.0

name            tokyotyrant
version         1.1.14
categories      databases
maintainers     openmaintainer gmail.com:paul.dlug
platforms       darwin
description     Tokyo Tyrant is the network interface for Tokyo Cabinet.
long_description    \
    Tokyo Tyrant is a the network interface for Tokyo Cabinet. It consists of a\
    network server process managing a database and providing concurrent and remote\
    connections.
homepage        http://tokyocabinet.sourceforge.net/
master_sites    ${homepage}/tyrantpkg \
                sourceforge:tokyocabinet
checksums       md5 925039114f29a42f1cedf42fb6ffb51c \
                sha1 cecd536754472f4444b0f52b0cf8c47491147c63 \
                rmd160 b99916c9a80e3d0ff1eca9c237952eee5802c6bd

depends_lib     port:zlib port:tokyocabinet

configure.args  --mandir=${prefix}/share/man \
                --datadir=${prefix}/share/doc

post-patch {
    # configure
    reinplace "s|\$HOME|\${prefix}|g" ${worksrcpath}/configure
    # Makefile.in
    reinplace "s|\$(HOME)|\$(prefix)|g" ${worksrcpath}/Makefile.in
}

test.run yes
test.target check

#default_variants +fastest

variant debug conflicts devel profile fastest description {build for debugging} {
    configure.args-append   --enable-debug
}

variant devel conflicts debug profile fastest description {build for development} {
    configure.args-append   --enable-devel
}

variant profile conflicts debug devel fastest description {build for profiling} {
    configure.args-append   --enable-profile
}

variant fastest conflicts debug devel profile description {build for fastest run} {
    configure.args-append   --enable-fastest
}

variant lua description {Build with lua extension} {
    configure.args-append --enable-lua
    depends_lib-append    port:lua
}

livecheck.check sourceforge
