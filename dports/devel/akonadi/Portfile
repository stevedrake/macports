# $Id$

PortSystem          1.0

name                akonadi
version             1.0.0
revision            1
categories          devel kde kde4
maintainers         illogic-al@macports.org openmaintainer
description         The PIM Storage Service
long_description    Akonadi is an extensible cross-desktop storage service for PIM data and metadata \
providing concurrent read, write, and query access.
homepage            http://pim.kde.org/akonadi/
platforms           darwin
master_sites		http://download.akonadi-project.org/
distname            ${name}

fetch.type          svn 
svn.url             svn://anonsvn.kde.org/home/kde/tags/kdesupport-for-4.1/kdesupport/${name}

depends_lib         port:qt4-mac 

depends_build       port:cmake port:automoc

use_parallel_build  yes

worksrcdir      	build

configure.cmd		cmake

pre-configure { file mkdir ${worksrcpath} }

configure.args      ../${distname} -DBUILD_SHARED_LIBS:BOOL=ON \
		-DCMAKE_VERBOSE_MAKEFILE=ON \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_SYSTEM_PREFIX_PATH=\"/opt/local\;/usr\" \
		-DCMAKE_INSTALL_PREFIX=${prefix} \
        -DCMAKE_OSX_SYSROOT=${sysroot} \
		-Wno-dev 

variant universal description "Compile for ppc and intel architectures" {
    configure.universal_args-delete  --disable-dependency-tracking
    configure.args-append	-DCMAKE_OSX_ARCHITECTURES=\"ppc\;i386\"
}

variant debug description "Enable debug binaries" {
	configure.args-delete		-DCMAKE_BUILD_TYPE=Release 
	configure.args-append		-DCMAKE_BUILD_TYPE=debugFull 

}

variant mysql description "Build the Akonadi server" {
depends_lib	path:${prefix}/bin/mysqld:mysql5-devel
}
