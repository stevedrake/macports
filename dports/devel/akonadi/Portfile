# $Id$

PortSystem          1.0
PortGroup           kde4    1.0

name                akonadi
version             1.2.1
categories          devel kde kde4
maintainers         nomaintainer
description         A personal information management storage service.
long_description    Akonadi is an extensible cross-desktop storage service \
for PIM data and metadata providing concurrent read, write, and query access.
platforms           darwin
homepage            http://pim.kde.org/akonadi/
master_sites        http://download.akonadi-project.org/
use_bzip2           yes
checksums           md5     f9c1d000844f31c67360078ddf60bec2 \
                    sha1    29916601d724b95d22712673bb0e1b72918cc43e \
                    rmd160  e071e2e8ccad1341ce9c86987c2daed5186e5ed6

depends_lib-append  port:soprano \
					port:boost

configure.args-append   -DMYSQLD_EXECUTABLE="" \
                        ../${distname}

platform darwin 9 {
    if {[info exists universal_target] && ${universal_target} == "10.4"} {
# Needed if compiling for 10.4 universal on 10.5
        post-configure {
            reinplace "s|#define HAVE_EXECINFO_H 1||" ${workpath}/build/config-akonadi.h
        }
    }
}

variant mysql description "Install the Akonadi server" {
    depends_lib-append	    path:bin/mysqld:mysql5-devel
    configure.args-delete   -DMYSQLD_EXECUTABLE=""
}
livecheck.type      regex
livecheck.url       ${master_sites}
livecheck.regex     "${name}-(\\d+(?:\\.\\d+)*)${extract.suffix}"
