# $Id$

PortSystem	1.0

name		apr
version		1.3.0
categories	devel
maintainers	dluke@geeklair.net
platforms	darwin
description	The apache group's portability library

long_description	The Apache Portable Runtime is a library of C data \
			structures and routines, forming a system portability \
			layer that covers as many operating systems as \
			possible, including Unices, Win32, BeOS, and OS/2.

homepage	http://apr.apache.org/
master_sites	apache:apr

use_bzip2	yes
checksums	md5 27d8fc8b13f8ea1a40e6796e7453bd84 \
		sha1 0ff4c3f017d617250781913eab3e931c7332da53 \
		rmd160 86088ff3b74680ffd4138f2cf480a595fbcc464c

use_parallel_build	yes
configure.env   ac_cv_prog_AWK=awk
configure.args	--with-installbuilddir=${prefix}/share/apr-1/build

test.run	yes
test.target	check
test.env	DYLD_LIBRARY_PATH=${worksrcpath}/.libs
pre-test	{
	use_parallel_build	no
}

platform darwin 9 {
	post-configure {
		reinplace {s|\(#define APR_HAS_SENDFILE[[:space:]]*\)1|\1 0|} ${worksrcpath}/include/apr.h
	}
}

livecheck.check regex
livecheck.url   http://apache.org/dist/apr/
livecheck.regex {<a href="#apr">APR (\d+(?:\.\d+)*) is the latest available version</a>}
