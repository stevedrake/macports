# $Id: Portfile,v 1.29 2005/10/18 17:11:21 dluke Exp $

PortSystem	1.0
name		apr
version		0.9.7
categories	devel
maintainers	dluke@geeklair.net
description	The apache group's portability library

long_description	The Apache Portable Runtime is a library of C data \
			structures and routines, forming a system portability \
			layer that covers as many operating systems as \
			possible, including Unices, Win32, BeOS, and OS/2.  

homepage	http://apr.apache.org/
master_sites	apache:httpd

distname	httpd-2.0.55
use_bzip2	yes
dist_subdir	apache2
checksums	md5 f1b5b65c8661db9ffe38b5a4a865a0e2
extract.post_args	| tar -f - -x ${distname}/srclib/apr

worksrcdir 	${distname}/srclib/apr
configure.args	--with-installbuilddir=${prefix}/share/apr-0/build

#change apr's rules.mk file to enable building of apr-util even
#after a port clean apr
post-destroot {	reinplace "s|^apr_builddir=.*|apr_builddir=${prefix}/share/apr-0/build|g" \
			${destroot}${prefix}/share/apr-0/build/apr_rules.mk
		reinplace "s|^apr_builders=.*|apr_builddir=${prefix}/share/apr-0/build|g" \
			${destroot}${prefix}/share/apr-0/build/apr_rules.mk }
#there's a fix for the poll-based implementation in later versions of apr, but for now we need this
#see http://issues.apache.org/bugzilla/show_bug.cgi?id=34332
platform darwin 8 { configure.env	ac_cv_func_poll=no }
