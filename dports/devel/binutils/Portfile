# $Id$

PortSystem			1.0
name				binutils
version				2.17

description			FSF Binutils for native development.
long_description	Free Software Foundation development toolchain ("binutils") \
					for native development. Tools are prefixed with g to avoid \
					conflicts with original tools.
platforms			darwin
categories			devel
maintainers			pguyot@kallisys.net
homepage			http://www.gnu.org/software/binutils/binutils.html
master_sites		gnu:binutils
use_bzip2			yes
checksums			md5 e26e2e06b6e4bf3acf1dc8688a94c0d1 \
					sha1 a557686eef68362ea31a3aa41ce274e3eeae1ef0 \
					rmd160 3995d7ed97f115e76ce55b4c1f5256d53559c84f

# Build in a different directory, as advised in the README file.
pre-configure   	{ system "cd ${workpath} && mkdir -p build"}
configure.dir   	${workpath}/build
configure.cmd   	${worksrcpath}/configure
configure.cc   		"cc -no-cpp-precomp"
configure.args  	--infodir='${prefix}/share/info' \
					--mandir='${prefix}/share/man' \
					--program-prefix=g
build.dir       	${workpath}/build

# Binutils violates the mtree layout by creating ${prefix}/<arch>/
destroot.violate_mtree	yes

# Fix the configure script to build bfd, binutils and opcode.
patchfiles			patch-configure
					
# We don't want the etc module.
post-extract {
	system "rm -rf ${worksrcpath}/etc"
}
