# $Id: Portfile,v 1.11 2006/08/19 18:24:42 jkh Exp $

PortSystem 1.0
name		boehmgc
version		6.8
categories	devel
maintainers	waqar@macports.org
description	Boehm-Demers-Weiser conservative garbage collector
long_description   The Boehm-Demers-Weiser conservative garbage collector \
	           can be used as a garbage collecting replacement for C \
		   malloc or C++ new. It is also used by a number of \
		   programming language implementations that use C as \
		   intermediate code.
set d_name      gc
homepage        http://www.hpl.hp.com/personal/Hans_Boehm/${d_name}/
platforms	darwin
master_sites	${homepage}gc_source/
distname	${d_name}${version}
checksums	sha1 6d5def5ba5d29292ba9c76f04df3ec06d3ab3278
configure.args  --with-threads=posix \
		--enable-parallel-mark \
		--enable-cplusplus

variant redirect {
	configure.args-append  --enable-redirect-malloc
}

platform darwin 8 {
	configure.env	CC=/usr/bin/gcc-4.0 CPP=/usr/bin/cpp-4.0 CXX=/usr/bin/g++-4.0
}

platform darwin 9 {
	configure.env-append CFLAGS=-D_NONSTD_SOURCE
}

test.run	yes
test.target	check
