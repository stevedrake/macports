--- Source/Makefile.orig	2009-11-29 21:44:12.000000000 +0300
+++ Source/Makefile	2009-11-29 21:45:12.000000000 +0300
@@ -1,10 +1,11 @@
-TARGETS= Gen/float/libbox2d.a Gen/fixed/libbox2d.a
+TARGETS= Gen/float/libbox2d.dylib Gen/float/libbox2d.a
 
 ifdef DEVKITPRO
 TARGETS += Gen/nds-float/lib/libbox2d.a Gen/nds-fixed/lib/libbox2d.a
 endif
 
-CXXFLAGS=	-g -O2
+CXXFLAGS+=	-g -O2
+CXX?=c++
 
 SOURCES = \
 	./Dynamics/b2Body.cpp \
@@ -54,7 +55,6 @@
 else
 
 -include $(addprefix Gen/float/,$(SOURCES:.cpp=.d))
--include $(addprefix Gen/fixed/,$(SOURCES:.cpp=.d))
 
 ifdef DEVKITPRO
 -include $(addprefix Gen/nds-fixed/,$(SOURCES:.cpp=.d))
@@ -65,16 +65,19 @@
 
 Gen/float/%.o:		%.cpp
 	@mkdir -p $(dir $@)
-	c++ $(CXXFLAGS) -c -o $@ $<
+	$(CXX) $(CXXFLAGS) -c -o $@ $<
 
 
 Gen/float/libbox2d.a:	$(addprefix Gen/float/,$(SOURCES:.cpp=.o))
 	ar cr $@ $^
 	ranlib $@ 
 
+Gen/float/libbox2d.dylib:	$(addprefix Gen/float/,$(SOURCES:.cpp=.o))
+	$(CXX) $^ -dynamiclib -compatibility_version @@COMPATIBILITY_VERSION@@ -current_version @@VERSION@@ -install_name @@PREFIX@@/lib/libbox2d.dylib -o $@
+
 Gen/float/%.d:		%.cpp
 	@mkdir -p $(dir $@)
-	c++ -MM -MT $(@:.d=.o) $(CXXFLAGS) -o $@ $<
+	$(CXX) -MM -MT $(@:.d=.o) $(CXXFLAGS) -o $@ $<
 
 
 Gen/fixed/%.o:		%.cpp
