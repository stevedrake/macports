# $Id$

PortSystem    1.0
PortGroup     python26 1.0

name          bzr
version       2.0.3
set branch    [join [lrange [split ${version} .] 0 1] .]
categories    devel python
platforms     darwin
maintainers   raimue

description   The next-generation distributed version control system
long_description  Bazaar is an open source distributed version control \
    system that is powerful, friendly, and scalable. It manages trees of \
    files and subdirectories, In particular, it records revisions of trees, \
    representing their state at a particular point in time, and information \
    about those revisions and their relationships. Recording and retrieving \
    tree revisions is useful in several ways if you are writing software or \
    documents or doing similar creative work.

homepage      http://bazaar-vcs.org/
master_sites  https://launchpad.net/${name}/${branch}/${version}/+download/

checksums     md5     60758e61b3fd3686966d7ab0ea17fa64 \
              sha1    178fe6546d32a1752a9e9abca57db128463bb1e6 \
              rmd160  3b33e5148ff47e66b0315e964d2b8e565d056675

patchfiles    patch-setup.py.diff

depends_lib-append  port:py26-paramiko \
                    port:py26-crypto \
                    port:py26-curl \
                    port:py26-docutils \
                    port:py26-pyrex

test.run      yes
test.cmd      make
test.target   check

post-destroot {
    ln -s ${python.prefix}/bin/bzr ${destroot}${prefix}/bin/
    ln -s ${python.prefix}/share/man/man1/bzr.1 \
        ${destroot}${prefix}/share/man/man1
    xinstall -m 644 -W ${worksrcpath} INSTALL NEWS README TODO \
        ${destroot}${prefix}/share/doc/${name}
}

universal_variant no

livecheck.type      regex
livecheck.url       http://feeds.launchpad.net/bzr/announcements.atom
# Pre-releases end with b[0-9]+ or rc[0-9]+
livecheck.regex     {(?:bzr |bzr-|Bazaar |bazaar )(\d+(?:\.\d+)*) .*[rR]eleased}
