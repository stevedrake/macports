# $Id: Portfile,v 1.2 2004/04/18 22:43:21 blb Exp $

PortSystem			1.0
name				commoncpp2
version				1.0.13
categories			devel
maintainers			blb@pobox.com
description			GNU Common C++ 2 Framework
long_description \
	C++ framework offering portable support for threading, sockets, file \
	access, daemons, persistence, serial I/O, XML parsing, and system \
	services.

platforms			darwin

homepage			http://www.gnu.org/software/commoncpp/
master_sites		gnu:commonc++

checksums			md5 7f1c5754ecd4a8c7524beb55b49a1fbf

depends_lib			lib:libxml2:libxml2 lib:libz:zlib

configure.env		CPPFLAGS="-I${prefix}/include" LDFLAGS="-L${prefix}/lib"
configure.args		--mandir=${prefix}/share/man \
					--infodir=${prefix}/share/info

post-destroot {
	file mkdir ${destroot}/${prefix}/share/man/man3
	# eval this since otherwise the [glob ...] is seen as one large argument
	eval file copy [glob ${worksrcpath}/doc/man3/*] \
		${destroot}/${prefix}/share/man/man3
}

variant darwin {
	patchfiles-append		patch-src_Makefile.in
}

platform darwin 6 {
	depends_lib-append		lib:libdl:dlcompat
}

platform darwin 7 {
	patchfiles-append		patch-aclocal.m4 patch-src_file.cpp
	use_autoconf			yes
	configure.env-delete	CPPFLAGS="-I${prefix}/include"
	configure.env-append	CPPFLAGS="-I${prefix}/include -DMACOSX_WITH_LOCKF"
}

