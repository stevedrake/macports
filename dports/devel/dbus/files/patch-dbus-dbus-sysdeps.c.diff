--- dbus/dbus-sysdeps.c.orig	2008-02-26 17:02:27.000000000 +0100
+++ dbus/dbus-sysdeps.c	2008-03-24 14:38:08.000000000 +0100
@@ -39,6 +39,10 @@
 #include <string.h>
 #include <stdio.h>
 
+#include <sys/time.h>
+#include <crt_externs.h>
+#define environ (*_NSGetEnviron())
+
 /* This is UNIX-specific (on windows it's just in stdlib.h I believe)
  * but OK since the same stuff does exist on Windows in stdlib.h
  * and covered by a configure check.
@@ -191,7 +195,6 @@
   if (clearenv () != 0)
      rc = FALSE;
 #else
-  extern char **environ;
 
   if (environ != NULL)
     environ[0] = NULL;
