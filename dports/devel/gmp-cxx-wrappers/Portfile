# $Id$

PortSystem 1.0
name		gmp-cxx-wrappers
version		4.2.1
revision	2
categories	devel math
maintainers	nomaintainer@macports.org
platforms	darwin freebsd
description	C++ wrappers for the GNU multiple precision arithmetic library
long_description	\
		The C++ wrappers for gmp.  To build them requires that	\
		gmp be installed, hence this portfile, which rebuilds	\
		gmp, but only installs the C++ wrappers.

homepage	http://www.swox.com/gmp/

master_sites	gnu:gmp

use_bzip2	yes
distfiles	gmp-${version}${extract.suffix}
checksums	gmp-${version}${extract.suffix} md5 091c56e0e1cca6b09b17b69d47ef18e3

depends_run	port:gmp

worksrcdir	gmp-${version}

configure.env	ABI=32
configure.cflags -force_cpusubtype_ALL
configure.args \
	--infodir=\\\${prefix}/share/info \
	--enable-shared \
	--enable-cxx

post-destroot {
	ui_msg "$UI_PREFIX Running ranlib on static libraries"
	system "ranlib ${destroot}${prefix}/lib/libgmpxx.a"
	
	file delete ${destroot}${prefix}/include/gmp.h
	
	file delete ${destroot}${prefix}/lib/libgmp.a
	file delete ${destroot}${prefix}/lib/libgmp.la
	file delete ${destroot}${prefix}/lib/libgmp.dylib
	file delete ${destroot}${prefix}/lib/libgmp.3.dylib
	file delete ${destroot}${prefix}/lib/libgmp.3.4.1.dylib
	
	file delete -force ${destroot}${prefix}/share
}

default_variants            +test
variant test {
	test.run                yes
	test.cmd                make
	test.target             check
}

platform darwin x86 {
	configure.env-delete    ABI=32
	configure.args-append   --host=none-apple-darwin
	configure.cflags-delete -force_cpusubtype_ALL
}

platform darwin i386 {
	configure.env-delete    ABI=32
	configure.args-append   --host=none-apple-darwin
	configure.cflags-delete -force_cpusubtype_ALL
}
