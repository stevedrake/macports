# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0
PortGroup  muniversal  1.0

name            gmp
version         4.2.4
revision        1
categories      devel math
maintainers     mcalhoun openmaintainer
platforms       darwin
description     GNU multiple precision arithmetic library
long_description \
    GNU MP is a library for arbitrary precision arithmetic, operating on\
    signed integers, rational numbers, and floating point numbers. It   \
    has a rich set of functions, and the functions have a regular       \
    interface. GNU MP is designed to be as fast as possible, both for   \
    small operands and for huge operands. The speed is achieved by using\
    fullwords as the basic arithmetic type, by using fast algorithms, by\
    carefully optimized assembly code for the most common inner loops   \
    for a lots of CPUs, and by a general emphasis on speed (instead of  \
    simplicity or elegance).

homepage        http://gmplib.org/
master_sites    gnu

checksums       md5     fc1e3b3a2a5038d4d74138d0b9cf8dbe \
                sha1    bb721f94fbeeb8c609104540b408da6707c370ec \
                rmd160  15c6c40c377088a3bcf9d432bcc27c777991cb12

use_bzip2       yes
use_parallel_build yes

if {![variant_isset universal]} {
    configure.env   ABI=32
}

configure.args  --infodir=${prefix}/share/info \
                --enable-cxx

test.run        yes
test.cmd        make
test.target     check

platform powerpc {
    if {![variant_isset universal]} {
        configure.cflags-append -force_cpusubtype_ALL
    }
}

# configure script expects to be able to run binaries
if { ${os.arch}=="i386" } {
    if { [llength ${universal_archs}] > 2 } {
        # with only three architectues, the merge does not work
        set universal_archs_supported  "i386 x86_64"
    }
} else {
    set universal_archs_supported  "ppc ppc64"
}

array set merger_configure_env {
    ppc     ABI=32
    i386    ABI=32
    ppc64   ABI=mode64
    x86_64  ABI=64
}

array set merger_configure_cflags {
    ppc     -force_cpusubtype_ALL
    ppc64   -force_cpusubtype_ALL
}
