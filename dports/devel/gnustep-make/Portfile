# $Id: Portfile,v 1.5 2005/08/17 17:22:07 yves Exp $

PortSystem			1.0
name            	gnustep-make
version         	1.11.0
revision            1
description     	GNUstep makefile package
long_description	The GNUstep makefile package is a simple, powerful and extensible way to \
					write makefiles for a GNUstep-based project.  It allows the user to \
					write a project without having to deal with the complex issues \
					associated with configuration, building, installation, and packaging. \
					It also allows the user to easily create cross-compiled binaries.
platforms       	darwin
categories      	devel gnustep x11 cross
maintainers     	yves@opendarwin.org
homepage			http://www.gnustep.org/
master_sites		http://ftp.easynet.nl/mirror/GNUstep/pub/gnustep/core/ \
					ftp://ftp.easynet.nl/mirror/GNUstep/pub/gnustep/core/ \
					http://www.peanuts.org/peanuts/Mirrors/GNUstep/gnustep/core/ \
					http://ftpmain.gnustep.org/pub/gnustep/core/ \
					ftp://ftp.gnustep.org/pub/gnustep/core/ \
					http://archive.progeny.com/gnustep/core/ \
					ftp://archive.progeny.com/gnustep/core/
checksums			md5 91f7e64e0531d56571ae93f6fdf14f58

configure.args		--prefix=${prefix}/GNUstep
build.type			gnu
destroot.args		messages=yes special_prefix=${destroot}

variant puredarwin {
	depends_lib     port:gcc40
    patch {
        system "cd ${worksrcpath} &&
            cat ${filespath}/patch-target.make |
                sed -e 's|@DP_PREFIX@|${prefix}|' |
                patch -p0"
    }
	configure.args-append  --with-library-combo=gnu-gnu-gnu \
	                       CC=gcc-dp-4.0
}

post-destroot {
    cd ${destroot}${prefix}/GNUstep/System/Tools
    file delete -force Java Resources
    cd ${destroot}${prefix}/bin
    set fl [glob ../GNUstep/System/Tools/*]
    foreach tool $fl {
        system "ln -s ${tool}"
    }
}
