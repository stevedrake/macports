# -*- Mode: Tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name            gnutls
version         2.6.3
categories      devel security
maintainers     sfiera openmaintainer
description     GNU Transport Layer Security Library
homepage        http://www.gnutls.org/
platforms       darwin

long_description \
    GnuTLS is a portable ANSI C based library which implements the TLS 1.0 and \
    SSL 3.0 protocols. The library does not include any patented algorithms \
    and is available under the GNU Lesser GPL license.

master_sites    gnu

checksums       md5     c6d2d1996b87b238ad6f73f92225d9a2 \
                sha1    f9b6a1d6135ef0a57a5cdd9fcb3e82bc62a27dcd \
                rmd160  318c91f167988f2dfcde50015491b7dc7d4eea33

use_bzip2       yes

post-patch {
    reinplace -E /libtasn1_config_version=/s/--version/--modversion/ \
        $worksrcpath/configure
}

depends_build   port:pkgconfig

depends_lib     port:libgcrypt \
                port:libtasn1 \
                port:opencdk \
                port:lzo \
                port:zlib \
                port:readline

configure.args  --with-lzo \
                --disable-guile \
                ac_cv_path_LIBTASN1_CONFIG="pkg-config libtasn1"

use_parallel_build  yes

test.run        yes
test.target     check

platform darwin 8 {
    build.env-append MACOSX_DEPLOYMENT_TARGET=10.4
    configure.env-append MACOSX_DEPLOYMENT_TARGET=10.4
}

livecheck.check regex
livecheck.url   http://ftp.gnu.org/gnu/gnutls/
livecheck.regex ${name}-(\\d+\\.\[02468\]+(?:\\.\\d+)*)
