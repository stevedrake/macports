# $Id$

PortSystem          1.0

name                gpgme
version             1.1.6
categories          devel security crypto
maintainers         boeyms openmaintainer
description         A library for easy acces to GnuPG.
long_description \
    GnuPG Made Easy (GPGME) is a library designed to make access \
    to GnuPG easier for applications. It provides a High-Level \
    Crypto API for encryption, decryption, signing, signature \
    verification and key management. Currently it uses GnuPG \
    as its backend but the API isn't restricted to this engine \
    in fact we have already developed a backend for CMS (S/MIME).

platforms           darwin

homepage            http://www.gnupg.org/related_software/gpgme/
master_sites        gnupg
use_bzip2           yes

checksums           md5 daddf775ace2594da834f15c8ebb045e \
                    sha1 05218df939d72c2fd6d74f22c2b5d5ade0718b7a \
                    rmd160 b5c110dcd5f14138812b764808367dd5dcbb2ff6

patchfiles          patch-assuan_assuan.h.diff

depends_lib         port:gnupg port:pth port:libgpg-error

post-patch {
    reinplace "s|thread_modules=\"\"|thread_modules=\"pthread\"|" ${worksrcpath}/gpgme/gpgme-config.in
}

configure.args      --with-gpg=${prefix}/bin/gpg --enable-static

test.run    yes
test.target check

post-destroot {
    xinstall -m 755 -d ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 -W ${worksrcpath} AUTHORS COPYING COPYING.LESSER \
        ChangeLog INSTALL NEWS README THANKS TODO \
        ${destroot}${prefix}/share/doc/${name}
}

platform darwin 7 {
    configure.env-append    LIBS="-lpth"
}

livecheck.check regex
livecheck.url   http://mirrors.rootmode.com/ftp.gnupg.org/${name}/?O=D
livecheck.regex ${name}-(\\d+\\.\\d+\\.\\d+)
