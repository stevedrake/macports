# $Id$

PortSystem 1.0

name				groovyserv
version				0.5
categories			devel groovy
maintainers			breskeby
description			GroovyServ makes Groovy startup time quicker, by pre-invoking groovy as a TCP/IP server.
long_description	In the case of scripting in dynamic-type languages, quick response about \
					invocation is very important. Try-and-run cycles is repeated frequently \
					than static-type languages, so sometimes 2 seconds or even a second might \
					be intolerable. \
					GroovyServ reduces the startup time of JVM and Groovy runtime significantly.
homepage			http://kobo.github.com/groovyserv/index.html
platforms			darwin
distname			${name}-${version}-macosx-bin
master_sites		http://github.com/downloads/kobo/groovyserv
checksums 			md5 6f569113bc4b7d0c9716ed73b2d1b5d5 \
					sha1 d554a47deb6dc250a46f3b8ef889d9fdf2758b60 \
					rmd160 da67a6866bca7eb2ea6838b1b065a3453ad0a5d1

worksrcdir			${name}-${version}
set workTarget		""

use_zip	         	yes
use_configure 		no

build.cmd 			true

pre-destroot {
	# Remove extraneous bat files
	foreach f [glob -directory ${worksrcpath}${workTarget}/bin *.bat] {
		file delete $f
	}
}

destroot	{
	# Create the target java directory
	xinstall -m 755 -d ${destroot}${prefix}/share/devel/${name}

	# Copy over the needed elements of our directory tree
	file copy ${worksrcpath}/lib     						\
			  ${worksrcpath}/bin 							\
			  ${destroot}${prefix}/share/devel/${name}

	# Symlink groovyserv into the bin directory
	system "cd ${destroot}${prefix}/bin && ln -s ${prefix}/share/devel/${name}/bin/groovyserver"
	system "cd ${destroot}${prefix}/bin && ln -s ${prefix}/share/devel/${name}/bin/groovyclient"
}
