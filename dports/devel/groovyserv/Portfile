# $Id$

PortSystem 1.0

name				groovyserv
version				0.7
categories			devel groovy
maintainers			breskeby
description			GroovyServ makes Groovy startup time quicker, by pre-invoking groovy as a TCP/IP server.
long_description	In the case of scripting in dynamic-type languages, quick response about \
					invocation is very important. Try-and-run cycles is repeated frequently \
					than static-type languages, so sometimes 2 seconds or even a second might \
					be intolerable. \
					GroovyServ reduces the startup time of JVM and Groovy runtime significantly.
homepage			http://kobo.github.com/groovyserv/index.html
platforms			darwin
distname			${name}-${version}-macosx-x86_64-bin
master_sites		http://github.com/downloads/kobo/groovyserv
checksums 			md5     33dcd422498848e24923bf2d99866abb \
                    sha1    d9339c320e7654b20307098169eda1d55eacd3f9 \
                    rmd160  748c0132d03e3efa8be15a61f75db2fa44fdd2e8

worksrcdir			${name}-${version}
set workTarget		""

use_zip	         	yes
use_configure 		no

build.cmd 			true

pre-destroot {
	# Remove extraneous bat files
	foreach f [glob -directory ${worksrcpath}${workTarget}/bin *.bat] {
		file delete $f
	}
}

destroot	{
	# Create the target java directory
	xinstall -m 755 -d ${destroot}${prefix}/share/devel/${name}

	# Copy over the needed elements of our directory tree
	file copy ${worksrcpath}/lib     						\
			  ${worksrcpath}/bin 							\
			  ${destroot}${prefix}/share/devel/${name}

	# Symlink groovyserv into the bin directory
	system "cd ${destroot}${prefix}/bin && ln -s ${prefix}/share/devel/${name}/bin/groovyserver"
	system "cd ${destroot}${prefix}/bin && ln -s ${prefix}/share/devel/${name}/bin/groovyclient"
}
