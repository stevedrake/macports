# $Id$

PortSystem 1.0
name		hs-hinstaller
version		2007.5.13
distname	hinstaller-${version}
categories	devel
maintainers	me@thomaskeller.biz
description	The hinstaller library for Haskell
long_description	\
	This module allows you to incorporate arbitrary files into \
	a haskell module during compilation. The files are then \
	available to you through functions which allows you to \
	write installer-type applications which write out the \
	files when run. Thus this can be considered in the same \
	model as Java .jar files or executable zip or other \
	file archives.

homepage	http://www.wellquite.org/hinstaller/
master_sites	http://hackage.haskell.org/packages/archive/hinstaller/${version}/
checksums	md5 3ae4db8f48e9cf7dec9438c7689ede3a

depends_build	port:ghc

configure {
	cd ${worksrcpath}
	system "runghc Setup.hs configure --prefix=${prefix}"
}

build {
	cd ${worksrcpath}
	system "runghc Setup.hs build"
}

destroot {
	cd ${worksrcpath}
	system "runghc Setup.hs copy --copy-prefix=${destroot}${prefix}"
	system "runghc Setup.hs register   --gen-script"
	system "runghc Setup.hs unregister --gen-script"

	file mkdir ${destroot}${prefix}/libexec/${name}
	file copy ${worksrcpath}/register.sh \
		  ${destroot}${prefix}/libexec/${name}
	file copy ${worksrcpath}/unregister.sh \
		  ${destroot}${prefix}/libexec/${name}

}

post-activate   { system "${prefix}/libexec/${name}/register.sh" }

#pre-deactivate { system "${prefix}/libexec/${name}/unregister.sh" }

