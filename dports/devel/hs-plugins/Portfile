# $Id: Portfile,v 1.6 2005/02/23 15:12:09 gwright Exp $

PortSystem 1.0
name		hs-plugins
version		0.9.8
categories	devel
maintainers	gwright@opendarwin.org
platforms	darwin

description	A plugin library for Haskell
long_description	\
		hs-plugins was originally designed as a system		\
		for replacing all the various configuration languagesxi	\
		in existence (particularly mutt and vim) but developed	\
		to be very suitable for plugins in general.

homepage	http://www.cse.unsw.edu.au/~dons/hs-plugins/hs-plugins.html
master_sites	ftp://ftp.cse.unsw.edu.au/pub/users/dons/hs-plugins/

checksums	md5 2a809ef92f3ec5970b99aeb22078fb3e

depends_build	bin:ghc:ghc

configure.args	--prefix=${destroot}/${prefix}

post-activate	{ cd ${worksrcpath}

		  # start by unregistering old versions

		  system "ghc-pkg -r printf  || true"
		  system "ghc-pkg -r eval    || true"
		  system "ghc-pkg -r plugins || true"
		  system "ghc-pkg -r hi      || true"
		  system "ghc-pkg -r altdata || true"

		  system "PREFIX=${prefix} LIBDIR=${prefix}/lib/${name} ghc-pkg -u < src/altdata/altdata.conf.in"
		  system "PREFIX=${prefix} LIBDIR=${prefix}/lib/${name} ghc-pkg -u < src/hi/hi.conf.in"
		  system "PREFIX=${prefix} LIBDIR=${prefix}/lib/${name} ghc-pkg -u < src/plugins/plugins.conf.in"
		  system "PREFIX=${prefix} LIBDIR=${prefix}/lib/${name} ghc-pkg -u < src/eval/eval.conf.in"
		  system "PREFIX=${prefix} LIBDIR=${prefix}/lib/${name} ghc-pkg -u < src/printf/printf.conf.in"

		  system "ranlib ${prefix}/lib/${name}/libHSplugins.a"
		  system "ranlib ${prefix}/lib/${name}/libHShi.a"
		  system "ranlib ${prefix}/lib/${name}/libHSaltdata.a"
		  system "ranlib ${prefix}/lib/${name}/libHSeval.a"
		  system "ranlib ${prefix}/lib/${name}/libHSprintf.a"
		}
