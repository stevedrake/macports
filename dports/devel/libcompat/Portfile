# $Id$

PortSystem 1.0
name		libcompat
version		4.6.2-RELEASE
categories	devel
maintainers	nomaintainer@macports.org
description	Compatibility library with functionality from 4BSD
#homepage
platforms	darwin
use_bzip2	yes
master_sites	opendarwin
checksums	md5 4e0ddeec2be3a2c8caf24a3ed51b8501
build.type	bsd
worksrcdir	${name}
use_configure	no
patchfiles	patch-Makefile
build.env	LDADD="-install_name ${prefix}/lib/libcompat.1.dylib"

destroot	{
	file copy ${worksrcpath}/libcompat.1.dylib ${destroot}${prefix}/lib
	system "cd ${worksrcpath} && ln -sf libcompat.1.dylib \
		${destroot}${prefix}/lib/libcompat.dylib"
	
	# Copy regexp.h on Tiger
	if {[variant_isset macosx-framework]} {
		file copy "${portpath}/${filesdir}/regexp.h" "${destroot}${prefix}/include/"
	}
}

platform darwin 8 {
	# Tiger no longer provides regexp.h
	post-patch {
		file copy "${portpath}/${filesdir}/regexp.h" "${worksrcpath}/4.3/"
	}
	
	patchfiles-append patch-4.3-regex.c
}

