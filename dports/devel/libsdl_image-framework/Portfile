# $Id$
PortSystem		1.0
PortGroup		xcode 1.0

name			libsdl_image-framework
set my_name		SDL_image
version			1.2.6
categories		devel graphics
maintainers		nox openmaintainer
description		Add on library for libSDL handling several image formats
long_description	This is a simple library to load images of various \
			formats as SDL surfaces. This library supports BMP, \
			PPM, PCX, GIF, JPEG, PNG, TGA, and TIFF formats.

platforms		macosx
homepage		http://www.libsdl.org/projects/SDL_image/
master_sites    ${homepage}release/
distname		${my_name}-${version}
dist_subdir		[strsed ${name} {/-.*$//}]

checksums		md5 b866dc4f647517bdaf57f6ffdefd013e \
				sha1 5045df31e4db29d8890110fd18024c9d08efca30 \
				rmd160 8aea5f07216eb887f599c0908f8ea2c2f9eeac93

depends_lib		port:libpng \
				port:jpeg \
				port:zlib \
				port:libsdl-framework

worksrcdir		${distname}/Xcode

xcode.target		Framework
xcode.destroot.type framework

post-extract {
	system "cd ${workpath}/${distname} && tar -xvzf Xcode.tar.gz"
}

post-patch {
	reinplace "s|~/Library/Frameworks|./build/Frameworks|g" \
		${worksrcpath}/SDL_image.xcodeproj/project.pbxproj
	reinplace "s|\$(HOME)/Library/Frameworks|/Library/Frameworks|g" \
		${worksrcpath}/SDL_image.xcodeproj/project.pbxproj
	reinplace "s|\$HOME/Library/Frameworks|/Library/Frameworks|g" \
		${worksrcpath}/SDL_image.xcodeproj/project.pbxproj
	reinplace "s|graphics/include| ${prefix}/include|g" \
		${worksrcpath}/SDL_image.xcodeproj/project.pbxproj
	reinplace "s|graphics/lib|${prefix}/lib|g" \
		${worksrcpath}/SDL_image.xcodeproj/project.pbxproj
}

platform darwin i386 {
	if {! [variant_isset universal]} {
		xcode.build.settings-append 	ARCHS=i386
		xcode.destroot.settings-append	ARCHS=i386
	}
}

platform darwin powerpc {
	if {! [variant_isset universal]} {
		xcode.build.settings-append 	ARCHS=ppc
		xcode.destroot.settings-append	ARCHS=ppc
	}
}

livecheck.check	regex
livecheck.url	${homepage}
livecheck.regex	"${my_name}-(\\d+(?:\\.\\d+)*)"
