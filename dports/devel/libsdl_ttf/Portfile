# $Id: Portfile,v 1.4 2005/01/24 06:43:28 rshaw Exp $

PortSystem 1.0

name		libsdl_ttf
version		2.0.7
categories	devel graphics
maintainers	mww@opendarwin.org rshaw@opendarwin.org
platforms	darwin
description	add on library for libSDL for rendering TrueType fonts
long_description	This library is a wrapper around the excellent \
			FreeType 2.0 library allowing to render TrueType fonts \
			in SDL applications.
	
homepage	http://www.libsdl.org/projects/SDL_ttf
master_sites	${homepage}/release/
distname	SDL_ttf-${version}
checksums	md5 0f6ee1a502e6913a412aac353dc75bbc

depends_lib	bin:sdl-config:libsdl \
			lib:libfreetype.6:freetype

configure.args	--disable-sdltest

post-destroot	{
	xinstall -m 0755 -d ${destroot}${prefix}/share/doc/${name}
	xinstall -m 0644 -W ${worksrcpath} CHANGES COPYING README \
		${destroot}${prefix}/share/doc/${name}
}

platform darwin {
	post-extract {
		system "cd ${worksrcpath} && tar -xvzf PBProjects.tar.gz"
	}
	post-patch {
		reinplace "s|~/Library/Frameworks|./build/Frameworks|g" \
			${worksrcpath}/PBProjects/SDL_ttf.pbproj/project.pbxproj
		reinplace "s|\$(HOME)/Library/Frameworks|/Library/Frameworks|g" \
			${worksrcpath}/PBProjects/SDL_ttf.pbproj/project.pbxproj
		reinplace "s|freetype/include|/usr/X11R6/include/freetype2|g" \
			${worksrcpath}/PBProjects/SDL_ttf.pbproj/project.pbxproj
		reinplace "s|freetype/lib|/usr/X11R6/lib|g" \
			${worksrcpath}/PBProjects/SDL_ttf.pbproj/project.pbxproj
	}
	post-build {
		build.dir		"${worksrcpath}/PBProjects"
		build.type		pbx
		build.target	-buildstyle Deployment -target Framework
		system "[command build]"
		cd ${worksrcpath}/PBProjects
		system "install_name_tool -id /Library/Frameworks/SDL_ttf.framework/SDL_ttf \
			build/Frameworks/SDL_ttf.framework/SDL_ttf"
	}
	destroot.dir	${worksrcpath}
	destroot.cmd	make
	post-destroot {
		cd "${worksrcpath}/PBProjects/build/Frameworks"
		xinstall -d -m 0755 ${destroot}/Library/Frameworks
		system "cp -R SDL_ttf.framework ${destroot}/Library/Frameworks"
	}
}

platform darwin 6 {
	depends_lib-append	lib:libdl:dlcompat
}

