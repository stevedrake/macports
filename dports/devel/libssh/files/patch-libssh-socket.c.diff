--- libssh/socket.c.orig	2010-12-28 00:45:04.000000000 -0500
+++ libssh/socket.c	2010-12-28 00:45:21.000000000 -0500
@@ -33,7 +33,8 @@
 #include <sys/types.h>
 #include <sys/socket.h>
 #include <sys/un.h>
-extern char **environ;
+#include <crt_externs.h>
+#define environ (*_NSGetEnviron())
 #endif
 #include "libssh/priv.h"
 #include "libssh/socket.h"
