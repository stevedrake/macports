# $Id$

PortSystem		1.0

name            m4
version         1.4.15
revision        2
categories      devel
maintainers     blair openmaintainer
platforms       darwin
description     GNU macro processor

long_description \
    GNU `m4' is an implementation of the traditional Unix macro         \
    processor.  It is mostly SVR4 compatible, although it has some      \
    extensions (for example, handling more than 9 positional parameters \
    to macros). `m4' also has built-in functions for including files,   \
    running shell commands, doing arithmetic, etc. Autoconf needs GNU   \
    `m4' for generating `configure' scripts, but not for running them.

homepage        http://www.gnu.org/software/m4/
master_sites    gnu
use_bzip2       yes

checksums           md5     c7c32540bc3842d5550f88d47ef551d8 \
                    sha1    f001dcb67ad1e77db68a6c2b3923a4e3e067c25b \
                    rmd160  b0cebc31b95c33278394390d3b2a0cb1152c5dc7

configure.args  --program-prefix=g \
                ac_cv_libsigsegv=no

use_parallel_build  yes

post-destroot {
    move ${destroot}${prefix}/share/info/m4.info ${destroot}${prefix}/share/info/gm4.info

	set docdir ${prefix}/share/doc/${name}-${version}
	xinstall -d ${destroot}${docdir}
	xinstall -m 0644 -W ${worksrcpath} AUTHORS COPYING ChangeLog NEWS README THANKS \
		TODO ${destroot}${docdir}

    xinstall -m 755 -d ${destroot}${prefix}/libexec/gnubin
    foreach binary [glob -tails -directory ${destroot}${prefix}/bin g*] {
        ln -s ${prefix}/bin/${binary} ${destroot}${prefix}/libexec/gnubin/[string range $binary 1 end]
    }
}

test.run        yes
test.target     check
test.env        TMPDIR=/tmp
