# $Id$

PortSystem 1.0

# Although mpfr builds without a custom universal variant,
# it is not the same as builing the archs differently
# due to the variable HAVE_LDOUBLE_IEEE_EXT_LITTLE.
PortGroup  muniversal 1.0

name            mpfr
version         2.3.2
categories      devel math
platforms       darwin
maintainers     vincent-opdarw@vinc17.org

description     C library for multiple-precision floating-point computations
long_description \
    MPFR is a portable C library for arbitrary-precision binary \
    floating-point computation with correct rounding, based on the GMP \
    multiple-precision library. The computation is both efficient and \
    has a well-defined semantics. It copies the good ideas from the \
    ANSI/IEEE-754 standard for fixed-precision floating-point arithmetic.

homepage        http://www.mpfr.org/
master_sites    http://www.mpfr.org/mpfr-${version}/

checksums \
    ${distname}.tar.bz2 md5 527147c097874340cb9cee0579dacf3b \
    ${distname}.tar.bz2 sha1 37dbd478e1c136f37cf4c68eb1522e86e2307288 \
    ${distname}.tar.bz2 rmd160 7f025fa03450cd64e57b226804d013614ef7d165

use_bzip2       yes
use_parallel_build yes

depends_lib     port:gmp

dist_subdir     ${name}/${version}

#patch_sites     ${master_sites}
#patchfiles      patch01 patch02 patch03 patch04
#patch.args      -p1

test.run        yes
test.target     check

post-destroot {
    set docdir ${destroot}${prefix}/share/doc/${name}
    file mkdir ${docdir}
    xinstall -m 644 -v -W ${worksrcpath} \
      AUTHORS BUGS COPYING.LIB FAQ.html NEWS TODO ${docdir}
}

# universal_archs_supported must be the same as gmp
if { ${os.arch}=="i386" } {
    if { [llength ${universal_archs}] > 2 } {
        set universal_archs_supported  "i386 x86_64"
    }
} else {
    set universal_archs_supported  "ppc ppc64"
}

array set merger_host {
    i386    i386-apple-darwin
    x86_64  x86_64-apple-darwin
}

livecheck.url    http://www.mpfr.org/mpfr-current/
livecheck.regex  "mpfr-(\\d+(?:\\.\\d+)*)${extract.suffix}"
