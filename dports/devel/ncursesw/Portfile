# $Id$

PortSystem		1.0

name			ncursesw
version			5.7
revision        1
categories		devel
platforms		darwin freebsd
maintainers		jmr openmaintainer
description		emulation of curses in System V Release 4.0
long_description	The Ncurses (new curses) library is a free software \
				emulation of curses in System V Release 4.0, and more. It uses \
				Terminfo format, supports pads and color and multiple \
				highlights and forms characters and function-key mapping, and \
				has all the other SYSV-curses enhancements over BSD Curses. \
				This library offers wide-character/UTF-8 support.

homepage		http://www.gnu.org/software/ncurses/ncurses.html
master_sites		gnu:ncurses
distname		ncurses-${version}
dist_subdir		ncurses

checksums		md5		cce05daf61a64501ef6cd8da1f727ec6 \
				sha1	8233ee56ed84ae05421e4e6d6db6c1fe72ee6797 \
				rmd160	a19ca026d32255f5a4d22eb006d65182041e0234

# from http://www.opensource.apple.com/source/ncurses/ncurses-27/patches/
patchfiles      hex.diff ungetch_guard.diff

configure.cppflags
configure.ldflags
configure.args	--enable-widec \
				--disable-rpath \
				--with-shared \
				--without-debug  \
				--without-ada \
				--enable-safe-sprintf \
				--enable-sigwinch \
				--mandir=${prefix}/share/man \
				--with-manpage-format=normal

platform darwin 10 {
	configure.args-delete --enable-safe-sprintf
}
platform darwin 11 {
	configure.args-delete --enable-safe-sprintf
}

if {[variant_isset universal]} {
    configure.args-append --with-chtype=int

    # check that this doesn't start breaking anything with new versions
	post-configure {
	    reinplace s/1UL/1U/g "${worksrcpath}/include/curses.head"
	    system "cd ${worksrcpath} && ed - include/curses.head < ${filespath}/include_curses.head.ed"
	}
}

use_parallel_build	yes
