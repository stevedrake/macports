# $Id$

PortSystem 1.0

name            readline
 set milestone  5.2
 set patchlevel 007
version         ${milestone}.${patchlevel}
distname        ${name}-${milestone}
categories      devel
platforms       darwin freebsd
maintainers     nomaintainer
description     Library that provides command line editing

long_description \
    The GNU Readline library provides a set of functions for use by         \
    applications that allow users to edit command lines as they are typed   \
    in. Both Emacs and vi editing modes are available. The Readline library \
    includes additional functions to maintain a list of previously-entered  \
    command lines, to recall and perhaps reedit those lines, and perform    \
    csh-like history expansion on previous commands.

homepage        http://cnswww.cns.cwru.edu/~chet/readline/rltop.html
master_sites    gnu ftp://ftp.cwru.edu/pub/bash/


patch_sites     gnu:${name}/${distname}-patches/ \
                ftp://ftp.cwru.edu/pub/bash/${distname}-patches/
patchfiles      ${name}52-001 ${name}52-002 ${name}52-003 ${name}52-004 \
                ${name}52-005 ${name}52-006 ${name}52-007

checksums       [suffix ${distname}] \
                    md5 e39331f32ad14009b9ff49cc10c5e751 \
                    sha1 18f3412c73068509d5f491b7b4535aeaf9522834 \
                    rmd160 983cbb25192e0a376b80cb2428fe8ee254a041c7 \
                ${name}52-001 \
                    md5 9d4d41622aa9b230c57f68548ce87d8f \
                    sha1 8de77c2de3926893cbf2688912768bed48a2456b \
                    rmd160 0cedb82ccc4709e6b39e6cb95143131259b0e7c5 \
                ${name}52-002 \
                    md5 f03e512d14206e37f7d6a748b56b9476 \
                    sha1 db5baf0129357ba9397dfcd24e9f6db0abdcbc7a \
                    rmd160 c9bbff4b1ba2ff77e5a43ad98a94f4753e5f0aa3 \
                ${name}52-003 \
                    md5 252b42d8750f1a94b6bdf086612dceb2 \
                    sha1 7a879ce1ccb10ad65c34d3eeced9f4b79ac68434 \
                    rmd160 4007b1dcd19d204f6ce75fe5a60a5c780f221a12 \
                ${name}52-004 \
                    md5 a32333c2e603a3ed250514e91050e552 \
                    sha1 00f91e9784e2c74415bccff8cad4604424c4d470 \
                    rmd160 7c8ef28a2d4fb6054aa84e0abfbdff0d446c0c90 \
                ${name}52-005 \
                    md5 8106796c09b789523a3a78ab69c04b6d \
                    sha1 ba68f91097cbf8ccb162340c92131922458faefc \
                    rmd160 9a588f4ad425cff31ba78cef7083c53e8b3b8693 \
                ${name}52-006 \
                    md5 512188e2bf0837f7eca19dbf71f182ae \
                    sha1 0c55402c4fbc8d932dd90cad42925182d02ecc26 \
                    rmd160 56649a55aeac4141992143fe2d11363ef6f45ee2 \
                ${name}52-007 \
                    md5 ac17aca62eb6fb398c9f2fe9de540aff \
                    sha1 30dba802dc07e6f2e75cb300e920affa6863933d \
                    rmd160 31eaeca99f33b04816eb103c66915518da4b240a

configure.args  --mandir=${prefix}/share/man \
                --infodir=${prefix}/share/info \
                --with-curses

depends_lib     port:ncurses

post-destroot {
    delete ${destroot}${prefix}/share/info/dir

    set docdir ${prefix}/share/doc/${name}-${version}
    xinstall -d ${destroot}${docdir}/html
    xinstall -m 0644 -W ${worksrcpath} CHANGELOG CHANGES COPYING NEWS README \
        ${destroot}${docdir}
    eval xinstall -m 0644 [glob ${worksrcpath}/doc/*.html] \
        ${destroot}${docdir}/html
}

platform darwin {
    post-destroot {
        foreach f {history readline} {
            foreach v {0 1} {
                system "cd ${destroot}${prefix}/lib && \
                ln -s ${prefix}/lib/lib${f}.${milestone}.dylib lib${f}.5.${v}.dylib"
            }
        }
    }
}

platform darwin 9 {
    # establish the variant
}

pre-configure {
    if {[variant_isset darwin_9]} {
        reinplace s|darwin8|darwin9|g ${worksrcpath}/support/shobj-conf
    }
}

livecheck.check     regex
livecheck.url       http://ftp.gnu.org/pub/gnu/${name}/?C=M&O=D
livecheck.regex     ${name}-(\\d+(?:\\.\\d+)*)
livecheck.version   ${milestone}

