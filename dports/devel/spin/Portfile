# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem      1.0

name            spin
version         5.2.2
set version_no_dot [join [split ${version} .] ""]
distname        ${name}${version_no_dot}
categories      devel
platforms       darwin
maintainers     jann
description     The Spin model checker

long_description \
    SPIN is a general tool for verifying the correctness of \
    distributed software (software design) in a rigorous and \
    mostly automated fashion.

homepage        http://spinroot.com
master_sites    http://spinroot.com/spin/Src/
checksums       md5     71704ff4af9738eca68bcab7cd62d72f \
                sha1    049fe676b079cbe9e278099544fbb055c92e3927 \
                rmd160  4a37d647fd1dfe782a5e552d363822528a3c55c6
depends_lib     port:tk port:tcl
patchfiles      patch-makefile.diff \
                patch-xspin.diff
worksrcdir      Spin/Src${version}
use_configure   no
use_parallel_build no

set xspin_dir   Xspin5.2
set xspin_name  xspin521.tcl

pre-patch   {
    file rename ${worksrcpath}/../${xspin_dir}/${xspin_name} ${worksrcpath}/../${xspin_dir}/xspin
}

post-patch  {
    reinplace "s,@prefix@,${prefix},g" ${worksrcpath}/../${xspin_dir}/xspin
}

build.target    ""
build.args      CC="${configure.cc} -DNXT"

destroot    {
    xinstall -m 0444 ${worksrcpath}/../Man/${name}.1 \
        ${destroot}${prefix}/share/man/man1
    xinstall -m 0755 ${worksrcpath}/${name} \
        ${destroot}${prefix}/bin
    xinstall -m 0755 ${worksrcpath}/../${xspin_dir}/xspin \
        ${destroot}${prefix}/bin
}
