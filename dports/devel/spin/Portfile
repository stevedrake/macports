# $Id$

PortSystem      1.0

name            spin
version         5.1.6
set version_no_dot [join [split ${version} .] ""]
distname        ${name}${version_no_dot}
categories      devel
platforms       darwin
maintainers     jann@macports.org
description     The Spin model checker

long_description \
    SPIN is a general tool for verifying the correctness of \
    distributed software (software design) in a rigorous and \
    mostly automated fashion.

homepage        http://spinroot.com
master_sites    http://spinroot.com/spin/Src/
checksums       rmd160 fcb46fba69df9a022a2c5070115fdf0aa735758f
depends_lib     port:tk port:tcl
patchfiles      patch-makefile.diff \
                patch-xspin.diff
worksrcdir      Spin
use_configure   no

set xspin_dir   Xspin5.1
set xspin_name  xspin510.tcl

pre-patch   {
    file rename ${worksrcpath}/${xspin_dir}/${xspin_name} ${worksrcpath}/${xspin_dir}/xspin
}

post-patch  {
    reinplace "s,@prefix@,${prefix},g" ${xspin_dir}/xspin
}

build       {
    cd ${worksrcpath}/Src${version}
    exec make
}

destroot    {
    xinstall -m 0444 ${worksrcpath}/Man/${name}.1 \
        ${destroot}${prefix}/share/man/man1
    xinstall -m 0755 ${worksrcpath}/Src${version}/${name} \
        ${destroot}${prefix}/bin
    xinstall -m 0755 ${worksrcpath}/${xspin_dir}/xspin \
        ${destroot}${prefix}/bin
}
