--- coregrind/vg_preloaded.c
+++ coregrind/vg_preloaded.c
@@ -151,17 +151,18 @@ static void vg_cleanup_env(void)
    Darwin arc4random (rdar://6166275)
    ------------------------------------------------------------------ */
 
-#include <stdio.h>
+#include <fcntl.h>
+#include <unistd.h>
 
 int VG_REPLACE_FUNCTION_ZU(libSystemZdZaZddylib, arc4random)(void);
 int VG_REPLACE_FUNCTION_ZU(libSystemZdZaZddylib, arc4random)(void)
 {
-    static FILE *rnd = 0;
+    static int rnd = -1;
     int result;
 
-    if (!rnd) rnd = fopen("/dev/random", "r");
-    
-    fread(&result, sizeof(result), 1, rnd);
+    if (rnd < 0) rnd = open("/dev/random", O_RDONLY);
+
+    read(rnd, &result, sizeof(result));
     return result;
 }
 
