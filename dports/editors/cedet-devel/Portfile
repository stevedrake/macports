# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem      1.0

name            cedet-devel
set my_name     cedet
version         1.0pre7
categories      editors
platforms       darwin
maintainers     nomaintainer
description     Infrastructure for parser based text analysis in Emacs

long_description \
    Semantic is an infrastructure for parser based text analysis in Emacs. \
    It is a lexer, parser-generator, and parser. It is written in Emacs \
    Lisp and is customized to the way Emacs thinks about language files, \
    and is optimized to use Emacs' parsing capabilities.

homepage        http://cedet.sourceforge.net/
master_sites    sourceforge:$my_name
distname        $my_name-$version

checksums       md5     e9862e293d27ae03c74f510a2a40c1eb \
                sha1    b48bfe50df43b6941e9ffd40256c10d58b14b832 \
                rmd160  4f90db2ad9c63a3d8ff6ac9e3a1c83f99fb2b777

depends_lib     port:emacs

use_configure   no

use_parallel_build  yes

destroot {
    set lispdir $prefix/share/emacs/site-lisp

    set packages {
        common
        ede
        speedbar
        eieio
        semantic
        cogre
        contrib
        srecode
    }

    proc destroot_package package_dir {
        global  destroot worksrcpath
        upvar   lispdir lispdir

        xinstall -d $destroot$lispdir/$package_dir
        foreach f [glob -directory $worksrcpath/$package_dir *] {
            if {[file isdirectory $f]} {
                set p [file tail $f]

                if {$p ne "." && $p ne ".."} {
                    destroot_package $package_dir/$p
                }
            } else {
                set ext [file extension $f]

                if {$ext eq ".el" || $ext eq ".elc"} {
                    xinstall -m 644 $f $destroot$lispdir/$package_dir
                }
            }
        }
    }

    foreach p $packages {
        destroot_package $p
    }
}
