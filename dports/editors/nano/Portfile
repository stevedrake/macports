# $Id$

PortSystem 1.0
name             nano
version          2.0.6
categories       editors
maintainers      n.oxyde@gmail.com
description      Nano's ANOther editor - enhanced free Pico Clone
long_description \
    GNU nano is a small and friendly text editor. Besides basic text \
    editing, nano offers many extra features like an interactive search \
    and replace, goto line number, auto-indentation, feature toggles, \
    internationalization support, and filename tab completion.

homepage         http://www.nano-editor.org/
master_sites     ${homepage}dist/v[strsed ${version} {/\.[0-9]*$//}]/ gnu
checksums        md5 619107f0fc3c4383d668cef15aa3ca32 \
                 sha1 00102580404cdb1c8594e5f6193000d5acac2249 \
                 rmd160 858dc7cf7137cc2b19e9084a503fe508ef734381

platforms        darwin freebsd
depends_lib      port:ncurses

configure.args   --enable-nanorc \
                 --disable-nls \
                 --disable-wrapping-as-root \
                 --disable-mouse \
                 --disable-largefile \
                 --disable-utf8

destroot.target  install-strip

post-destroot {
    xinstall -m 0755 -d ${destroot}${prefix}/share/doc/${name}/docs
    xinstall -m 0644 -W ${worksrcpath} AUTHORS BUGS COPYING ChangeLog INSTALL NEWS \
        README THANKS TODO doc/faq.html doc/nanorc.sample doc/texinfo/nano.html \
        ${destroot}${prefix}/share/doc/${name}
}

post-install {
    ui_msg "A sample configuration file is available at ${prefix}/share/doc/${name}/nanorc.sample ."

    if {! [variant_isset no_spell]} {
        ui_msg "Spell-checking support is enabled. To use it, you need a spellchecker e.g. aspell, ispell..."
    }
}

variant nls {
    configure.args-delete   --disable-nls
    depends_lib-append      port:gettext \
                            port:libiconv
}

variant utf8 {
    configure.args-append   --enable-utf8
    configure.args-delete   --disable-utf8
    depends_lib-append      port:ncursesw
    depends_lib-delete      port:ncurses
}

variant no_wrap {
    configure.args-append   --disable-wrapping
}

variant no_spell {
    configure.args-append   --disable-speller
}

variant mouse {
    configure.args-delete   --disable-mouse

    post-install {
        ui_msg "Mouse support is enabled. ${name} need to be launched inside an x11 console to use it."
    }
}

variant multibuffer {
    configure.args-append   --enable-multibuffer
}

variant color {
    configure.args-append   --enable-color

    post-install {
        ui_msg "Color syntax is enabled. You should take a look at the syntax definitions in ${prefix}/share/${name} ."
    }
}

variant largefile {
    configure.args-delete   --disable-largefile
}

livecheck.check regex
livecheck.url   http://ftp.gnu.org/gnu/${name}/?M=D
livecheck.regex ${name}-(\\d+\\.\\d+\\.\\d+)
