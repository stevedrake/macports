# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*-
# $Id$
# vim: set fileencoding=utf-8 tabstop=8 shiftwidth=4 softtabstop=4 noexpandtab filetype=tcl :

PortSystem	    1.0

name		    sigil
version		    0.1.3
#epoch		    20090114
revision	    0
platforms	    darwin
categories	    editors
maintainers	    macports.org:krischik
description	    Sigil, the ePub editor
long_description					\
    Sigil is a multi-platform WYSIWYG ebook editor. It	\
    is designed to edit books in ePub format

homepage	    http://code.google.com/p/sigil
master_sites	    googlecode

distfiles	    Sigil_code_${version}.zip
worksrcdir	    build

checksums           md5     60ba640201420704ce3b500c7d96f6fd \
                    sha1    83349aec2f5dcfb066e85651e66e16b259c23d4f \
                    rmd160  616abfc8d6c770cc38d03a106a2de981cd1c6270

use_zip		    yes
use_parallel_build  yes

depends_build       bin:cmake:cmake \
		    bin:gmake:gmake
depends_lib	    port:qt4-mac

configure.env	    PATH="${prefix}/libexec/qt4-mac/bin:$env(PATH)"
configure.cmd	    "cmake"
configure.args	    "-G \"Unix Makefiles\" ${workpath}/Sigil_code_${version}"

build.env	    PATH="${prefix}/libexec/qt4-mac/bin:$env(PATH)"
build.cmd	    "gmake"
build.args	    ""
build.target	    "Sigil"

platform x86_64 {
    pre-configure {
	reinplace "s|ppc;i386|x86_64|g" ${workpath}/Sigil_code_${version}/CMakeLists.txt
    }
}

platform powerpc {
    pre-configure {
	reinplace "s|ppc;i386|ppc|g" ${workpath}/Sigil_code_${version}/CMakeLists.txt
    }
}

platform i386 {
    pre-configure {
	reinplace "s|ppc;i386|i386|g" ${workpath}/Sigil_code_${version}/CMakeLists.txt
    }
}

pre-configure {
    file mkdir ${worksrcpath}
}

destroot {
    xinstall -d ${destroot}${applications_dir}

    copy					\
	${worksrcpath}/bin/Sigil.app		\
	${destroot}${applications_dir}
}

