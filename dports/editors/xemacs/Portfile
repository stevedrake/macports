# $Id $

PortSystem 1.0
name		xemacs
version		21.4.15
categories	editors
maintainers	jkh@opendarwin.org
description	A highly customizable open source text editor.
long_description \
		 XEmacs is a highly customizable open source text editor and \
		 application development system. It is protected under the \
		 GNU Public License and related to other versions of Emacs, \
		 in  particular GNU Emacs.
platforms	darwin
homepage	http://www.xemacs.org
master_sites	ftp://ftp.us.xemacs.org/pub/xemacs/xemacs-21.4 \
		http://ftp.us.xemacs.org/ftp/pub/xemacs/xemacs-21.4 \
		ftp://ibiblio.org/pub/packages/editors/xemacs/xemacs-21.4 \
		http://ibiblio.org/pub/packages/editors/xemacs/xemacs-21.4 \
		http://mirrors.mix5.com/xemacs/xemacs-21.4 \
		http://www.binarycode.org/xemacs/xemacs-21.4 \
		http://www.online-mirror.org/xemacs/xemacs-21.4 \
		http://xemacs.software-archive.net/xemacs-21.4

checksums	${name}-${version}${extract.suffix} \
	 	 md5 b80e040d9cb85c9210999554dc210fa6

configure.args	--with-dialogs=athena --with-widgets=athena --with-athena=3d \
		--without-postgresql --without-ldap --with-sound=none --pdump \
		--site-prefixes=${prefix}

depends_lib	lib:libpng.3:libpng lib:libXaw3d.7:Xaw3d

# Add in xemacs-base, and xemacs-efs
set efs_dist 	    efs-1.32-pkg.tar.gz
set xemacsbase_dist xemacs-base-1.86-pkg.tar.gz

master_sites-append ftp://ftp.us.xemacs.org/pub/xemacs/packages \
		    http://ftp.us.xemacs.org/ftp/pub/xemacs/packages \
		    ftp://ibiblio.org/pub/packages/editors/xemacs/packages \
		    http://ibiblio.org/pub/packages/editors/xemacs/packages \
		    http://mirrors.mix5.com/xemacs/packages \
		    http://www.binarycode.org/xemacs/packages \
		    http://www.online-mirror.org/xemacs/packages \
		    http://xemacs.software-archive.net/packages

distfiles-append    ${efs_dist} ${xemacsbase_dist}

checksums-append    ${efs_dist} md5 6123c11bc7a9c993429e9976f7bf42c4 \
		    ${xemacsbase_dist} md5 ab5151789560a085f901dea51f22fbfd

destroot.args	    prefix=${destroot}/${prefix}

set xemacs_lib	   ${destroot}${prefix}/lib/xemacs-${version}
set pkg_contents   "etc info lisp man pkginfo"

post-destroot {
	     ui_info "Installing packages into destroot"

	     system "touch ${destroot}${prefix}/lib/xemacs/.keep"
	     system "mkdir ${xemacs_lib}/xemacs-packages"

	     system "tar -cpf - -C ${worksrcpath}/.. ${pkg_contents} | \
	     	     tar -xpf - -C ${xemacs_lib}/xemacs-packages"
}



variant sumo {
	set sumo_version	2004-05-17
	set sumo_dist		${name}-sumo-${sumo_version}${extract.suffix}

	distfiles-append	${sumo_dist}
	checksums-append	${sumo_dist} \
				 md5 934ce5325014d24500cd5bdb4c0f705d

	post-destroot {
		ui_info "Installing sumo distribution into destroot"
		system "cp -Rp ${worksrcpath}/../xemacs-packages ${xemacs_lib}"
	}

}


