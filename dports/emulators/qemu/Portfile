# $Id$

PortSystem 1.0

name                    qemu
version                 0.13.0
categories              emulators
platforms               darwin
maintainers             nomaintainer

description             x86 and PowerPC Emulator
long_description        QEMU is a FAST! processor emulator using dynamic \
                        translation to achieve good emulation speed. It \
                        can emulate a Full PC System and has basic support \
                        for PowerMac Emulation.

homepage                http://wiki.qemu.org/
master_sites            nongnu

checksums               md5     397a0d665da8ba9d3b9583629f3d6421 \
                        sha1    250bba1fdb505a787c48331b6b02f54282edfc76 \
                        rmd160  4a6faaf38d5616fb7bedc1a6408de1dbb3ec360c

patchfiles              patch-configure.diff \
                        patch-ppc-tcg-target.diff

depends_build           port:texinfo
depends_lib             port:curl \
                        port:cyrus-sasl2 \
                        port:gnutls \
                        port:libidn \
                        port:libtasn1 \
                        port:ncurses \
                        port:openssl \
                        port:zlib \
                        port:libpng \
                        port:jpeg \
                        port:ossp-uuid

configure.args          --cc=${configure.cc} \
                        --host-cc=${configure.cc}
if {$build_arch != ""} {
    configure.args-append --cpu=${build_arch}
}

set target_list i386-softmmu,x86_64-softmmu,ppc-softmmu,ppc64-softmmu
pre-configure {
    configure.args-append --target-list=${target_list}
}

foreach t {arm cris m68k mips mipsel mips64 mips64el ppcemb sh4 sh4eb sparc} {
    variant target_${t} description "add ${t} target support" "append target_list \",${t}-softmmu\""
}

# Default universal variant does not work
universal_variant       no

livecheck.type regex
livecheck.url http://download.savannah.gnu.org/releases/${name}/
livecheck.regex ${name}-(\\d+(?:\\.\\d+)*)\\.tar
