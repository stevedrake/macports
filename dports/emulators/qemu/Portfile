# $Id$

PortSystem 1.0

name			qemu
version			0.9.1
revision		1
categories		emulators
platforms		darwin
maintainers		nomaintainer

description		x86 and PowerPC Emulator
long_description	QEMU is a FAST! processor emulator using dynamic \
			translation to achieve good emulation speed. It \
			can emulate a Full PC System and has basic support \
			for PowerMac Emulation.

homepage		http://bellard.org/qemu
master_sites		${homepage}
patch_sites             http://svn.kju-app.org/trunk/qemu/patches/

checksums           qemu-0.9.1-gcc4.patch \
                    md5     01604a79600db7a66f38fb6952fe39d8 \
                    sha1    bc0534ba7308a082744e6da5311ae7e487d836f9 \
                    rmd160  2ac7503b7af85e0f50375f117c473fe1604d1717 \
                    qemu-0.7.2-dyngen-check-stack-clobbers.patch \
                    md5     88fd85405713717ef7c239acfa4720f0 \
                    sha1    737938b3fd64de6365ae5e512eae7afa0e096bb0 \
                    rmd160  edc92878640fe2b858445106c1afcb6bca497430 \
                    qemu-0.9.1-gcc4-opts.patch \
                    md5     1f21d5b091d61c6afb07a040a5d948b9 \
                    sha1    b52589665308fe5d0aa9d3fd08fac97e901fbc87 \
                    rmd160  a9436f6490755bfd16d71e6f05be35389e99191f \
                    qemu-0.9.1-gcc4-hacks.patch \
                    md5     229ed1a31ccc534801d5b32db95eb789 \
                    sha1    bdfa9a93ae1b5949d6a0f575740ca7934d975814 \
                    rmd160  e5bde451d7be24a64a625ad5f7c61344f8defc50 \
                    qemu-0.9.1-enforce-16byte-stack-boundary.patch \
                    md5     545c79ef33568321b0c46e5bb7402c55 \
                    sha1    66142f667301beade29428f65bf000389697d34a \
                    rmd160  a654c446010b85711b7d56adc006ed417cd8557b \
                    qemu-0.9.0-i386-FORCE_RET.patch \
                    md5     d9b5d250c6c239516ea72464a7a6fd06 \
                    sha1    6d474d42128904e8e4775bdf4ab6571608f33ac0 \
                    rmd160  7d0b7d27a0677b725fe49ca4e715a78733d13690 \
                    qemu-0.9.1-osx-intel-port.patch \
                    md5     04124ca8f65a50945230e7060ea6b278 \
                    sha1    a285477f6508acbe7e3a711479bb4127dd68b569 \
                    rmd160  357128de1886f45a945ef0778eb40004a15fc1b7 \
                    qemu-0.9.1-osx-bugfix.patch \
                    md5     75059b80f5df5e583cf38b6eeb06e500 \
                    sha1    8e15db1d9c00986623d94162b17c7c309d0c577b \
                    rmd160  d62d3980cfc58faec14ab23ac0ea6251a71cf6e1 \
                    qemu-0.9.1-always_inline.patch \
                    md5     00ef9d131aa340ae3246ed60cbf892d3 \
                    sha1    1cf1a7e791bcb8ac145566fb26cdd30d9cdac8f0 \
                    rmd160  4cf4a36ad9faa8bbdaaaf1e9a14ffe8e5b44d3aa \
                    qemu-0.9.1.tar.gz \
                    md5     6591df8e9270eb358c881de4ebea1262 \
                    sha1    630ea20b5989f0df00128de7f7be661c573ed041 \
                    rmd160  ee7bdb55a4540df2082d4bde9ebfd2f4e6f201a5

patchfiles		qemu-0.9.1-gcc4.patch \
			qemu-0.7.2-dyngen-check-stack-clobbers.patch \
			qemu-0.9.1-gcc4-opts.patch \
			qemu-0.9.1-gcc4-hacks.patch \
			qemu-0.9.1-enforce-16byte-stack-boundary.patch \
			qemu-0.9.0-i386-FORCE_RET.patch \
			qemu-0.9.1-osx-intel-port.patch \
			qemu-0.9.1-osx-bugfix.patch \
			qemu-0.9.1-always_inline.patch \
			qemu-img-CF+IO.diff


patch.args		-p1 -f



platform macosx {
    configure.args-append --enable-coreaudio --enable-cocoa --target-list=i386-softmmu
}

# gcc3 isn't available on darwin/x86?
platform darwin 8 {
    configure.args-append --cc=/usr/bin/gcc-3.3 --host-cc=/usr/bin/gcc-3.3 \
    			  --interp-prefix=${prefix}/share/qemu-%M
}

# gcc3 isn't available on darwin/x86?
platform darwin 9 {
    configure.args-append --disable-gcc-check 
}
