# $Id $

PortSystem       1.0

name             mochiweb

set svnrev 87

version          r${svnrev} ; # project hasn't assigned a version yet
epoch            20081003

categories       erlang devel
maintainers      febeling openmaintainer
description      MochiWeb is an Erlang library for building lightweight HTTP servers.
long_description ${description} It contains a JSON library.
homepage         http://code.google.com/p/mochiweb/
platforms        darwin
use_configure    no
depends_lib      port:erlang
fetch.type       svn
svn.url          http://mochiweb.googlecode.com/svn/trunk/
svn.tag          ${svnrev}
worksrcdir       trunk
build.target     all
set libdir ${destroot}${prefix}/lib/erlang/lib/${name}
set privdir ${libdir}/priv
set ebindir ${libdir}/ebin
destroot.keepdirs ${privdir}/skel/ebin ${privdir}/skel/include ${privdir}/skel/docs ${privdir}/skel/deps
destroot {
	xinstall -d -m 0755 ${ebindir}
	eval xinstall -m 0644 [glob ${worksrcpath}/ebin/*.beam] ${ebindir}

	xinstall -d -m 0755 ${privdir}/skel/priv/www
	xinstall -d -m 0755 ${privdir}/skel/deps
	xinstall -d -m 0755 ${privdir}/skel/docs
	xinstall -d -m 0755 ${privdir}/skel/ebin
	xinstall -d -m 0755 ${privdir}/skel/include
	xinstall -d -m 0755 ${privdir}/skel/src
	xinstall -d -m 0755 ${privdir}/skel/support
	xinstall -m 0644 ${worksrcpath}/priv/skel/Makefile \
		${privdir}/skel
	eval xinstall -m 0644 [glob ${worksrcpath}/priv/skel/start*.sh] \
		${privdir}/skel
	eval xinstall -m 0644 ${worksrcpath}/priv/skel/priv/www/index.html \
		${privdir}/skel/priv/www
	eval xinstall -m 0644 [glob ${worksrcpath}/priv/skel/src/{Makefile,*.html,*.erl,*.hrl,*.app}] \
		${privdir}/skel/src
	xinstall -m 0644 ${worksrcpath}/priv/skel/support/include.mk \
		${privdir}/skel/support

	set docdir ${destroot}${prefix}/share/doc/${name}
	xinstall -d -m 0755 ${docdir}
	eval xinstall -m 0644 [glob ${worksrcpath}/doc/*.html] ${docdir}

	xinstall -m 0664 -W ${worksrcpath} \
		LICENSE README \
		${docdir}

	xinstall -m 0644 ${filespath}/README.MacPorts ${docdir} 

 	set scriptsdir ${destroot}${prefix}/share/scripts
 	xinstall -d -m 0755 ${scriptsdir}
 	eval xinstall -m 0644 [glob ${worksrcpath}/scripts/*.erl] ${scriptsdir}
}
