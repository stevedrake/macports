# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                tsung
version             1.4.1
categories          erlang devel
platforms           darwin
maintainers         nomaintainer
supported_archs     noarch

description         Load test tool for HTTP, PostgreSQL, Jabber and others.

long_description    Tsung (formerly IDX-Tsunami) is a distributed load \
                    testing tool. It is protocol-independent and can \
                    currently be used to stress HTTP, SOAP, PostgreSQL, \
                    and Jabber servers. It is distributed under the GNU \
                    General Public License version 2.

homepage            http://tsung.erlang-projects.org/
master_sites        ${homepage}dist/

checksums           rmd160  7809a32d53059f3ffb8fcf1004c0bcbc23914470 \
                    sha256  58ce67e4dea09cb7ad1b42923d67d80fb0491cac02629047d07d8d9a3abef5ab

depends_lib         port:erlang \
                    port:mochiweb \
                    port:gnuplot \
                    port:p5.12-template-toolkit \
                    port:rrdtool

build.target        all doc

post-patch {
    reinplace "s|/usr/bin/perl|${prefix}/bin/perl5.12|" \
        ${worksrcpath}/src/tsung-rrd.pl.in \
        ${worksrcpath}/src/tsung_stats.pl.in
    reinplace "s|/usr/bin/env perl|${prefix}/bin/perl5.12|" \
        ${worksrcpath}/src/log2tsung.pl.in
    reinplace "s| /usr/bin/python|${prefix}/bin/python2.7|" \
        ${worksrcpath}/src/tsung-plotter/tsung/tsung.py
}
