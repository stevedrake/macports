# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                gdash
version             20100212
categories          games
platforms           darwin
maintainers         ryandesign openmaintainer

description         Emerald Mine-like game for GTK+ and SDL

long_description    ${name} is an ${description}.

homepage            http://jutas.eet.bme.hu/~cirix/gdash/
master_sites        ${homepage}

checksums           sha1    a9318249c0d471777c4ff8260d80d1cb0a6b37f9 \
                    rmd160  17201f947ce76aa4deb01e525d41f8432c925bf5

depends_build       port:pkgconfig

depends_lib         port:gtk2 \
                    path:lib/pkgconfig/sdl.pc:libsdl \
                    port:libsdl_image \
                    port:libsdl_mixer

configure.args      --disable-glibtest \
                    --disable-gtktest \
                    --disable-sdltest

platform macosx {
    depends_build-append port:makeicns
    post-destroot {
        set app SDash
        xinstall -d ${destroot}${applications_dir}/${app}.app/Contents/MacOS \
            ${destroot}${applications_dir}/${app}.app/Contents/Resources
        xinstall -m 644 ${filespath}/Info.plist.in ${destroot}${applications_dir}/${app}.app/Contents/Info.plist
        reinplace "s|@VERSION@|${version}|g" ${destroot}${applications_dir}/${app}.app/Contents/Info.plist
        ln -s ${prefix}/bin/sdash ${destroot}${applications_dir}/${app}.app/Contents/MacOS/${app}
        system "cd ${worksrcpath} && ${prefix}/bin/makeicns -in ${worksrcpath}/docs/gdash.png -out ${destroot}${applications_dir}/${app}.app/Contents/Resources/${name}.icns"
    }
}

livecheck.type      regex
livecheck.regex     ${name}-(\[0-9.\]+)${extract.suffix}
