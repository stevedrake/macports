# $Id: Portfile,v 1.1 2004/10/07 19:40:48 mww Exp $

PortSystem 1.0

name			wop
version			2004-10-07
categories		games
platforms		darwin
maintainers		mww@opendarwin.org
description		Worms of Prey is a real-time Worms game
long_description	${description}

homepage		http://www.wormsofprey.org/
master_sites	${homepage}/download/
distfiles		${distname}.tar.bz2 \
				wopdata-2004-09-22.tar.bz2
checksums		${distname}.tar.bz2 md5 e1084d46ec06b79c7d56f79b4339a8c5 \
				wopdata-2004-09-22.tar.bz2 md5 118d25cca5819cfdf68560dcdf7828ed
use_bzip2		yes

depends_lib		bin:sdl-config:libsdl \
				lib:libSDL_net:libsdl_net \
				lib:libSDL_ttf:libsdl_ttf \
				lib:libSDL_image:libsdl_image \
				lib:libSDL_mixer:libsdl_mixer

post-patch	{
	reinplace "s|-O3|-O2|g" ${worksrcpath}/sdlwidgets/Makefile \
		${worksrcpath}/src/Makefile
}

use_configure	no

destroot	{
	xinstall -m 755 -s ${worksrcpath}/bin/wop ${destroot}${prefix}/bin
	xinstall -m 755 ${filespath}/wop ${destroot}${prefix}/bin/wop-client
	xinstall -m 755 ${filespath}/wop ${destroot}${prefix}/bin/wop-server
	reinplace "s|_PREFIX_|${prefix}|g" ${destroot}${prefix}/bin/wop-client \
		${destroot}${prefix}/bin/wop-server
	reinplace "s|_MODE_|client|g" ${destroot}${prefix}/bin/wop-client
	reinplace "s|_MODE_|server|g" ${destroot}${prefix}/bin/wop-server
	file copy ${workpath}/wopdata-2004-09-22 ${destroot}${prefix}/share/wop
}
