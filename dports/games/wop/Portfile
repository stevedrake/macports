# $Id: Portfile,v 1.2 2005/04/28 20:50:20 mww Exp $

PortSystem 1.0

name			wop
version			0.3
categories		games
platforms		darwin
maintainers		mww@opendarwin.org
description		Worms of Prey is a real-time Worms game
long_description	${description}

homepage		http://www.wormsofprey.org/
master_sites	${homepage}/download/
set data		2005-04-21
distfiles		${distname}-src.tar.bz2 \
				wopdata-${data}.tar.bz2
checksums		${distname}-src.tar.bz2 md5 39eb0a21c3b683ca4f0407bd4ed27dac \
				wopdata-${data}.tar.bz2 md5 5a1e8b94f93f097d70657d19fa5b46b1
use_bzip2		yes

depends_lib		bin:sdl-config:libsdl \
				lib:libSDL_net:libsdl_net \
				lib:libSDL_ttf:libsdl_ttf \
				lib:libSDL_image:libsdl_image \
				lib:libSDL_mixer:libsdl_mixer

worksrcdir		wop

post-patch {
	reinplace "s|-O3|-O2|g" ${worksrcpath}/sdlwidgets/Makefile \
		${worksrcpath}/src/Makefile
}

use_configure	no

destroot {
	xinstall -m 755 -s ${worksrcpath}/bin/wop ${destroot}${prefix}/bin
	xinstall -m 755 ${filespath}/wop ${destroot}${prefix}/bin/wop-client
	xinstall -m 755 ${filespath}/wop ${destroot}${prefix}/bin/wop-server
	reinplace "s|_PREFIX_|${prefix}|g" ${destroot}${prefix}/bin/wop-client \
		${destroot}${prefix}/bin/wop-server
	reinplace "s|_MODE_|client|g" ${destroot}${prefix}/bin/wop-client
	reinplace "s|_MODE_|server|g" ${destroot}${prefix}/bin/wop-server
	file copy ${workpath}/wopdata-${data} ${destroot}${prefix}/share/wop
}
