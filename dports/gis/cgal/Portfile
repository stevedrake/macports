# -*- coding: utf-8; mode: tcl; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=2:ts=2:sts=2
# $Id$

PortSystem							1.0

name										cgal
version									3.5
license									LGPL - QPL
categories							gis science
maintainers							vince
description							Computational Geometry Algorithm Library
long_description				\
												The goal of the CGAL is to provide easy access to\
												efficient and reliable geometric algorithms in the\
												form of a C++ library. CGAL is used in various areas\
												needing geometric computation, such as: computer\
												graphics, scientific visualization, computer aided\
												design and modeling, geographic information systems,\
												molecular biology, medical imaging, robotics and\
												motion planning, mesh generation, numerical methods...

platforms								darwin
homepage								http://www.cgal.org/
master_sites						http://gforge.inria.fr/frs/download.php/24197
distname								${name}-${version}

checksums								md5			c14d142780d07e3d05dea2f54dd7ae53 \
												sha1		4b0f7ce3123ebcea3aca14cab6f1baaafc80e48d \
												rmd160	6af203a21dae84e41b59e5d581eaca259e7c307e

depends_lib							port:cmake
depends_lib-append			port:boost \
												port:mpfr
												
configure.cmd						cmake .

# Configuration
# Start with no configure arguments: override defaults
configure.pre_args
configure.args
configure.cflags
configure.cxxflags

configure.args-append		-DCMAKE_INSTALL_PREFIX=${prefix}
configure.args-append		-DCMAKE_BUILD_TYPE=Release
configure.args-append		-DBUILD_SHARED_LIBS=TRUE
configure.args-append		-DCMAKE_C_COMPILER=${configure.cc}
configure.args-append		-DCMAKE_CXX_COMPILER=${configure.cxx}

variant universal {
	configure.universal_args-delete --disable-dependency-tracking
	configure.args-append	-DCGAL_CXX_FLAGS=${configure.universal_args}
	configure.args-append	-DCGAL_MODULE_LINKER_FLAGS=${configure.universal_args}
	configure.args-append	-DCGAL_SHARED_LINKER_FLAGS=${configure.universal_args}
	configure.args-append	-DCGAL_EXE_LINKER_FLAGS=${configure.universal_args}
	
	configure.universal_args
}

variant demos {
	depends_lib-append		port:qt4-mac
	
	configure.args-append	-DWITH_examples=TRUE
	configure.args-append	-DWITH_demos=TRUE
}

build.target

post-build {
	system "find ${worksrcpath} -name '*.dylib' -exec install_name_tool \
					-change ${worksrcpath}/lib/libCGAL.4.dylib \
									${prefix}/lib/libCGAL.4.dylib {} \\;"
}
