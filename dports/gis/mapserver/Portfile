# $Id$

PortSystem 1.0

name             mapserver
version          5.2.0
maintainers      nomaintainer
categories       gis
platforms        darwin

description      mapserver
long_description MapServer is an Open Source development environment for \
                 building spatially-enabled internet applications.

homepage         http://mapserver.gis.umn.edu/
master_sites     http://download.osgeo.org/mapserver

checksums        md5 6c0f210eb6510f0a43b6d5b09df8bb83

depends_lib      port:gd2 \
                 port:geos

patchfiles       patch-Makefile.in.diff

configure.args   --with-gd=${prefix}
variant gdalogr description {Add raster formats from gdal (Geospatial Data Abstraction Library) and vector formats from OGR Simple Features Library} {
    depends_lib-append      port:gdal
    configure.args-append   --with-gdal=${prefix}/bin/gdal-config \
                            --with-ogr=${prefix}/bin/gdal-config
}

variant proj description {Add projection support} {
    depends_lib-append      port:proj
    configure.args-append   --with-proj=${prefix}
}

#variant wms requires proj description {Enable Web Map Service} {
    # --with-wms is enabled by default
#}

set cgi_path "/Library/WebServer/CGI-Executables/"

# apache macport interop
if {[ file exists ${prefix}/sbin/httpd]} {
    set cgi_path "${prefix}/www/cgi-bin/"
}

destroot.target install-force
post-destroot {
    file mkdir ${destroot}${cgi_path}
    xinstall -m 755 ${worksrcpath}/mapserv ${destroot}${cgi_path}
}
