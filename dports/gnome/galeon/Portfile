# $Id: Portfile,v 1.6 2005/01/11 16:26:17 olegb Exp $
PortSystem 1.0
name		galeon
version		1.3.18
description	A GNOME browser.
long_description        Galeon is a GNOME Web browser based on gecko (the \
			mozilla rendering engine). It's fast, it has a \
			light interface, and it is fully standards-compliant.
maintainers	olegb@opendarwin.org
categories	gnome
platforms	darwin 
homepage	http://galeon.sourceforge.net
master_sites	sourceforge
use_bzip2	yes
checksums	md5 d04164ebf26c65fdfd23fc1278edfce1
patchfiles	patch_mozilla-embed.cpp patch-MozillaPrivate.cpp
depends_lib     bin:mozilla:mozilla bin:gnome-session:gnome-session lib:libiconv.2:libiconv
configure.env   CPPFLAGS="-L${prefix}/lib -I${prefix}/include" \
                CFLAGS="-no-cpp-precomp -flat_namespace -undefined suppress"
configure.args	--enable-nautilus-view=no --mandir=${prefix}/share/man \
		--with-gconf-source="xml::${destroot}/${prefix}/etc/gconf/gconf.xml.defaults"
pre-destroot {
	# mkdir the directory for teh gconf'in
	file mkdir -f ${destroot}${prefix}/etc/gconf/gconf.xml.defaults/
}

post-destroot {
	# make a da script happen
	file copy ${destroot}${prefix}/bin/galeon ${destroot}${prefix}/bin/galeon-bin
	file copy -force ${worksrcpath}/../../files/galeon ${destroot}${prefix}/bin/
	# damn gconf
	file delete ${destroot}${prefix}/etc/gconf/gconf.xml.defaults/schemas/apps/%gconf.xml
	file delete ${destroot}${prefix}/etc/gconf/gconf.xml.defaults/schemas/%gconf.xml
	file delete ${destroot}${prefix}/etc/gconf/gconf.xml.defaults/apps/%gconf.xml
	# use da ${prefix} Luke ...
        reinplace "s|/opt/local|${prefix}|g" ${destroot}/${prefix}/bin/galeon
}
