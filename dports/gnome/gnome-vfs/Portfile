# $Id: Portfile,v 1.23 2005/03/13 08:09:24 olegb Exp $
PortSystem 1.0
name		gnome-vfs
version		2.10.0
description	This is the GNOME Virtual File System.
long_description        This is the GNOME Virtual File System. \
			GNOME VFS is currently used as one of the \
			foundations of the Nautilus file manager.
maintainers	gnome-darwinports@opendarwin.org
categories	gnome
platforms	darwin 
homepage	http://www.gnome.org/
master_sites    gnome:sources/gnome-vfs/2.10/
checksums	md5 bb9df65d6a77414bbde9f1bc429c9d97
depends_lib	lib:gnome-mime-magic:gnome-mime-data lib:libiconv.2:libiconv
patchfiles	patch_gnome-vfs-cdrom.c patch_gnome-vfs-utils.c \
		patch_file-metod.c patch_bzip2-method.c patch_pty-open.c
use_bzip2 	yes
configure.args  --mandir=${prefix}/share/man --enable-ipv6 --disable-static 
configure.env   CPPFLAGS="-L${prefix}/lib -I${prefix}/include"

post-patch {
	reinplace "s|data_dirs = \"/usr|data_dirs = \"${prefix}/share:/usr|g" \
		${worksrcpath}/libgnomevfs/xdgmime.c \
		${worksrcpath}/libgnomevfs/gnome-vfs-mime-info.c 
}

pre-build {
	reinplace "s|-lkrb5support||g" \
		${worksrcpath}/Makefile ${worksrcpath}/daemon/Makefile \
		${worksrcpath}/devel-docs/Makefile ${worksrcpath}/doc/Makefile \
		${worksrcpath}/devel-docs/gnome-vfs-tutorial/Makefile \
		${worksrcpath}/imported/Makefile ${worksrcpath}/imported/neon/Makefile \
		${worksrcpath}/libgnomevfs/Makefile ${worksrcpath}/modules/Makefile \
		${worksrcpath}/monikers/Makefile ${worksrcpath}/programs/Makefile \
		${worksrcpath}/schemas/Makefile 
}

platform darwin 7 {
                configure.env-append LDFLAGS="-lresolv" 
}
