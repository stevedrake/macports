--- modules/file-method-acl.c~	2006-08-05 11:45:02.000000000 -0400
+++ modules/file-method-acl.c	2006-08-05 11:58:27.000000000 -0400
@@ -34,6 +34,7 @@
 #include <unistd.h>
 #include <stdlib.h>
 #include <sys/types.h>
+#include <sys/time.h>
 #include <sys/resource.h>
 
 #ifdef HAVE_PWD_H
@@ -46,10 +47,12 @@
 
 #ifdef HAVE_POSIX_ACL
 # include <acl/libacl.h>
+#define HAVE_ACL
 #endif
 
 #ifdef HAVE_SOLARIS_ACL
 # include <sys/acl.h>
+#define HAVE_ACL
 #endif
 
 #include "file-method-acl.h"
@@ -59,6 +62,7 @@
 #define CMD_PERM_EXECUTE        1
 #define CMD_PERM_COND_EXECUTE   8
 
+#ifdef HAVE_ACL
 
 static char *
 uid_to_string (uid_t uid) 
@@ -717,6 +721,7 @@
 	return GNOME_VFS_ERROR_GENERIC;
 }
 
+#endif /* HAVE_ACL */
 
 GnomeVFSResult file_get_acl (const char       *path,
                              GnomeVFSFileInfo *info,
