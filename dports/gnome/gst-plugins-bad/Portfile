# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name		        gst-plugins-bad
version		        0.10.18
description         This is gst-plugins, a set of plug-ins for GStreamer.
long_description    ${description}
license             GPL LGPL
maintainers         rmsfisher openmaintainer
categories          gnome
platforms           darwin
homepage            http://www.gnome.org/
master_sites        http://gstreamer.freedesktop.org/src/${name}/
use_bzip2           yes

checksums           md5     84838893b447e774d401a698ff812b32 \
                    sha1    33853ed4f3be8d80c42a2a8dcce7052a08c1d64f \
                    rmd160  0a7bfd2b90dc863798f5a254248a1b087dcf8f5a

depends_lib port:gst-plugins-base \
            port:XviD \
            port:dirac \
            port:exempi \
            port:faac \
            port:faad2 \
            port:jack \
            port:jasper \
            port:libdca \
            port:libexif \
            port:libglade2 \
            port:libmms \
            port:libmodplug \
            port:libmpcdec \
            port:soundtouch \
            port:neon \
            port:schroedinger

#
# could depend on tons for multimedia stuff +variants
# the following ports are available but don't configure
# and/or build correctly
#
# port:mjpegtools (mpeg2enc mplex build fails)
# port:libmusicbrainz (configure wants pkg-config libmusicbrainz, we have libmusicbrainz3)
# path:lib/pkgconfig/sdl.pc:libsdl (builds but sdlvideosink is broken)
# port:slv2 (builds but plugin fails to load))
# port:swfdec (configure wants pkg-config swfdec-0.3, we have swfdec-0.8)
#

configure.compiler          gcc-4.0
configure.args              --disable-dc1394 \
                            --disable-quicktime \
                            --disable-lv2 \
                            --disable-mpeg2enc \
                            --disable-mplex \
                            --disable-musicbrainz \
                            --disable-sdl \
                            --disable-swfdec \
                            --enable-experimental \
                            --enable-static
configure.cppflags-append   "-L${prefix}/lib"
configure.cflags-append     "-no-cpp-precomp -funroll-loops -fstrict-aliasing"
configure.env-append        "HAVE_CXX=yes"

# Disable OS X Video as a workaround
# http://trac.macports.org/ticket/21996
configure.args-append       --enable-osx_video=no

patchfiles  modplug.patch

post-patch {
    reinplace "s|-flat_namespace -undefined suppress|-undefined define_a_way|g" \
        ${worksrcpath}/configure
    reinplace "s|libSoundTouch|soundtouch-1.0|g" \
        ${worksrcpath}/configure
}

universal_variant   no
variant dc1394 description {Enable Firewire digital camera support using libdc1394} {
        configure.args-delete --disable-dc1394
        depends_lib-append port:libdc1394
}
variant no_x11 {
        configure.args-append --disable-examples
}

livecheck.type  regex
livecheck.url   ${master_sites}
livecheck.regex "${name}-(\\d+(?:\\.\\d+)*)${extract.suffix}"
