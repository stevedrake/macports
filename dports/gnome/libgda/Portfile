# $Id: Portfile,v 1.9 2005/05/24 19:27:35 olegb Exp $

PortSystem 1.0
name		libgda
version		1.2.1
description	GDA provides uniform access to diffent kinds of data sources.
long_description	GNU Data Access (GDA) is an attempt to provide \
			uniform access to different kinds of data sources \
			(databases, information servers, mail spools, etc).
maintainers	gnome-darwinports@opendarwin.org
categories	gnome 
platforms	darwin 
homepage	http://www.gnome-db.org/
master_sites    gnome:sources/libgda/1.2/
checksums	md5 513a3b7adb66fa5641bae5394f60c017
use_bzip2	yes
depends_lib	port:libxslt lib:libglib-2:glib2 port:p5-xml-parser \
		lib:libdb-4:db4 lib:libmysqlclient:mysql
configure.env   CPPFLAGS="-L${prefix}/lib -I${prefix}/include -I${prefix}/include/db4" \
                CFLAGS="-no-cpp-precomp -flat_namespace -undefined suppress"  \
		LDFLAGS="-L${prefix}/lib"
configure.args  --mandir=${prefix}/share/man 

#patchfiles	patch-configure

post-configure {
	reinplace "s|-ldb|-ldb-4|g" \
		${worksrcpath}/Makefile ${worksrcpath}/data/Makefile \
		${worksrcpath}/doc/C/Makefile ${worksrcpath}/doc/Makefile \
		${worksrcpath}/libgda/Makefile ${worksrcpath}/libsql/Makefile \
		${worksrcpath}/providers/Makefile \
		${worksrcpath}/providers/bdb/Makefile \
		${worksrcpath}/providers/firebird/Makefile \
		${worksrcpath}/providers/freetds/Makefile \
		${worksrcpath}/providers/ibmdb2/Makefile \
		${worksrcpath}/providers/ldap/Makefile \
		${worksrcpath}/providers/mdb/Makefile \
		${worksrcpath}/providers/mdb/Makefile \
		${worksrcpath}/providers/msql/Makefile \
		${worksrcpath}/providers/mysql/Makefile \
		${worksrcpath}/providers/odbc/Makefile \
		${worksrcpath}/providers/oracle/Makefile \
		${worksrcpath}/providers/postgres/Makefile \
		${worksrcpath}/providers/sqlite/Makefile \
		${worksrcpath}/providers/xbase/Makefile \
		${worksrcpath}/providers/sybase/Makefile \
		${worksrcpath}/providers/xml/Makefile \
		${worksrcpath}/report/Makefile \
		${worksrcpath}/report/libgda-report/Makefile \
		${worksrcpath}/report/testing/Makefile \
		${worksrcpath}/testing/Makefile \
		${worksrcpath}/tools/Makefile
}

variant mysql4 {
	depends_lib-append	path:${prefix}/lib/mysql/libmysqlclient_r.12.dylib:mysql4
	configure.args-append	--with-mysql=${prefix}
}

variant postgresql {
	depends_lib-append	lib:libpq:postgresql
	configure.args-append	--with-postgres=${prefix}
}

variant sqlite {
	depends_lib-append	lib:libsqlite:sqlite
	configure.args-append	--with-sqlite=${prefix}
}

