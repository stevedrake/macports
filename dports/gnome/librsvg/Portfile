# $Id: Portfile,v 1.14 2006/02/05 13:43:07 rhwood Exp $
PortSystem 1.0
name		librsvg
version		2.12.7
revision		1
description	Gnome implementation of rsvg.
long_description       	${description}
maintainers	gnome-darwinports@opendarwin.org
categories	gnome
platforms	darwin 
homepage	http://librsvg.sourceforge.net/
master_sites    gnome:sources/${name}/2.12/
checksums	sha1 2dbb387bca326d44c24348bd48b39b12bd3ab365

depends_lib \
	lib:libXft.2:Xft2 lib:libatk-1.0:atk bin:bunzip2:bzip2 lib:libexpat:expat \
	lib:libfontconfig:fontconfig lib:libfreetype.6.3.7:freetype \
	bin:gconftool-2:gconf lib:libgettextlib:gettext lib:libglib-2.0:glib2 \
	lib:libgnomevfs-2:gnome-vfs lib:libgtk-x11-2.0:gtk2 lib:libjpeg.62:jpeg \
	lib:libz.1.2.3:zlib lib:libXrender.1:xrender lib:libtiff:tiff \
	lib:libpopt:popt bin:perl:perl5.8 lib:libpangoft2-1.0:pango \
	bin:orbit-idl-2:orbit2 bin:openssl:openssl port:libxml2 lib:libpng12:libpng \
	lib:libiconv.2.2.0:libiconv lib:libgsf-1.1:libgsf lib:libbonobo-2:libbonobo \
	lib:libgnomecanvas-2:libgnomecanvas lib:libart_lgpl_2:libart_lgpl \
	lib:libcroco-0.6:libcroco \
	lib:libmetacity-private:metacity 
	# Metacity is only to satify the gnome-dep chain, will be removed soon.

use_bzip2 	yes
configure.args  --mandir=${prefix}/share/man --enable-pixbuf-loader \
		--with-svgz 
configure.env   CPPFLAGS="-L${prefix}/lib -I${prefix}/include" \
		CFLAGS="-no-cpp-precomp -flat_namespace -undefined suppress"
post-install {
	set fl [open "| grep -c svg ${prefix}/etc/gtk-2.0/gdk-pixbuf.loaders" ]
	set data [read $fl]
	close $fl
	if {$data == 0} {
		ui_msg "Updating ${prefix}/etc/gtk-2.0/gdk-pixbuf.loaders"
		system "gdk-pixbuf-query-loaders > ${prefix}/etc/gtk-2.0/gdk-pixbuf.loaders"
	}
}
