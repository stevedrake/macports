# $Id$

PortSystem 1.0
name                liferea
version             1.2.22
revision            1
description         A feed aggregator for GTK+/GNOME.
long_description    Liferea is an aggregator for online news feeds. \
                    It supports the RSS/RDF, CDF, Atom, OCS and OPML \
                    formats and enclosures (podcasting). It also has \
                    filtering mechanisms.
maintainers         vincent-opdarw@vinc17.org
categories          gnome net
platforms           darwin
homepage            http://liferea.sourceforge.net/
master_sites        sourceforge
checksums           md5 e76a449651e0b019101207f2f6b0c8be \
                    sha1 14c6089029f06d9ceb9e4280511d635a24e6c26d \
                    rmd160 58730c99691062b42fa45a8b0f554e4a53538ca3
depends_lib         port:gtk2 port:libgtkhtml port:gconf port:libxslt

configure.args      --disable-xulrunner \
                    --disable-gecko \
                    --disable-lua

variant lua {
    depends_lib-append      port:lua
    configure.args-delete   --disable-lua
    configure.args-append   --enable-lua
}

patchfiles          patch-itemview.c
patch.pre_args      -p1

post-patch {
    reinplace "s|#include <malloc.h>||g" \
      "${worksrcpath}/src/scripting/liferea_wrap.h"
}

pre-destroot {
    file mkdir "${destroot}${prefix}/share/doc/${name}"
    xinstall -m 644 -v -W ${worksrcpath} AUTHORS ChangeLog README \
      "${destroot}${prefix}/share/doc/${name}"
}

post-activate {
    ui_msg "The date/time format has changed. If you want to override the"
    ui_msg "new one, you need to run"
    ui_msg "  gconftool-2 -s -t string /apps/liferea/date-format <format>"
    ui_msg "where <format> is the format in strftime syntax."
}

livecheck.check     regex
livecheck.url       ${homepage}
livecheck.regex     >(\[0-9.\]+)<
