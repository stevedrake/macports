# $Id: Portfile,v 1.19 2006/08/25 09:10:56 rhwood Exp $
PortSystem 1.0
name		nautilus
version		2.14.3
description	The GNOME filemanager
long_description       	Nautilus is the official file manager for the \
			GNOME desktop. It is designed to be primarly a file manager, \
			but there are support for web and file viewing too.  
maintainers	macports-dev@lists.macosforge.org rhwood@macports.org
categories	gnome
platforms	darwin 
homepage	http://www.gnome.org/
master_sites    gnome:sources/nautilus/2.14/
checksums	md5 e82df2a1cb11719d054959539b74b3c7 \
			sha1 3a85991c198364e9d3b6615cec25221b66f91f2e \
			rmd160 474f076d06d4879af4e7bae9b0698e3c8dc38d69

depends_lib	lib:libeel-2:eel lib:libexif.12:libexif port:librsvg
depends_build	bin:update-mime-database:shared-mime-info
use_bzip2 	yes

configure.args  --mandir=${prefix}/share/man \
		--disable-update-mimedb
configure.env   CPPFLAGS="-L${prefix}/lib -I${prefix}/include" \

post-extract {
	reinplace "s|-no-undefined||g"  \
		${worksrcpath}/libnautilus-private/Makefile.in \
		${worksrcpath}/libnautilus-extension/Makefile.in
}

#pre-build {
#	reinplace "s|-lesd||g" ${worksrcpath}/libnautilus-extension/Makefile
#	reinplace "s|-lesd||g" ${worksrcpath}/cut-n-paste-code/Makefile
#	reinplace "s|-lesd||g" ${worksrcpath}/cut-n-paste-code/widgets/gimphwrapbox/Makefile
#	reinplace "s|-lesd||g" ${worksrcpath}/cut-n-paste-code/libegg/Makefile
#	reinplace "s|-lesd||g" ${worksrcpath}/cut-n-paste-code/gsequence/Makefile
#	reinplace "s|-lesd||g" ${worksrcpath}/libbackground/Makefile
#	reinplace "s|-lesd||g" ${worksrcpath}/src/file-manager/Makefile
#	reinplace "s|-lesd||g" ${worksrcpath}/libnautilus-private/Makefile
#}

post-activate {
	system "update-mime-database ${prefix}/share/mime"
}

platform darwin 8 {
	pre-configure {
		reinplace "s|-flat_namespace -undefined suppress||g" \
			${worksrcpath}/configure
	}
}
