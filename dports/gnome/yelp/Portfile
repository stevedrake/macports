# $Id$

PortSystem 1.0

name		yelp
version		2.22.0
description	Help browser for GNOME.
long_description        Help browser for GNOME 2.0 which supports docbook documents, \
			info and man.
maintainers	nomaintainer
categories	gnome
platforms	darwin
homepage	http://www.gnome.org/
master_sites    gnome:sources/yelp/2.22/
checksums	md5 941e67796bbc332c1db3d63771ae2590
depends_lib	port:startup-notification \
		port:libgtkhtml \
		port:gnome-doc-utils \
		port:libxslt \
		port:rarian \
		port:gconf \
		port:gnome-vfs \
		port:libbonobo \
		port:libgnome \
		port:libgnomeui \
		port:tiff \
		port:firefox-x11

use_bzip2 	yes

variant debug description {Builds yelp for debugging} {
        configure.cflags-append -O0 -g
        configure.cxxflags-append -O0 -g
	configure.args-append --enable-debug
}

post-destroot {
        # In order to call gecko, yelp must be installed in the same directory as FireFox.
        # Move it and put a symlink in the bin directory
        if { [catch {set ff [registry_active "firefox-x11"]} result]} {
                ui_err "FireFox is not active: $result"
        } else {
                set ffver [lindex $ff 0 1]
                xinstall -d ${destroot}${prefix}/lib/firefox-${ffver}
                move ${destroot}${prefix}/bin/yelp ${destroot}${prefix}/lib/firefox-${ffver}
                ln -s ${prefix}/lib/firefox-${ffver}/yelp ${destroot}${prefix}/bin
        }
}

configure.cppflags-append "-L${prefix}/lib"
configure.cflags-append "-no-cpp-precomp -flat_namespace -undefined suppress"
