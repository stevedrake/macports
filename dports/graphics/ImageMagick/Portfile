# $Id$

PortSystem			1.0
name				ImageMagick
version				6.3.2-4
categories			graphics devel 
maintainers			ryandesign@macports.org openmaintainer@macports.org
description			Tools and libraries to manipulate images in many formats
long_description \
	A robust collection of tools and libraries to read, write, and \
	manipulate an image in many image formats (over 87 major formats) \
	including popular formats like TIFF, JPEG, PNG, PDF, PhotoCD, and \
	GIF.  With ImageMagick you can create images dynamically, making it \
	suitable for Web applications. You can also resize, rotate, sharpen, \
	color reduce, or add special effects to an image or image sequence \
	and save your completed work in the same or differing image format.  \
	Image processing operations are available from the command line, as \
	well as through C, C++, Perl, or Java programming interfaces.

platforms	darwin

homepage	http://www.imagemagick.org/
master_sites	http://imagemagick.linux-mirror.org/download/ \
			http://ftp.surfnet.nl/pub/ImageMagick/ \
			sourceforge:imagemagick \
			ftp://ftp.imagemagick.net/pub/${name}/ \
			ftp://ftp.fifi.org/pub/ImageMagick/ \
			ftp://ftp.nluug.nl/pub/${name}/
use_bzip2	yes
checksums	md5 e82a7df9704829e344747fe21df53b22 \
			sha1 d56863a41a33319d52ae571a20ea50a7ea70408a \
			rmd160 79f425d666619c446a60807ea6cd284ac71498f9

worksrcdir	${name}-6.3.2

depends_lib	lib:libX11.6:XFree86 \
			port:bzip2 port:jpeg port:libpng port:tiff \
			port:zlib port:freetype port:libxml2

configure.env	CPPFLAGS="-I${prefix}/include" LDFLAGS="-L${prefix}/lib"
configure.args	--enable-shared --disable-static --disable-ltdl-install \
			--with-dps --with-ttf --with-bzlib --with-jpeg \
			--with-png --with-tiff --with-zlib --with-modules \
			--with-xml --with-x \
			--without-perl --without-fpx \
			--without-gslib --without-jbig --without-jp2 \
			--without-lcms --without-wmf --without-gvc \
			--mandir=${prefix}/share/man

test.run	yes
test.target	check

# Using gplghostscript instead of ghostscript as the former provides
# libgs and the latter appears not to at this time
variant gs {        
	depends_lib-append	port:gplghostscript
	configure.args-delete	--without-gslib
	configure.args-append	--with-gslib 
}

variant lcms {
	depends_lib-append	port:lcms
	configure.args-delete	--without-lcms
	configure.args-append	--with-lcms
}

variant wmf {
	depends_lib-append	port:libwmf
	configure.args-delete	--without-wmf
	configure.args-append	--with-wmf
}

variant mpeg {
	depends_lib-append	port:mpeg2vidcodec
}

variant jbig {
	depends_lib-append	port:jbigkit
	configure.args-delete	--without-jbig
	configure.args-append	--with-jbig
}

variant jpeg2 {
	depends_lib-append	port:jasper
	configure.args-delete	--without-jp2
	configure.args-append	--with-jp2
}

variant graphviz {
	depends_lib-append	port:graphviz
	configure.args-delete	--without-gvc
	configure.args-append	--with-gvc
}

variant nox11 {
	depends_lib-delete	lib:libX11.6:XFree86
	configure.args-delete	--with-x
	configure.args-append	--without-x
}

variant no-plus-plus {
	configure.args-append	--without-magick-plus-plus
}

platform darwin 6 {
	depends_lib-append	lib:libdl:dlcompat lib:libltdl:libtool
}

platform darwin 8 {
	configure.env-append CC=/usr/bin/gcc-4.0 CPP=/usr/bin/cpp-4.0 CXX=/usr/bin/g++-4.0
}
