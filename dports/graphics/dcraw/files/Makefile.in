CC = @CC@
CFLAGS = @CFLAGS@
CPPFLAGS = @CPPFLAGS@
LDFLAGS = @LDFLAGS@
PREFIX = @PREFIX@

BUILD_DIR = build

all: $(BUILD_DIR)/dcraw

$(BUILD_DIR)/dcraw: $(BUILD_DIR)
	$(CC) -o $(BUILD_DIR)/dcraw $(CFLAGS) dcraw.c -ljpeg -llcms -lintl -liconv $(CPPFLAGS) $(LDFLAGS) -DLOCALEDIR=\"$(PREFIX)/share/locale/\"

$(BUILD_DIR):
	mkdir -p $(BUILD_DIR)

.PHONY: install
install:
	install -s -m 755 $(BUILD_DIR)/dcraw $(DESTDIR)$(PREFIX)/bin
