# $Id$

PortSystem          1.0

name                fontconfig
version             2.4.2
revision            1
categories          graphics
maintainers         ryandesign openmaintainer
homepage            http://fontconfig.org/
platforms           darwin

description \
	An XML-based font configuration API for X Windows

long_description \
	Fontconfig is a library for configuring and customizing font access.

master_sites \
	sourceforge:gimp-win \
	http://www.ryandesign.com/tmp/ \
	${homepage}release/ \
	ftp://ftp.sunfreeware.com/pub/freeware/SOURCES/

checksums \
	md5 f035852f521b54677f2b5c9e2f6d54a4 \
	sha1 cd5e30625680a0435563b586275156eaf8d0d34a \
	rmd160 c953020a5193500080c9eceef47b76e61c41b188

depends_lib \
    port:libiconv \
	port:expat \
	port:freetype

set add_fonts   ${x11prefix}/lib/X11/fonts
set docdir      ${prefix}/share/doc/${name}-${version}

configure.args  --docdir=${prefix}/share/doc/${name}-${version} \
                --disable-docs

# We put this into a pre-configure so it can be evaluated _after_ variants selection.
pre-configure {
    configure.args-append   --with-add-fonts=[join ${add_fonts} ,]
}

post-destroot {
    xinstall -d ${destroot}${docdir}
    xinstall -m 0644 -W ${worksrcpath} AUTHORS COPYING ChangeLog NEWS README \
        ${destroot}${docdir}
}

post-activate {
    system "${prefix}/bin/fc-cache -fv /usr/share/fonts [join ${add_fonts}]"
}

variant doc description {Install extra documentation} {
    configure.args-delete   --disable-docs
}

variant vera {
	depends_build-append \
		path:${prefix}/share/fonts/Vera.ttf:bitstream-vera

	post-destroot {
		xinstall -m 644 ${prefix}/share/doc/bitstream-vera/local.conf \
			${destroot}/${prefix}/etc/fonts
	}
}

platform macosx {
    lappend add_fonts   /Library/Fonts \
                        /Network/Library/Fonts \
                        /System/Library/Fonts \
                        ${prefix}/share/fonts
}

livecheck.check     regex
livecheck.url       ${homepage}release/?C=M&O=D
livecheck.regex     ${name}-(\\d+(?:\\.\\d+)*)

