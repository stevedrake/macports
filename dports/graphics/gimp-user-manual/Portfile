# $Id$

PortSystem 1.0
name            gimp-user-manual
version         0.13
categories      graphics
maintainers     devans
description     A multilingual user manual for the Gimp (broken).
long_description \
	The GIMP User Manual is a newly written User Manual for the GIMP. \
	It is written for the GIMP Help Browser, but can produce the Help \
	pages or other mediums as well.
homepage        http://docs.gimp.org/
platforms       darwin

# FIXME : build is done in destroot phase because
# everything was getting rebuilt during destroot anyway

build {}

default_variants    +fetch

variant fetch {
    distname        gimp-help-html-${version}
    master_sites    macports
    use_bzip2       yes
    checksums       md5 ad1e532a9a912951162a439097907ed8
    
    extract         {}
    use_configure   no
    destroot {
        system "cd ${destroot}${prefix}/share &&
            tar jvxf ${distpath}/${distfiles}"
    }
}

variant build conflicts fetch {
    distname        gimp-help-2-${version}
    master_sites    ftp://ftp.gimp.org/pub/gimp/help/
    checksums       md5 a0d3ab0e503cacaaaa031958bfad43e5

    depends_build \
        port:coreutils \
        port:docbook-xsl \
        port:docbook-xml-4.3 \
        port:libxslt \
        port:pkgconfig \
        path:${prefix}/lib/pkgconfig/gimp-2.0.pc:gimp2

    post-patch {
        reinplace "s|cp|gcp|g" ${worksrcpath}/Makefile.in
    }

    configure.args  --enable-build
    destroot.env    XML_CATALOG_FILES=${prefix}/etc/xml/catalog
}

variant without_gimp requires build {
    configure.args-append   --without-gimp
    depends_build-delete    path:${prefix}/lib/pkgconfig/gimp-2.0.pc:gimp2
}

variant cs requires build {
    configure.env-append ALL_LINGUAS=cs
}

variant de requires build {
    configure.env-append ALL_LINGUAS=de
}

variant en requires build {
    configure.env-append ALL_LINGUAS=en
}

variant es requires build {
    configure.env-append ALL_LINGUAS=es
}

variant fr requires build {
    configure.env-append ALL_LINGUAS=fr
}

variant hr requires build {
    configure.env-append ALL_LINGUAS=hr
}

variant it requires build {
    configure.env-append ALL_LINGUAS=it
}

variant ko requires build {
    configure.env-append ALL_LINGUAS=ko
}

variant nl requires build {
    configure.env-append ALL_LINGUAS=nl
}

variant no requires build {
    configure.env-append ALL_LINGUAS=no
}

variant ru requires build {
    configure.env-append ALL_LINGUAS=ru
}

variant sv requires build {
    configure.env-append ALL_LINGUAS=sv
}

variant zh_CN requires build {
    configure.env-append ALL_LINGUAS=zh_CN
}
