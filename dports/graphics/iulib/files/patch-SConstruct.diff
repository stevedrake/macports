--- SConstruct.orig	2011-05-17 17:29:32.000000000 -0700
+++ SConstruct	2011-05-17 20:11:54.000000000 -0700
@@ -48,6 +48,12 @@
 # opts.Add(BoolVariable('style', 'Check style', "no"))
 
 env = Environment(options=opts, CXXFLAGS=["${opt}","${warn}"])
+env.Append( CPPPATH=["@@PREFIX@@/include"] )
+env.Append( LIBPATH=["@@PREFIX@@/lib/"] )
+env["CFLAGS"] = os.getenv("CFLAGS")
+env["CXXFLAGS"] = os.getenv("CXXFLAGS")
+env["LINKFLAGS"] = os.getenv("LINKFLAGS")
+
 Help(opts.GenerateHelpText(env))
 
 conf = Configure(env)
@@ -146,7 +152,8 @@
 
 if env["test"]:
     for file in glob.glob("*/test-*.cc") + glob.glob("*/*/test-*.cc"):
-        if not file.startswith('vidio'):
+        #Jason C - I exclude test-pbmpng becuase it depends on convert from ImageMagick
+        if not (file.startswith('vidio') or file.startswith('imgio/tests/test-pbmpng')):
             progs.Program(file[:-3],file)
             progs.Test(file[:-3])
             progs.Alias("test",file[:-3]+".passed")
