# $Id$

PortSystem 1.0
name		libgeotiff
version		1.2.4
categories	graphics
maintainers	nomaintainer
description	Library and tools for dealing with GeoTIFF
long_description This software provides support for the Tag Image File \
		 Format (TIFF) Geo extensions.
homepage	http://www.remotesensing.org/geotiff/
platforms	darwin
master_sites	ftp://ftp.remotesensing.org/pub/geotiff/libgeotiff/
checksums	md5     62cd4a515d1f3ba7b41cb4ed9061aa76 \
		sha1    044060c38a1eba53e9955b2b9cf541cf461d7e7e \
		rmd160  e1b434848db2c3cb66f8bb7f24aa2a80989b8c9b

depends_lib	port:tiff port:proj port:zlib

configure.env	MANPATH=${prefix}/share/man

configure.args	--with-zip=${prefix} --with-jpeg=${prefix} \
                --with-proj=${prefix} --enable-incode-epsg

destroot.destdir
build.env	DESTDIR=${destroot}
destroot.env	DESTDIR=${destroot}

post-destroot {
    move ${destroot}${prefix}/lib/libgeotiff.dylib.${version} ${destroot}${prefix}/lib/libgeotiff.${version}.dylib
    system "install_name_tool -id ${prefix}/lib/libgeotiff.${version}.dylib ${destroot}${prefix}/lib/libgeotiff.${version}.dylib"
    foreach suf ".[join [lrange [split ${version} .] 0 1] .] .[lindex [split ${version} .] 0] {}" {
        delete ${destroot}${prefix}/lib/libgeotiff.dylib${suf}
        ln -s libgeotiff.${version}.dylib ${destroot}${prefix}/lib/libgeotiff${suf}.dylib
    }
}
