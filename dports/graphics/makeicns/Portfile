# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                makeicns
version             1.4
revision            2
categories          graphics
maintainers         techno.ms:mk-macports pixilla.com:brad
platforms           darwin
supported_archs     ppc i386 x86_64
configure.universal_archs   ppc i386
license             MIT

description         This program lets you convert all kinds of images to Apple's icns format on the command line.
long_description    ${description}

homepage            http://bitbucket.org/mkae/makeicns
master_sites        ${homepage}/get

use_bzip2           yes

distname            ${version}
worksrcdir          ${name}

checksums           md5     37cc153f69b60625a03c322bd3bafef8 \
                    sha1    592c2c17fb3ad6f7b480878a2c5764953b69c125 \
                    rmd160  ccdfb493b63f19d508d3ef18aaad67b12c9eda70

patchfiles          patch-Makefile.diff

use_configure       no

variant universal {}
if {[variant_isset universal]} {
    set archflags ${configure.universal_cflags}
} else {
    set archflags ${configure.cc_archflags}
}
if {${configure.sdkroot} != ""} {
    configure.ldflags-append "-isysroot ${configure.sdkroot}"
}

build.env           CC=${configure.cc} \
                    CXX=${configure.cxx} \
                    CFLAGS="${configure.cflags} ${archflags}" \
                    CXXFLAGS="${configure.cxxflags} ${archflags}" \
                    LDFLAGS="[join ${configure.ldflags}] ${archflags}"

destroot {
    xinstall ${worksrcpath}/${name} ${destroot}${prefix}/bin/${name}
}
