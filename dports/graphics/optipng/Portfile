# $Id: Portfile,v 1.3 2006/05/06 19:39:31 vinc17 Exp $

PortSystem			1.0
name				optipng
version				0.5.1
categories			graphics
maintainers			blb@opendarwin.org vincent-opdarw@vinc17.org
description			PNG file optimizer
long_description \
	OptiPNG is a PNG optimizer that recompresses the image files to a \
	smaller size, without losing any information. \
	The idea has been inspired from pngcrush \
	(http://pmt.sourceforge.net/pngcrush), and is explained in detail in \
	the PNG-Tech article 'A guide to PNG optimization'.  The implementation \
	is carried forward in OptiPNG, which offers a faster execution per \
	trial, and a wider search space.

platforms			darwin

homepage			http://optipng.sourceforge.net/
master_sites		sourceforge

checksums			md5 309239fb5f4dfa751f3b893bef58e316 \
					sha1 9e1300aff4579d72889af8997a0eda215e2fb5ef \
					rmd160 a0ff76be9515670fd9d16ebb43f86f6a905b8862

# Doesn't depend on libpng or zlib since it uses its own, modified versions

worksrcdir			${name}-${version}/src

use_configure		no

build.cmd			make -f scripts/gcc.mak
build.target		""
build.args			CFLAGS="-D__unix__ -O2 -W -Wall"

destroot {
	xinstall -m 755 -d ${destroot}${prefix}/bin \
		${destroot}${prefix}/share/doc/${name} \
		${destroot}${prefix}/share/man/man1
	xinstall -m 755 -W ${worksrcpath} optipng ${destroot}${prefix}/bin
	eval xinstall -m 644 [glob ${worksrcpath}/../doc/*] \
		${worksrcpath}/../README.txt ${destroot}${prefix}/share/doc/${name}
	xinstall -m 644 ${worksrcpath}/../man/optipng.1 \
		${destroot}${prefix}/share/man/man1
}
