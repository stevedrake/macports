# $Id: Portfile,v 1.1 2005/07/18 18:06:24 pguyot Exp $

PortSystem 1.0
name            twain-sane
version         1.2
categories      graphics
maintainers     pguyot@kallisys.net
description     TWAIN datasource for SANE
homepage        http://www.ellert.se/twain-sane/
platforms       macosx

long_description \
				This is a TWAIN datasource for MacOS X that aquires images \
				using the SANE backend libraries. The SANE backend libraries \
				provide access to a large range of scanners connected through \
				SCSI or USB. For a complete list see the documentation on the \
				SANE project homepage. It works with my HP SCSI scanner, and \
				many people have reported success with a large number of \
				different scanners. The feedback from users have helped the \
				SANE developers to fix problems with various backends, so with \
				each release of the SANE backends more of the MacOS X specific \
				problems have been solved.
distname		TWAIN-SANE-Interface-${version}
master_sites    http://www.ellert.se/PKGS/${distname}/src/

checksums       md5 722ac70d81c77c277652722173a7a033

depends_lib     lib:libiconv:libiconv \
				lib:libintl:gettext \
				lib:libusb:libusb \
				lib:libsane:sane-backends

use_configure no

pre-build {
	# Generate Info.plist
	cd "${worksrcpath}/src"
	system "./Info.sh > Info.plist"
}

set xcode_args "-project SANE.ds.xcode -buildstyle Deployment \
	LIBRARY_SEARCH_PATHS=${prefix}/lib \
	HEADER_SEARCH_PATHS=${prefix}/include \
	INSTALL_MODE_FLAG=go-w,a+rX \
	INSTALL_PATH='/Library/Image Capture/TWAIN Data Sources' \
	DSTROOT=${destroot}"
build.dir "${worksrcpath}/src"
build.type pbx
build.target
build.args build ${xcode_args}

destroot.dir "${worksrcpath}/src"
destroot {
	cd "${destroot.dir}"
	system "${build.cmd} install ${xcode_args}"
}