# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                vlfeat
version             0.9.5
categories          graphics devel
platforms           darwin
maintainers         stromnov openmaintainer
description         Implementation of SIFT, MSER and other CV algorithms.

long_description \
    The VLFeat open source library implements popular computer vision \
    algorithms including SIFT, MSER, k-means, hierarchical k-means, \
    agglomerative information bottleneck, and quick shift.

homepage            http://vlfeat.org/
master_sites        http://vlfeat.org/download/
worksrcdir          ${name}

checksums           md5     43abe237f4f4b6956e978a8808dbed12 \
                    sha1    1cefeedd0b5f56bf2bbb4f61a7d9d3c04116d70a \
                    rmd160  de18bc57582759b420b7f749a4d091be96f5f257

patchfiles          patch-Makefile.diff

use_configure       no

post-patch {
    reinplace "s|@loader_path/|${prefix}/lib/|g" ${worksrcpath}/Makefile
}

destroot {
    xinstall -m 755 -W ${worksrcpath}/bin/maci libvl.dylib ${destroot}${prefix}/lib
    xinstall -m 755 -W ${worksrcpath}/bin/maci sift mser ${destroot}${prefix}/bin
    xinstall -d -m 755 ${destroot}${prefix}/include/vl
    foreach header [glob -directory ${worksrcpath}/vl *.h] {
         xinstall -m 644 $header ${destroot}${prefix}/include/vl
    }
}

livecheck.type      regex
livecheck.url       ${master_sites}
livecheck.regex     "${name}-(\\d+(?:\\.\\d+)*)${extract.suffix}"
