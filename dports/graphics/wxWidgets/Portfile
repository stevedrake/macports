# $Id: Portfile,v 1.7 2004/11/11 17:49:11 mww Exp $

PortSystem 1.0

name			wxWidgets
version			2.5.3
revision		1
categories		graphics devel
platforms		darwin
maintainers		mww@opendarwin.org blb@pobox.com
description		mature cross-platform C++ GUI framework
long_description	wxWidgets is a mature open-source cross-platform C++ \
				GUI framework for MacOS, Unix, Linux, Windows. It can \
				make use of a variety of native widget sets as well as \
				its own widget set: MacOS, GTK+, Motif, WIN32. \
				wxWidgets will even run on embedded systems using \
				Linux and X11.

homepage		http://www.wxwidgets.org/
master_sites	ftp://biolpc22.york.ac.uk/pub/${version}/ \
				sourceforge:wxwindows
distname		wxAll-${version}
checksums		md5 7c60c25223c9f76061fc7306ca2a6ec1
use_bzip2		yes

depends_lib		lib:libjpeg:jpeg \
				lib:libtiff:tiff \
				lib:libpng:libpng \
				lib:libfreetype.6:freetype \
				lib:libz:zlib \
				lib:expat:expat \
				bin:sdl-config:libsdl \
				lib:libSDL_mixer:libsdl_mixer

set worksrcdir	build

post-extract	{
	file mkdir ${worksrcpath}
	system "touch ${workpath}/${name}-${version}/samples/tab/Makefile.in"
}

patch.dir		${workpath}/${name}-${version}
patchfiles		patch-Makefile.in \
				patch-src-common-datetime.cpp \
				patch-src-common-dcbase.cpp \
				patch-src-gtk-mdi.cpp \
				patch-src-msw-combobox.cpp

configure.cmd	../${name}-${version}/configure
configure.env	CPPFLAGS="-I${prefix}/include" \
				LDFLAGS="-L${prefix}/lib"
configure.args	--mandir=${prefix}/share/man \
				--with-libjpeg \
				--with-libtiff \
				--with-libpng \
				--with-freetype \
				--with-zlib \
				--with-sdl \
				--disable-sdltest

variant darwin	{
	configure.args-append	--with-mac \
				--with-opengl \
				--disable-shared
	post-destroot	{
		system "cd ${destroot}${prefix}/bin && \
			ln -sf ${prefix}/lib/wx/config/mac-ansi-release-static-2.5 wx-config"
	}
}

#variant gtk	{
#	configure.args-delete	--with-mac
#	configure.args-append	--with-gtk
#}

build.target

pre-destroot	{
	xinstall -d -m 755 ${destroot}${prefix}/share/doc/${name}
	xinstall -m 644 -W ${workpath}/${name}-${version} BuildCVS.txt CHANGES.txt \
		COPYING.LIB INSTALL-MAC.txt INSTALL-MGL.txt INSTALL-MOTIF.txt \
		INSTALL-OS2.txt INSTALL-X11.txt LICENCE.txt README-MAC.txt \
		README-MGL.txt README-MOTIF.txt README-X11.txt README.txt \
		${destroot}${prefix}/share/doc/${name}
}
