# $Id$

PortSystem 1.0

name			wxWidgets
version			2.8.4
revision		2
categories		graphics devel
platforms		darwin
maintainers		mww@macports.org jwa
description		mature cross-platform C++ GUI framework
long_description	wxWidgets is a mature open-source cross-platform C++ \
    GUI framework for MacOS, Unix, Linux, Windows. It can \
    make use of a variety of native widget sets as well as \
    its own widget set: MacOS, GTK+, Motif, WIN32. \
    wxWidgets will even run on embedded systems using \
    Linux and X11.

homepage		http://www.wxwidgets.org/
distname		wxWidgets
master_sites		sourceforge:wxwindows \
			    http://biolpc22.york.ac.uk/pub/${version}/ 

use_bzip2		yes

distfiles		${distname}-${version}${extract.suffix}
dist_subdir		${distname}/${version}
checksums		${distname}-${version}${extract.suffix} \
			    md5 47cf67e1e3e2cc88938eac797783aab4 \
 			    ${distname}-${version}${extract.suffix} \
    			    sha1 8c84b562ff4bfa3197924998a2b9ca0e6147be90 \
    			    ${distname}-${version}${extract.suffix} \
			    rmd160 8c17820c11e530aef53af73695cc0eb6666bd866

depends_lib		port:jpeg \
			    port:tiff \
    			    port:libpng \
    			    port:zlib \
    			    port:libiconv \
    			    port:expat \
    			    port:libsdl \
    			    port:libsdl_mixer

#set worksrcdir	build
set worksrcdir	${distname}-${version}/build

extract.only	${distname}-${version}${extract.suffix}

patchfiles	patch-chkconf.diff

#configure.cmd	../${distname}-${version}/configure
configure.cmd		../configure
configure.ldflags	-L${build.dir}/lib
configure.args		--mandir=${prefix}/share/man \
			    --with-libiconv-prefix=${prefix} \
    			    --with-libjpeg \
    			    --with-libtiff \
    			    --with-libpng \
    			    --with-zlib \
    			    --with-sdl \
    			    --with-opengl \
    			    --with-mac \
    			    --disable-sdltest \
    			    --enable-unicode \
    			    --enable-display \
    			    --enable-monolithic

platform darwin 8 {
	configure.env-append	CC=/usr/bin/gcc-4.0 CPP=/usr/bin/cpp-4.0 CXX=/usr/bin/g++-4.0
}

set contrib		"gizmos stc ogl"

build.target

post-build {
    foreach c { ${contrib} } {
	system "cd ${build.dir} && make -C contrib/src/${c}"
    }
}

post-destroot {
    foreach c { ${contrib} } {
	system "cd ${destroot.dir} && make -C contrib/src/${c} install ${destroot.destdir}"
    }

    xinstall -d -m 755 ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 -W ${workpath}/${distname}-${version} \
	install-mac.txt install-mgl.txt install-motif.txt \
	INSTALL-OS2.txt install-x11.txt readme-cocoa.txt \
	readme-gtk.txt readme-mac.txt \
	readme-mgl.txt readme-motif.txt readme-x11.txt \
	${destroot}${prefix}/share/doc/${name}
    system "cd ${destroot}${prefix}/bin && \
		ln -sf ${prefix}/lib/wx/config/mac-unicode-release-2.8 wx-config"
}

livecheck.check		regex
livecheck.url		${homepage}/downloads/
livecheck.regex		ftp.wxwidgets.org/pub/(2.8.\[0-9\]+)/

