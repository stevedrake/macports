# $Id$

PortSystem 1.0

name			bitlbee
version			3.0
categories		irc net
platforms		darwin
maintainers		yeled
description		An IRC to other chat networks gateway
long_description	bitlbee is an IRC server that can connect to IM \
				networks such as AIM and MSN. Its intention is you \
				only have to use one client application for all your \
				instant messaging.

homepage		http://www.bitlbee.org/
master_sites		http://get.bitlbee.org/src/
checksums           md5     455fc8070d758c2bb3442ef4c709ad69 \
                    sha1    c791d46b974187a1d4cf341418c3d1729f9b9658 \
                    rmd160  7d3e9fbbf2835c014bbaf64d926aa00b3a66624d

depends_lib		port:gnutls port:gettext path:lib/pkgconfig/glib-2.0.pc:glib2 port:libgcrypt \
				port:libgpg-error port:libiconv 

patchfiles		patch-configure.diff
configure.args	--config=${prefix}/var/lib/bitlbee/ --ssl=gnutls --otr=0
configure.universal_args

destroot.target	install install-etc

post-destroot {
	destroot.keepdirs ${destroot}${prefix}/var/lib/bitlbee
	set etcdir ${destroot}${prefix}/etc/bitlbee
	move ${etcdir}/bitlbee.conf ${etcdir}/bitlbee.conf.sample
	move ${etcdir}/motd.txt ${etcdir}/motd.txt.sample
}

post-activate {
	ui_msg "To complete installation, run"
	ui_msg "sudo cp ${prefix}/etc/bitlbee/bitlbee.conf.sample ${prefix}/etc/bitlbee/bitlbee.conf"
	ui_msg "and edit ${prefix}/etc/bitlbee/bitlbee.conf to taste"
}

livecheck.type  regex
livecheck.url   ${master_sites}
livecheck.regex "${name}-(\\d+(?:\\.\\d+)*)${extract.suffix}"

default_variants +otr

variant otr description {Off-the-Record messaging} {
	configure.args-delete --otr=0
	configure.args-append --otr=1
	depends_lib-append    port:libotr
}
