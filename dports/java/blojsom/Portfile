# $Id: Portfile,v 1.1 2004/12/14 04:51:18 jberry Exp $

PortSystem 1.0

name				blojsom
version				2.21

categories			java www
maintainers			jberry@opendarwin.org
platforms			darwin

description			A blogging package written in Java.
long_description	Blojsom is a full-featured, multi-user, multi-blog package written in Java \
					that was inspired by blosxom. blojsom aims to retain the simplicity \
					in design of its Perl-based "relative" while adding user flexibility \
					in areas such as the flavors, templating, plugins, and the ability to \
					run a multi-user blog with a single blojsom installation.
homepage			http://www.blojsom.com
				
distname			${name}-${version}-source
master_sites		sourceforge
checksums			md5 5eb44eee355f1e0a7d24567f7e1d9f5a

use_zip				yes
use_configure		no

depends_build		bin:ant:apache-ant
depends_lib			bin:java:kaffe

default_variants	+tomcat5

variant tomcat5 {
	depends_lib-append	lib:XXX:tomcat5
}

extract.dir			${worksrcpath}
pre-extract {
	file mkdir "${worksrcpath}"
}
				
build.cmd			ant
build.target		war javadoc

destroot	{
	# Ensure needed directories
	xinstall -m 755 -d ${destroot}${prefix}/share/java \
		${destroot}${prefix}/share/doc
		
	# Install the war where it can be found
	xinstall -m 644 \
		${worksrcpath}/distro/blojsom.war \
		${destroot}${prefix}/share/java
		
	# Install the war into the tomcat webapps directory
	if {[variant_isset tomcat5]} {
		xinstall -m 755 -d ${destroot}${prefix}/share/java/tomcat5/webapps
		xinstall -m 644 \
			${worksrcpath}/distro/blojsom.war \
			${destroot}${prefix}/share/java/tomcat5/webapps
		
		ui_info "#"
		ui_info "# blojsom.war was copied into the tomcat5/webapps directory. "
		ui_info "# You may need to kick tomcat so that it'll be deployed."
		ui_info "#"
	}

	# Install docs
	file copy ${worksrcpath}/docs/content ${destroot}${prefix}/share/doc/${name}
}
