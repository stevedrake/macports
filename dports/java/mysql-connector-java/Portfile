# $Id$

PortSystem 1.0

name				mysql-connector-java
version				5.1.11
set branch          [join [lrange [split ${version} .] 0 1] .]

categories			java
maintainers			jberry openmaintainer
platforms			darwin

description			MySQL Official JDBC connector for MySQL database.
long_description	MySQL Connector/J is a native Java driver that converts JDBC \
					(Java Database Connectivity) calls into the network protocol \
					used by the MySQL database. It lets developers working with \
					the Java programming language easily build programs and applets \
					that interact with MySQL and connect all corporate data, even \
					in a heterogeneous environment. MySQL Connector/J is a Type IV \
					JDBC driver and has a complete JDBC feature set that supports \
					the capabilities of MySQL.
homepage			http://dev.mysql.com/doc/refman/${branch}/en/connector-j.html

master_sites		http://ftp.plusline.de/mysql/Downloads/Connector-J/
checksums           md5     22630172e67c1a96996c3201d9b30398 \
                    sha1    0183a6b52cfdb935826590f667e5272f6fffe943 \
                    rmd160  53c048d215bee69f35d3f8335bd61328d734ff21

patchfiles			patch-build.xml

depends_build		bin:ant:apache-ant
depends_lib			bin:java:kaffe \
					port:junit \
					port:jakarta-log4j


set javaLibs		${prefix}/share/java

use_configure		no

build.cmd			ant
build.target		dist
build.args			-Djunit.jar=${javaLibs}/junit.jar \
					-Dlog4j.jar=${javaLibs}/jakarta-log4j.jar					

destroot {
	xinstall -d ${destroot}${prefix}/share/java \
		${destroot}${prefix}/share/doc
	xinstall -m 644 ${worksrcpath}/build/${distname}/${distname}-bin.jar \
		${destroot}${prefix}/share/java/${name}-5.0.jar
	copy ${worksrcpath}/docs ${destroot}${prefix}/share/doc/${name}

    set docdir ${prefix}/share/doc/${name}
    xinstall -m 644 -W ${worksrcpath} CHANGES COPYING EXCEPTIONS-CONNECTOR-J \
        ${destroot}${docdir}
}

platform darwin 10 {
	post-patch {
		reinplace -E {/name="compile"/s/compile-testsuite, //} \
			${worksrcpath}/build.xml
	}

	patchfiles-append patch-JDK-1.6.diff
}

livecheck.type  regex
livecheck.url   http://dev.mysql.com/downloads/connector/j/${branch}.html
livecheck.regex "${name}-(\\d+\\.\\d+(\\.\\d+)?).tar.gz"
