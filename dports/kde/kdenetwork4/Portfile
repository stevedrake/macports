# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           kde4   1.0

name                kdenetwork4
version             4.4.5
revision            1
categories          kde kde4 network
maintainers         snc sharky
description         KDE4 networking applications
long_description    Networking applications such as an instant messenger \
                    and download manager
platforms           darwin
homepage            http://www.kde.org
master_sites        kde:stable/${version}/src
use_bzip2           yes
distname            kdenetwork-${version}
checksums           sha1    5f321ce932d6b1fadf1935e527bd1848c317be7a \
                    rmd160  5cf43ba3e1b772a0fe1306f9553d5ad9cfa40a8b

depends_lib-append  port:kdebase4-runtime \
                    port:meanwhile \
                    port:qca \
                    path:lib/libspeex.dylib:speex \
                    port:libidn \
                    port:kdepimlibs4 \
                    port:libotr
depends_run-append  port:qca-ossl

post-extract {
    # change #include <Phonon...> to <phonon...> in all files that
    # contain that header.
    foreach item [exec grep -lr "Phonon" ${workpath}/${distname}] {
        reinplace "/#include/s@Phonon@phonon@" ${item}
    }
}

configure.args-append   ../${distname}
configure.pkg_config_path-append ${qt_dir}/lib/pkgconfig

variant no_kopete conflicts libmsn xmms description "Do not install Kopete instant messaging client" {
    depends_lib-delete      port:qca \
                            path:lib/libspeex.dylib:speex \
                            port:libotr \
                            port:libidn
    depends_run-delete      port:qca-ossl
    configure.args-append   -DBUILD_kopete=OFF
}

variant xmms conflicts no_kopete description {Used by the Kopete nowlistening plugin to support the XMMS player} {
    depends_lib-append port:xmms
}

variant libmsn conflicts no_kopete description {Required for the Kopete wlm plugin} {
    depends_lib-append port:libmsn
}

universal_variant   no

livecheck.url       http://mirrors.ibiblio.org/pub/mirrors/kde/stable/latest/src/
livecheck.regex     kdenetwork-(\\d+\\.\\d+\\.\\d+)${extract.suffix}
