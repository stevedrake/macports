# $Id$

PortSystem          1.0

name                koffice2-devel
version             1.9.98.5
revision            1
categories          kde kde4
maintainers         nomaintainer
description         A variety of games made with the KDE4 platform
long_description    ${description}
platforms           darwin
homepage            http://www.kde.org
distname            koffice-${version}
master_sites        kde:unstable/${distname}/src/
use_bzip2           yes
checksums           md5 1525ca823dc39934a16cf1de0750ec11

patchfiles          koffice_int_cast.diff
patch.dir           ${workpath}/${distname}

depends_lib         port:kdelibs4 port:kdebase4 \
                    port:eigen
                    #port:libwpd port:libwpg 
                    #port:qca port:pstoedit 
                    #port:poppler port:gmm
                    #port:graphicsmagick 
                    #port:gsl port:glew
                    #port:openctl
# The ports above can enable extra features (reportedly)

depends_build       port:cmake port:automoc

use_parallel_build  yes
worksrcdir          build
post-extract       { file mkdir ${worksrcpath} }

configure.cmd       cmake
configure.ccache    no
configure.compiler  gcc-4.2
configure.args	../${distname} -DBUILD_SHARED_LIBS=ON \
		-DCMAKE_BUILD_WITH_INSTALL_RPATH=ON \
		-DCMAKE_VERBOSE_MAKEFILE=ON \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_SYSTEM_PREFIX_PATH=\"${prefix}\;/usr\" \
		-DCMAKE_INSTALL_PREFIX=${prefix} \
		-DCMAKE_INSTALL_NAME_DIR=${prefix}/lib/ \
		-DPHONON_INCLUDE_DIR=${prefix}/include \
		-DPHONON_LIBRARY=${prefix}/lib/libphonon.dylib \
		-DBUNDLE_INSTALL_DIR=${applications_dir} \
		-DCMAKE_OSX_SYSROOT=${universal_sysroot} \
		-DQT_QMAKE_EXECUTABLE=${prefix}/libexec/qt4-mac/bin/qmake \
		-Wno-dev

variant universal {
    configure.universal_args-delete  --disable-dependency-tracking
    configure.args-append	-DCMAKE_OSX_ARCHITECTURES=\"[strsed ${configure.universal_archs} "g| |;|"]\"
}

variant debug description "Enable debug binaries" {
	configure.args-delete		-DCMAKE_BUILD_TYPE=Release
	configure.args-append		-DCMAKE_BUILD_TYPE=debugFull
}

post-destroot {
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/format-justify-center.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/format-justify-fill.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/format-justify-left.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/format-justify-right.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/format-text-bold.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/format-text-italic.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/format-text-underline.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/object-group.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/object-order-back.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/object-order-front.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/object-order-lower.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/object-order-raise.png"
    system "rm ${destroot}${prefix}/share/icons/oxygen/16x16/actions/object-ungroup.png"
}

