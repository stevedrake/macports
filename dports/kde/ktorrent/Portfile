# $Id$

PortSystem          1.0

name                ktorrent
version             3.1.5
revision            1
categories          kde kde4
maintainers         illogic-al@macports.org openmaintainer
description         KDE4 bittorrent client.
long_description    Bittorrent client for KDE4 supporting a variety of \
                    features such as uPNP.
platforms           darwin
homepage            http://www.kde.org
master_sites	    http://ktorrent.org/downloads/${version}/
use_bzip2           yes
checksums           md5 2b11f05f2bc70c5b1403335698761d64

depends_lib         path:${prefix}/bin/kde4:kdebase4-runtime \
                    port:qca port:gmp

depends_build       port:cmake

use_parallel_build  yes
worksrcdir          build
pre-configure 	    { file mkdir ${worksrcpath} }

configure.cmd	    cmake
configure.ccache    no
configure.args	../${distname} -DBUILD_SHARED_LIBS=ON \
		-DCMAKE_BUILD_WITH_INSTALL_RPATH=ON \
		-DCMAKE_VERBOSE_MAKEFILE=ON \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_SYSTEM_PREFIX_PATH=\"${prefix}\;/usr\" \
		-DCMAKE_INSTALL_PREFIX=${prefix} \
		-DCMAKE_INSTALL_NAME_DIR=${prefix}/lib/ \
		-DPHONON_INCLUDE_DIR=${prefix}/include \
		-DPHONON_LIBRARY=${prefix}/lib/libphonon.dylib \
		-DQCA2_LIBRARIES=${prefix}/lib/libqca.2.dylib \
		-DQCA2_INCLUDE_DIR=${prefix}/include/QtCrypto \
		-DCMAKE_OSX_SYSROOT=${sysroot} \
		-DQT_QMAKE_EXECUTABLE=${prefix}/libexec/qt4-mac/bin/qmake \
		-Wno-dev

variant universal {
    configure.universal_args-delete  --disable-dependency-tracking
    configure.args-append	-DCMAKE_OSX_ARCHITECTURES=\"ppc\;i386\"
}

variant debug description "Enable debug binaries" {
	configure.args-delete		-DCMAKE_BUILD_TYPE=Release
	configure.args-append		-DCMAKE_BUILD_TYPE=debugFull
}

