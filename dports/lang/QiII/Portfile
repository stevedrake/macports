# $Id$

PortSystem        1.0

name              QiII
version           1.07
categories        lang
maintainers       mac.com:quest
platforms         darwin
description       Qi is a functional programming language developed \
                  by Dr Mark Tarver

long_description  Qi is a functional programming language developed \
                  by Dr Mark Tarver and introduced in April 2005. A \
                  new version was reimplemented and issued as Qi II \
                  in November 2008. The first version was free \
                  software, licensed under GPL. But, as GPL was \
                  perceived as unfriendly to commercial use, Qi II \
                  is available via two proprietary licenses: one for \
                  personal and educational use, and another for \
                  producing closed source software. \
                  Qi is written in Lisp. It includes most of the \
                  features common to modern functional programming \
                  languages such as pattern-matching, currying, partial \
                  applications, guards and (optional) static type checking.

homepage          http://http://www.lambdassociates.org/
master_sites      http://www.lambdassociates.org/Download/
distname          ${name}${version}
use_zip           yes
use_configure     no

checksums         md5 3a0b5c56d0f107f80f5bca11b82a4d59

depends_build       port:sbcl

build { 
  system "cd ${worksrcpath}/Lisp; sbcl --load 'install.lsp'"
  reinplace "s|Qi.core|${prefix}/src/${name}/Lisp/Qi.core|g" ${worksrcpath}/Lisp/Qi-Linux-SBCL
  system "cd ${worksrcpath}/Lisp; cat Qi-Linux-SBCL | col -b > Qi-Mac-SBCL"
  system "cd ${worksrcpath}/Lisp; chmod 755 Qi-Mac-SBCL"
}

destroot {
  system "cp -R ${worksrcpath} ${destroot}${prefix}/src/${name}"
}

post-install {
  system "ln -fs ${prefix}/src/${name}/Lisp/Qi-Mac-SBCL ${prefix}/bin/Qi"
}

post-uninstall {
  system "cd ${prefix}/bin; rm Qi"
}
