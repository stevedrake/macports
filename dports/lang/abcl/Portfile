# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name			    abcl
version			    0.16.0
categories		    lang java
maintainers		    easieste
description		    A Common Lisp implementation that runs on the JVM
long_description	\
    ABCL is a full implementation of the Common Lisp language \
    featuring both an interpreter and a compiler, running in the \
    JVM. Originally started to be a scripting language for the J \
    editor, it now supports JSR-233 (Java scripting API): it can be a \
    scripting engine in any Java application. Additionally, it can be \
    used to implement (parts of) the application using Java to Lisp \
    integration APIs.
homepage		    http://common-lisp.net/project/armedbear
platforms           darwin

master_sites        googlecode:abcl-dynamic-install
distfiles           abcl-src-${version}.tar.gz

checksums           md5     c1be02fc81b0c4c7f671a8c0890eca76 \
                    sha1    da91df261b330edb975af227679498cb8675fd4d \
                    rmd160  28bd6341c702845518ebc7f94ca8c67423dc1d34

depends_build       port:apache-ant

worksrcdir          abcl-src-${version}

use_configure       no

build.cmd           ant
build.target        abcl.wrapper

post-build {
    reinplace "s|${worksrcpath}/dist/abcl.jar|${prefix}/share/java/abcl/abcl.jar|g" \
        ${worksrcpath}/abcl
}

destroot {
    xinstall -m 755 -d ${destroot}${prefix}/share/java/abcl  
    xinstall -m 644 \
        ${worksrcpath}/dist/abcl.jar \
        ${destroot}${prefix}/share/java/abcl
    xinstall -m 755 \
        ${worksrcpath}/abcl \
        ${destroot}${prefix}/share/java/abcl
	system "ln -fs ${prefix}/share/java/abcl/abcl \
		${destroot}${prefix}/bin/abcl"
}