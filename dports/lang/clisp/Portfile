# $Id: Portfile,v 1.9 2004/08/27 15:11:42 gwright Exp $

PortSystem 1.0
name		clisp
version		2.33.2
categories	lang
maintainers	gwright@comcast.net
platforms	darwin
description	The Clisp Common Lisp Implementation
long_description	\
		CLISP is a Common Lisp implementation by Bruno Haible, \
		formerly of Karlsruhe University, and Michael Stoll, \
		formerly of Munich University, both in Germany. \
		It mostly supports the Lisp described in the \
		ANSI Common Lisp standard. \
		CLISP includes an interpreter, a compiler, almost all \
		of CLOS, a foreign language interface and a socket interface. \
		An X11 interface is available through CLX and Garnet. \
		Command line editing is provided by readline.

homepage	http://clisp.cons.org/
master_sites	gnu:clisp/release/2.33.2 \
		sourceforge

depends_lib	lib:libintl.3:gettext	\
		lib:readline.5:readline

checksums	md5 e1e3b43bca46085e29d7f9daca782a47

#user_notes	Tested with OS X 10.3.5 and gcc from the Xcode 1.5 release. \
#		Earlier versions of clisp had linking problems with some \
#		versions of the OS X toolchain.

build.dir	${workpath}/${worksrcdir}/src

variant darwin {
		 patchfiles	patch-src-stream.d
}

post-configure	{ cd ${build.dir}
		  system "./makemake --prefix=${prefix} --with-readline --with-gettext \
				     --with-dynamic-ffi --with-module=regexp \
				     --with-export-syscalls > Makefile && \
				     make config.lisp"
		}

build		{ system "ulimit -s 8192 && \
			  cd ${build.dir} && \
			  make && \
			  make check"
		}

pre-destroot	{ cd ${build.dir} }


