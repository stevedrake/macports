# $Id: Portfile,v 1.2 2004/12/25 09:54:21 waqar Exp $

PortSystem 1.0
name		gcl
version		2.6.5
revision	0
categories	lang
maintainers	waqar@opendarwin.org
description	GNU Common Lisp
long_description	\
	GCL is the official Common Lisp for the GNU project. Its design \
	makes use of the system's C compiler to compile to native 	\
	object code, providing for both good performance and facile 	\
	portability. On most platforms, GCL can load native object code \
	modules directly into its lisp core, where they are preserved 	\
	in any custom lisp images produced via the save-system call.
platforms	darwin
homepage       	http://www.gnu.org/software/gcl
master_sites	gnu
checksums	md5 e0852318b81c93b76bc7e012f036ec6c
depends_lib	lib:libintl.3:gettext

patch 		{
	reinplace "s|/sw|${prefix}|g" ${worksrcpath}/h/powerpc-macosx.defs
}

configure.env	CFLAGS="-no-cpp-precomp"

configure.args  --enable-machine=powerpc-macosx	\
		--enable-ansi			\
		--disable-statsysbfd 		\
		--disable-locbfd 		\
		--enable-custreloc 		\
		--enable-notify=no		\
		--mandir=${prefix}/share/man 	\
		--enable-infodir=${prefix}/share/info \
		--enable-emacsdir=${prefix}/share/emacs/site-lisp/gcl \
		--enable-readline 

post-configure	{
	reinplace "s|./default.el|${prefix}/etc/default.el|g" \
		${worksrcpath}/makedefs \
		${worksrcpath}/makedefc
	reinplace "s|/usr/share|${prefix}/share|g" \
		${worksrcpath}/makedefs \
		${worksrcpath}/makedefc
}

destroot.destdir       DESTDIR=${destroot}

variant x11	{
	configure.args-append --with-x
}
