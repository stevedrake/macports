# $Id: Portfile,v 1.27 2005/04/23 21:27:26 gwright Exp $

PortSystem	1.0
name		logtalk
version		2.24.0

categories	lang
maintainers	pmoura@mac.com
platforms	darwin freebsd linux
description	Logtalk - Open source object-oriented extension to Prolog

long_description	\
		Logtalk is an open source object-oriented extension to the 	\
		Prolog programming language. Integrating logic programming 	\
		with object-oriented and event-driven programming, it is 	\
		compatible with most Prolog compilers. It supports both 	\
		prototypes and classes. In addition, it supports component-	\
		based programming through category-based composition.

homepage        http://www.logtalk.org/
master_sites	${homepage}/files/

checksums		md5 600444371b64976ad09f733334476a4c

distname		lgt2240
extract.suffix	.tgz

configure	{}

build		{}

destroot	{
	system "mkdir ${destroot}${prefix}/share/${distname}"
	cd ${destroot}${prefix}/share/${distname}

	system "cp -R ${workpath}/${worksrcdir}/* ."
	system "chmod -R go-w,a+r ."
	system "chmod a+x scripts/*.sh"
	system "chmod a+x xml/*.sh"
}

post-destroot	{
	cd ${destroot}/${prefix}/share
	system "ln -sf ${distname} logtalk"

	cd ../bin
	system "ln -sf ../share/${distname}/misc/cplgtdirs.sh cplgtdirs"
	system "ln -sf ../share/${distname}/xml/lgt2html.sh lgt2html"
	system "ln -sf ../share/${distname}/xml/lgt2pdf.sh lgt2pdf"

	if {[variant_isset gprolog]} {
		system "export LOGTALKHOME=../share/${distname}; ../share/${distname}/scripts/make_gplgt.sh ${prefix}"
		ui_msg "*******************************************************"
		ui_msg "*  In order to run Logtalk using GNU-Prolog as the    *"
		ui_msg "*  back-end Prolog compiler simply call the program   *"
		ui_msg "*  gplgt from the command line.                       *"
		ui_msg "*******************************************************"
	}

	if {[variant_isset swi-prolog]} {
		system "export LOGTALKHOME=../share/${distname}; ../share/${distname}/scripts/make_swilgt.sh ${prefix}"
		ui_msg "*******************************************************"
		ui_msg "*  In order to run Logtalk using SWI-Prolog as the    *"
		ui_msg "*  back-end Prolog compiler simply run the script     *"
		ui_msg "*  swilgt from the command line.                      *"
		ui_msg "*******************************************************"
	}

	if {[variant_isset yap]} {
		system "export LOGTALKHOME=../share/${distname}; ../share/${distname}/scripts/make_yaplgt.sh ${prefix}"
		ui_msg "*******************************************************"
		ui_msg "*  In order to run Logtalk using YAP as the back-end  *"
		ui_msg "*  Prolog compiler simply run the script yaplgt from  *"
		ui_msg "*  the command line.                                  *"
		ui_msg "*******************************************************"
	}
}

variant	gprolog	{
	depends_lib-append bin:gplc:gprolog
}

variant	swi-prolog	{
	depends_lib-append bin:swipl:swi-prolog
}

variant	yap	{
	depends_lib-append bin:yap:yap
}

post-activate	{ ui_msg "Remember to set the environment variables LOGTALKHOME to the path to the"
		  ui_msg "logtalk distribution (usually ${prefix}/share/${distname})"
		  ui_msg "and LOGTALKUSER to your local configuration directory."
}

