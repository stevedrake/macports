# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name                    mit-scheme
version                 20080130
categories              lang
maintainers             nomaintainer

description             MIT/GNU Scheme

long_description        MIT/GNU Scheme is an implementation of the \
                        Scheme programming language, providing an \
                        interpreter, compiler, source-code debugger, \
                        integrated Emacs-like editor, and a large \
                        runtime library. MIT/GNU Scheme is best suited \
                        to programming large applications with a rapid \
                        development cycle.

homepage                http://www.gnu.org/software/mit-scheme/
master_sites            http://ftp.gnu.org/gnu/mit-scheme/snapshot.pkg/${version}/
distname                ${name}-c-${version}
extract.suffix          .tar.gz
checksums               md5 75e11fcba96c9efd49cd283b43d6839a

post-patch  {
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/doc/configure
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/doc/ref-manual/os-interface.texi
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/doc/scheme.1
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/doc/user-manual/user.texinfo
    reinplace "s|/usr/local|${prefix}|g" ${worksrcpath}/src/6001/edextra.scm
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/6001/floppy.scm
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/compiler/documentation/porting.guide
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/compiler/etc/disload.scm
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/configure
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/edwin/techinfo.scm
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/edwin/unix.scm
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/lib/edwin/techinfo.scm
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/lib/edwin/unix.scm
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/lib/include/configure
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/lib/include/option.c
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/microcode/configure
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/microcode/option.c
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/README.txt
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/swat/c/tk3.2-custom/Makefile
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/swat/c/tk3.2-custom/tcl/Makefile
    reinplace "s|/usr/local|${prefix}|" ${worksrcpath}/src/swat/scheme/other/btest.scm
}

use_configure           no

use_parallel_build      no

build.dir               ${worksrcpath}/src
build.cmd               etc/make-liarc.sh
build.args              --prefix=${prefix}
build.target            ""

destroot.dir            ${worksrcpath}/src
destroot.cmd            make
