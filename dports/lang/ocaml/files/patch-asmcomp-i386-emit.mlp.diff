--- asmcomp/i386/emit.mlp.orig	2009-03-29 00:10:04.000000000 +0900
+++ asmcomp/i386/emit.mlp	2009-10-01 19:30:07.000000000 +0900
@@ -10,7 +10,7 @@
 (*                                                                     *)
 (***********************************************************************)
 
-(* $Id: emit.mlp,v 1.41.2.4 2009/03/28 15:10:04 xleroy Exp $ *)
+(* $Id: emit.mlp,v 1.41.2.6 2009-09-13 16:48:19 xleroy Exp $ *)
 
 (* Emission of Intel 386 assembly code *)
 
@@ -888,7 +888,9 @@
   bound_error_call := 0;
   `	.text\n`;
   emit_align 16;
-  if macosx && is_generic_function fundecl.fun_name
+  if macosx
+  && not !Clflags.output_c_object
+  && is_generic_function fundecl.fun_name
   then (* PR#4690 *)
     `	.private_extern	{emit_symbol fundecl.fun_name}\n`
   else
@@ -928,9 +930,9 @@
   | Cint n ->
       `	.long	{emit_nativeint n}\n`
   | Csingle f ->
-      `	.float	{emit_string f}\n`
+      emit_float32_directive ".long" f
   | Cdouble f ->
-      `	.double	{emit_string f}\n`
+      emit_float64_split_directive ".long" f
   | Csymbol_address s ->
       `	.long	{emit_symbol s}\n`
   | Clabel_address lbl ->
