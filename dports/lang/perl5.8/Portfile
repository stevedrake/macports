# $Id: Portfile,v 1.34 2004/07/30 18:35:09 rshaw Exp $

PortSystem		1.0
name			perl5.8
version			5.8.5
categories		lang
maintainers		rshaw@opendarwin.org michaelm@opendarwin.org
description		Perl 5.8.x - Practical Extraction and Report Language
long_description \
	Perl is a general-purpose programming language originally developed \
	for text manipulation and now used for a wide range of tasks including \
	system administration, web development, network programming, GUI \
	development, and more.
platforms		darwin freebsd
distname		perl-${version}
master_sites	http://www.cpan.org/src/5.0/
checksums		md5 49baa8d7d29b4a9713c06edeb81e6b1b

variant darwin {
	pre-configure {
		reinplace "s|ld=\"MACOSX_DEPLOYMENT_TARGET=10.3|ld=\"env MACOSX_DEPLOYMENT_TARGET=10.3|g" "${worksrcpath}/hints/darwin.sh"
	}
}

configure.env		LC_ALL=C
configure.cmd		sh Configure
configure.pre_args	
configure.post_args	-des -Dprefix='${prefix}' -Dccflags="-I'${prefix}/include'"\
					-Dldflags=-L'${prefix}/lib' \
					-Dvendorprefix='${prefix}'

test.run			yes

post-destroot {
	foreach man3File [glob ${destroot}/${prefix}/share/man/man3/*] {
		file rename ${man3File} ${man3File}pm
	}
}

variant threads		{ configure.args-append -Dusethreads }

