# $Id$

PortSystem              1.0
name                    perl5.8
version                 5.8.8
categories              lang
maintainers             michaelm@opendarwin.org
description             Perl 5.8.x - Practical Extraction and Report Language
long_description \
	Perl is a general-purpose programming language originally developed \
	for text manipulation and now used for a wide range of tasks including \
	system administration, web development, network programming, GUI \
	development, and more.
platforms		darwin freebsd
distname		perl-${version}
use_bzip2               yes
homepage				http://www.perl.org/
master_sites            http://www.cpan.org/src/5.0/
checksums               sha1 4aab490040727ca4419098720eca2ba4367df539

variant darwin {
	patchfiles-append	patch-hints_darwin.sh
	pre-configure {
		reinplace "s|ld=\"MACOSX_DEPLOYMENT_TARGET=10.3|ld=\"env MACOSX_DEPLOYMENT_TARGET=10.3|g" "${worksrcpath}/hints/darwin.sh"
	}
}

configure.env		LC_ALL=C
configure.cmd		sh Configure
configure.pre_args	
configure.post_args	-des -Dprefix='${prefix}' -Dccflags="-I'${prefix}/include'"\
					-Dldflags=-L'${prefix}/lib' \
					-Dvendorprefix='${prefix}'

test.run			yes

post-destroot {
	foreach man3File [glob ${destroot}/${prefix}/share/man/man3/*] {
		file rename ${man3File} ${man3File}pm
	}
}

variant threads		{ configure.args-append -Dusethreads }
variant shared		{ configure.args-append -Duseshrplib }

platform darwin 8 {
	configure.post_args-append	-Dcc=/usr/bin/gcc-4.0
}

