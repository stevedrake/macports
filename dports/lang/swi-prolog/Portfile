# $Id$

PortSystem	1.0
name		swi-prolog
version		5.6.47
epoch		20051223

categories	lang
maintainers	wielemak@science.uva.nl pmoura@logtalk.org
platforms	darwin
description	SWI-Prolog compiler plus extra packages (stable version)

long_description	\
	ISO/Edinburgh-style Prolog compiler including modules,		\
	autoload, libraries, Garbage-collector, stack-expandor,		\
	C/C++-interface, Multiple threads, GNU-readline interface,	\
	coroutining, constraint programming, global variables,		\
	very fast compiler. Including packages clib (Unix process	\
	control, sockets, MIME), cpp (C++ interface), sgml (reading	\
	XML/SGML), sgml/RDF (reading RDF into triples), ODBC		\
	interface and XPCE (Graphics UI toolkit, integrated editor	\
	(Emacs-clone) and graphical debugger).

homepage	http://www.swi-prolog.org/
master_sites	http://gollem.science.uva.nl/cgi-bin/nph-download/SWI-Prolog/

checksums	md5     4651f59c31225e87aa977274516cf818

depends_build   port:gawk

depends_lib		\
	lib:libreadline:readline	\
	lib:libncursesw:ncurses		\
	lib:libjpeg:jpeg			\
	lib:libmcrypt:libmcrypt		\
	lib:libX11.6:XFree86		\
	lib:libgmp:gmp				\
	lib:libzlib:zlib

platform darwin 6 {
	depends_lib-append lib:libdl:dlcompat
}

distname	pl-${version}

configure.env	\
	LIBRARY_PATH=/usr/lib:/usr/X11R6/lib:/opt/local/lib 		\
	CPATH=/usr/include:/usr/X11R6/include:/opt/local/include	\
	JUNIT=/opt/local/share/java/junit.jar

configure.ldflags

configure.args	\
	--prefix=${prefix}				\
	--mandir=${prefix}/share/man	\
	--with-world

build.env	\
	LIBRARY_PATH=/usr/lib:/usr/X11R6/lib:/opt/local/lib			\
	CPATH=/usr/include:/usr/X11R6/include:/opt/local/include	\
	JUNIT=/opt/local/share/java/junit.jar

post-pkg {
	set resources ${workpath}/${name}-${version}.pkg/Contents/Resources/
	file copy -force -- ${workpath}/pl-${version}/man/macosx/License.html ${resources}/License.html
	file copy -force -- ${workpath}/pl-${version}/man/macosx/macosx.html ${resources}/ReadMe.html
	file copy -force -- ${workpath}/pl-${version}/man/macosx/Welcome.html ${resources}/Welcome.html
	file delete -force -- ${resources}/Welcome.rtf
}

post-mpkg {
	set resources ${workpath}/${name}-${version}.pkg/Contents/Resources/
	file copy -force -- ${workpath}/pl-${version}/man/macosx/License.html ${resources}/License.html
	file copy -force -- ${workpath}/pl-${version}/man/macosx/macosx.html ${resources}/ReadMe.html
	file copy -force -- ${workpath}/pl-${version}/man/macosx/Welcome.html ${resources}/Welcome.html
	file delete -force -- ${resources}/Welcome.rtf
}

default_variants +mt

variant st {
	configure.args-append --disable-mt
}

variant mt {
	configure.args-append --enable-mt
}
