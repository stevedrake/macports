# $Id: Portfile,v 1.2 2005/01/31 17:28:38 toby Exp $

PortSystem    1.0
name          tom
version       2.1

description      Tom is a pattern matching compiler developed at INRIA.
long_description Tom is a pattern matching compiler developed at INRIA.\
                 It is particularly well-suited for programming various \
                 transformations on  trees/terms and XML based documents.\
                 Its design follows our research on rule based languages (R3),\
                 and our experiences  on the efficient compilation of ELAN\
                 developed by the Protheo group.\
                 Don't forget to add `echo \${TOM_HOME}/lib/*.jar | tr ' ' ':'`\
                 to your CLASSPATH, TOM_HOME being /opt/local/share/java/jtom-2.0
platforms        darwin freebsd linux
categories       lang
maintainers      reilles@loria.fr
homepage         http://tom.loria.fr

fetch.type       cvs
cvs.root         :pserver:cvs@cvs-sop.inria.fr:/CVS/aircube
cvs.password     RSUG
cvs.tag          tom-2_1
cvs.module       ${name}
worksrcdir       ${name}

depends_build    bin:ant:apache-ant

use_configure    no

pre-build {
                 system "echo 'tomdocdir=stable' > ${worksrcpath}/local.properties"
}

build.cmd        ./build.sh
build.target     dist.stable

destroot  {
    xinstall -m 755 -d ${destroot}${prefix}/share/java
    file copy ${worksrcpath}/stable/dist/ ${destroot}${prefix}/share/java/${name}-${version}
    file delete ${destroot}${prefix}/share/java/${name}-${version}/doc
    file copy ${worksrcpath}/stable/dist/share/man/man1/tom.1 ${destroot}${prefix}/share/man/man1/
    file delete ${destroot}${prefix}/share/java/${name}-${version}/man/man1/tom.1

    system "ln -fs ${prefix}/share/java/${name}-${version}/bin/tom \
      ${destroot}${prefix}/bin/tom"
    system "ln -fs ${prefix}/share/java/${name}-${version}/bin/adt-to-tom.sh \
      ${destroot}${prefix}/bin/adt-to-tom"
    system "ln -fs ${prefix}/share/java/${name}-${version}/bin/javac-tom \
			${destroot}${prefix}/bin/javac-tom"
}

