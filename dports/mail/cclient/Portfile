# $Id: Portfile,v 1.8 2005/04/21 15:57:52 jberry Exp $

PortSystem 1.0

name			cclient
version			2002e
revision		1
categories		mail
maintainers		darwinports@opendarwin.org
description		UW IMAP c-client library
long_description	C-client is a common API for accessing mailboxes. It is \
				used internally by the popular PINE mail reader as well as the \
				University of Washington's IMAP server.
homepage		http://www.washington.edu/imap/
platforms		darwin
master_sites	ftp://ftp.cac.washington.edu/imap/\
				opendarwin
extract.suffix	.tar.Z
distname		imap-${version}	
dist_subdir		imap-uw
worksrcdir		imap-${version}
checksums		md5 0d246d868f20d8c441d235b77c940676

depends_lib		port:openssl

use_configure	no

post-patch {
	cd ${worksrcpath}
	reinplace "s|/usr/include/openssl|${prefix}/include/openssl|g" Makefile
	reinplace "s|/usr/lib|${prefix}/lib|g" Makefile
}
build.target	osx EXTRACFLAGS=-fno-common

variant ssl_plaintext {
	patchfiles patch-Makefile
	build.args SSLTYPE=unix
}

destroot {
	xinstall -m 755 -d ${destroot}${prefix}/include/c-client
	xinstall -m 644 -W ${worksrcpath}/c-client \
		c-client.h dummy.h env.h fdstring.h flocksim.h env_unix.h \
		flstring.h fs.h ftl.h imap4r1.h linkage.h mail.h mbox.h mbx.h mh.h \
		misc.h mmdf.h mtx.h mx.h netmsg.h news.h newsrc.h nl.h nntp.h osdep.h \
		phile.h pop3.h pseudo.h rfc822.h smtp.h sslio.h tcp.h tcp_unix.h \
		tenex.h unix.h utf8.h \
		${destroot}${prefix}/include/c-client
	xinstall -m 644 ${worksrcpath}/c-client/c-client.a \
		${destroot}${prefix}/lib/libc-client4.a
	system "cd ${destroot}${prefix}/lib/ && ranlib libc-client4.a"
}
