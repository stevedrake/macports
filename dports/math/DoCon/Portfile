# $Id: Portfile 24964 2007-05-09 06:55:59Z gwright@macports.org $

PortSystem 1.0
name		DoCon
set shortname	docon
version		2.09
categories	devel
maintainers	gwright@macports.org
platforms	darwin

description	DoCon is the Algebraic Domain Constructor
long_description	\
		DoCon joins the categorial approach to mathematical	\
		computation expressed via the Haskell type classes,	\
		and explicit processing of the domain description	\
		terms.  It implements recently a good piece of		\
		commutative algebra: linear algebra, polynomial gcd,	\
		factorization, Groebner bases, and other functions. 

homepage	http://haskell.org/${shortname}
master_sites	${homepage}/distrib/${version}
distname	${shortname}-${version}
use_zip		yes

checksums	md5 41fa8eecc637c8c37b8cfa4d26e7e611

depends_lib	port:ghc

set worksrcpath	${workpath}/${shortname}/source

variant printable_doc {
		  depends_build port:teTeX

		  post-destroot {
		  	cd ${workpath}/${shortname}
			system "latex manual.lat"
			system "latex manual.lat"
			system "latex manual.lat"
			system "dvipdf manual"
			file mkdir ${destroot}${prefix}/share/${shortname}-${version}
			file copy manual.pdf ${destroot}${prefix}/share/${shortname}-${version}/
		  }
		}

configure	{ cd ${worksrcpath}
		  system "runhaskell Setup configure --ghc --prefix=${prefix} --enable-library-profiling"
		}

build		{ cd ${worksrcpath}
		  system "runhaskell Setup build -v"
		}

destroot	{ cd ${worksrcpath}
		  system "runhaskell Setup copy --copy-prefix=${destroot}${prefix}"
                  system "runhaskell Setup register   --gen-script"
                  system "runhaskell Setup unregister --gen-script"

                  file mkdir ${destroot}${prefix}/libexec/${shortname}-${version}
                  file copy ${worksrcpath}/register.sh \
                            ${destroot}${prefix}/libexec/${shortname}-${version}
                  file copy ${worksrcpath}/unregister.sh \
                            ${destroot}${prefix}/libexec/${shortname}-${version}
                 }

post-activate	{ system "${prefix}/libexec/${shortname}-${version}/register.sh" }

#pre-deactivate	{ system "${prefix}/libexec/${shortname}-${version}/unregister.sh" }

