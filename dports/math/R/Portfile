# $Id$

PortSystem 1.0

name             R
version          2.7.0
categories       math science
maintainers      konis@stats.ox.ac.uk
platforms        darwin

description      R is GNU S - an interpreted language for statistical computing

long_description \
    R is a language and environment for statistical computing and graphics. \
    R provides a wide variety of statistical (linear and nonlinear modelling, \
    classical statistical tests, time-series analysis, classification, \
    clustering, ...) and graphical techniques, and is highly extensible.

homepage         http://www.r-project.org/

master_sites     http://cran.us.r-project.org/src/base/R-2/ \
                 http://cran.au.r-project.org/src/base/R-2/ \
                 http://cran.at.r-project.org/src/base/R-2/ \
                 http://cran.hu.r-project.org/src/base/R-2/ \
                 http://cran.r-project.org/src/base/R-2/

checksums        md5    9eaee3eceec1d5f72cea5640ca90768c \
                 sha1   d0a3193e474696ad767845ef6b8ee1555a26b898 \
                 rmd160 c3c9cf0c0a1eb6191492f1be19e277e8223a42c9

depends_lib      port:cairo \
                 port:expat \
                 port:fontconfig \
                 port:freetype \
                 port:gettext \
                 port:glib2 \
                 port:jpeg \
                 port:libiconv \
                 port:libpixman \
                 port:libpng \
                 port:pango \
                 port:readline \
                 port:tcl \
                 port:tk \
                 port:tiff \
                 port:xrender \
                 port:zlib \
                 lib:libX11.6:XFree86

variant gcc42 description {Build with gcc42 (default)} {
    configure.compiler macports-gcc-4.2
    depends_lib-append port:gcc42
}

variant gcc43 description {Build with gcc43} {
    configure.compiler macports-gcc-4.3
    depends_lib-append port:gcc43
}

if {![variant_isset gcc42] && ![variant_isset gcc43]} {
    default_variants +gcc42
}

configure.args   --mandir=\\\${prefix}/share/man \
                 --enable-R-shlib \
                 --with-blas='-framework vecLib' \
                 --with-lapack \
                 --disable-R-framework \
                 --without-aqua \
                 --with-tcl-config=${prefix}/lib/tclConfig.sh \
                 --with-tk-config=${prefix}/lib/tkConfig.sh

test.run         yes
test.target      check
destroot.destdir prefix=${destroot}${prefix}

post-destroot {
  reinplace "s|R_HOME_DIR=${destroot}|R_HOME_DIR=|" \
    "${destroot}${prefix}/bin/R"
  reinplace "s|R_HOME_DIR=${destroot}|R_HOME_DIR=|" \
    "${destroot}${prefix}/lib/R/bin/R"
  reinplace "s|R_SHARE_DIR=${destroot}|R_SHARE_DIR=|" \
    "${destroot}${prefix}/bin/R"
  reinplace "s|R_SHARE_DIR=${destroot}|R_SHARE_DIR=|" \
    "${destroot}${prefix}/lib/R/bin/R"
  reinplace "s|R_INCLUDE_DIR=${destroot}|R_INCLUDE_DIR=|" \
    "${destroot}${prefix}/bin/R"
  reinplace "s|R_INCLUDE_DIR=${destroot}|R_INCLUDE_DIR=|" \
    "${destroot}${prefix}/lib/R/bin/R"
  reinplace "s|R_DOC_DIR=${destroot}|R_DOC_DIR=|" \
    "${destroot}${prefix}/bin/R"
  reinplace "s|R_DOC_DIR=${destroot}|R_DOC_DIR=|" \
    "${destroot}${prefix}/lib/R/bin/R"
  system "install_name_tool -id ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/lib/libR.dylib"
  system "install_name_tool -id ${prefix}/lib/R/modules/R_X11.so \
    ${destroot}${prefix}/lib/R/modules/R_X11.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/modules/R_X11.so"
  system "install_name_tool -id ${prefix}/lib/R/modules/internet.so \
    ${destroot}${prefix}/lib/R/modules/internet.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/modules/internet.so"
  system "install_name_tool -id ${prefix}/lib/R/modules/lapack.so \
    ${destroot}${prefix}/lib/R/modules/lapack.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/modules/lapack.so"
  system "install_name_tool -id ${prefix}/lib/R/modules/vfonts.so \
    ${destroot}${prefix}/lib/R/modules/vfonts.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/modules/vfonts.so"
  system "install_name_tool -id ${prefix}/lib/R/library/tools/libs/tools.so \
    ${destroot}${prefix}/lib/R/library/tools/libs/tools.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/tools/libs/tools.so"
  system "install_name_tool -id ${prefix}/lib/R/library/spatial/libs/spatial.so \
    ${destroot}${prefix}/lib/R/library/spatial/libs/spatial.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/spatial/libs/spatial.so"
  system "install_name_tool -id ${prefix}/lib/R/library/class/libs/class.so \
    ${destroot}${prefix}/lib/R/library/class/libs/class.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/class/libs/class.so"
  system "install_name_tool -id ${prefix}/lib/R/library/lattice/libs/lattice.so \
    ${destroot}${prefix}/lib/R/library/lattice/libs/lattice.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/lattice/libs/lattice.so"
  system "install_name_tool -id ${prefix}/lib/R/library/tcltk/libs/tcltk.so \
    ${destroot}${prefix}/lib/R/library/tcltk/libs/tcltk.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/tcltk/libs/tcltk.so"
  system "install_name_tool -id ${prefix}/lib/R/library/survival/libs/survival.so \
    ${destroot}${prefix}/lib/R/library/survival/libs/survival.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/survival/libs/survival.so"
  system "install_name_tool -id ${prefix}/lib/R/library/stats/libs/stats.so \
    ${destroot}${prefix}/lib/R/library/stats/libs/stats.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/stats/libs/stats.so"
  system "install_name_tool -id ${prefix}/lib/R/library/KernSmooth/libs/KernSmooth.so \
    ${destroot}${prefix}/lib/R/library/KernSmooth/libs/KernSmooth.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/KernSmooth/libs/KernSmooth.so"
  system "install_name_tool -id ${prefix}/lib/R/library/mgcv/libs/mgcv.so \
    ${destroot}${prefix}/lib/R/library/mgcv/libs/mgcv.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/mgcv/libs/mgcv.so"
  system "install_name_tool -id ${prefix}/lib/R/library/methods/libs/methods.so \
    ${destroot}${prefix}/lib/R/library/methods/libs/methods.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/methods/libs/methods.so"
  system "install_name_tool -id ${prefix}/lib/R/library/nlme/libs/nlme.so \
    ${destroot}${prefix}/lib/R/library/nlme/libs/nlme.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/nlme/libs/nlme.so"
  system "install_name_tool -id ${prefix}/lib/R/library/grDevices/libs/grDevices.so \
    ${destroot}${prefix}/lib/R/library/grDevices/libs/grDevices.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/grDevices/libs/grDevices.so"
  system "install_name_tool -id ${prefix}/lib/R/library/foreign/libs/foreign.so \
    ${destroot}${prefix}/lib/R/library/foreign/libs/foreign.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/foreign/libs/foreign.so"
  system "install_name_tool -id ${prefix}/lib/R/library/MASS/libs/MASS.so \
    ${destroot}${prefix}/lib/R/library/MASS/libs/MASS.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/MASS/libs/MASS.so"
  system "install_name_tool -id ${prefix}/lib/R/library/nnet/libs/nnet.so \
    ${destroot}${prefix}/lib/R/library/nnet/libs/nnet.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/nnet/libs/nnet.so"
  system "install_name_tool -id ${prefix}/lib/R/library/grid/libs/grid.so \
    ${destroot}${prefix}/lib/R/library/grid/libs/grid.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/grid/libs/grid.so"
  system "install_name_tool -id ${prefix}/lib/R/library/rpart/libs/rpart.so \
    ${destroot}${prefix}/lib/R/library/rpart/libs/rpart.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/rpart/libs/rpart.so"
  system "install_name_tool -id ${prefix}/lib/R/library/splines/libs/splines.so \
    ${destroot}${prefix}/lib/R/library/splines/libs/splines.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/splines/libs/splines.so"
  system "install_name_tool -id ${prefix}/lib/R/library/cluster/libs/cluster.so \
    ${destroot}${prefix}/lib/R/library/cluster/libs/cluster.so"
  system "install_name_tool -change libR.dylib ${prefix}/lib/R/lib/libR.dylib \
    ${destroot}${prefix}/lib/R/library/cluster/libs/cluster.so"
}

