# $Id$

PortSystem      1.0
name            fftw-3-single
version         3.1.2
revision        1
categories      math
platforms       darwin
maintainers     ram openmaintainer

description     Fast C routines to compute the Discrete Fourier Transform
long_description \
    FFTW is a C subroutine library for computing the \
    Discrete Fourier Transform (DFT) in one or more \
    dimensions, of both real and complex data, and of \
    arbitrary input size. We believe that FFTW, which is \
    free software, should become the FFT library of choice \
    for most applications. Our benchmarks, performed on a \
    variety of platforms, show that FFTW's performance is \
    typically superior to that of other publicly available \
    FFT software. Moreover, FFTW's performance is portable: \
    the program will perform well on most architectures \
    without modification. \
    This port is of fftw version 3.x. It has many \
    improvements relative to 2.x, but is not backwardly \
    compatible.

homepage        http://www.fftw.org/
master_sites    ${homepage} \
                ftp://ftp.fftw.org/pub/fftw/ \
                ftp://ftp.kusastro.kyoto-u.ac.jp/pub/src/GNU/fftw/
distname        fftw-${version}

checksums       md5 08f2e21c9fd02f4be2bd53a62592afa4 \
                sha1 3e4c64009ffb48123a0f30f46c1d89da7810dc67 \
                rmd160 13069b3582eeaa1fba1614cdca2dfbc2e45ab585

depends_lib     port:fftw-3

configure.args --enable-type-prefix \
               --enable-threads \
               --enable-fma \
               --enable-float \
               --disable-fortran \
               --mandir=${prefix}/share/man \
               --infodir=${prefix}/share/info

use_parallel_build yes

platform powerpc {
  configure.args-append --enable-altivec
}

variant fortran conflicts g95 description "Use gfortran-mp-4.2 as fortran compiler" {
  depends_lib-append    port:gcc42
  configure.fc          gfortran-mp-4.2
  configure.args-delete --disable-fortran
  configure.args-append --enable-fortran=gfortran-mp-4.2
}

variant g95 conflicts fortran description "Use g95 as fortran compiler" {
  depends_lib-append    port:g95
  configure.fc          g95
  configure.args-delete --disable-fortran
  configure.args-append --enable-fortran
}

test.run       yes
test.target    check

post-destroot {
  file delete ${destroot}${prefix}/include/fftw3.f
  file delete ${destroot}${prefix}/include/fftw3.h
  file delete ${destroot}${prefix}/bin/fftw-wisdom-to-conf
  file delete ${destroot}${prefix}/share/man/man1/fftw-wisdom-to-conf.1
  file delete ${destroot}${prefix}/share/info/fftw3.info
  file delete ${destroot}${prefix}/share/info/fftw3.info-1
  file delete ${destroot}${prefix}/share/info/fftw3.info-2
  file delete ${destroot}${prefix}/share/info/fftw3.info-3
  file delete ${destroot}${prefix}/share/info/fftw3.info-4
  file delete ${destroot}${prefix}/share/info/fftw3.info-5
}
