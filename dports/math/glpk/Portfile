# $Id$

PortSystem      1.0

name            glpk
version         4.31
categories      math lang
platforms       darwin
maintainers     lutz.horn@fastmail.fm
description     GNU Linear Programming Kit

long_description \
    The GLPK (GNU Linear Programming Kit) package is intended for \
    solving large-scale linear programming (LP), mixed integer \
    programming (MIP), and other related problems. It is a set of \
    routines written in ANSI C and organized in the form of a \
    callable library.

homepage        http://www.gnu.org/software/${name}/
master_sites    gnu

checksums       md5 3f927e94d88151b1330da360d20d4caf \
                sha1 880c66d6d586e92970bfbaf7a57a9d04e7f67fd5 \
                rmd160 59a6ae7bdbb1cd9bc999b57ac6dd950685c48fe5

depends_lib     port:gmp

configure.args  --enable-iodbc=no \
                --enable-mysql=no

test.run        yes
test.target     check

variant examples {
    post-destroot {
        set examplesdir ${destroot}${prefix}/share/doc/${name}/examples
        xinstall -m 755 -d ${examplesdir}
        foreach fl [glob -tails -directory ${worksrcpath}/examples *.{c,mod,lp,mps,dat}] {
            xinstall -m 644 -W ${worksrcpath}/examples $fl ${examplesdir}
        }
        xinstall -m 755 -d ${examplesdir}/sql
        foreach fl [glob -tails -directory ${worksrcpath}/examples/sql *.{mod,sql}] {
            xinstall -m 644 -W ${worksrcpath}/examples/sql $fl ${examplesdir}/sql
        }
    }
}

variant doc {
    depends_build-append path:${prefix}/bin/pdflatex:texlive \
        path:${prefix}/bin/texi2pdf:texinfo
    post-destroot {
        set docdir ${destroot}${prefix}/share/doc/${name}
        xinstall -m 755 -d ${docdir}
        system "cd ${worksrcpath}/doc && ${prefix}/bin/pdflatex glpk.latex && ${prefix}/bin/pdflatex glpk.latex"
        system "cd ${worksrcpath}/doc && ${prefix}/bin/texi2pdf gmpl.texi"
        xinstall -m 644 -W ${worksrcpath}/doc glpk.pdf gmpl.pdf ${docdir}
        xinstall -m 644 -W ${worksrcpath} AUTHORS COPYING ChangeLog INSTALL NEWS README ${docdir}
    }
}

livecheck.check regex
livecheck.url   http://ftp.gnu.org/gnu/${name}/?C=M&O=D
livecheck.regex ${name}-(\\d+\\.\\d+)
