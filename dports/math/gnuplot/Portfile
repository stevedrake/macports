# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem                  1.0
PortGroup                   xcodeversion 1.0

name                        gnuplot
version                     4.4.1
categories                  math science
platforms                   darwin
maintainers                 nomaintainer

description                 A command-driven interactive function plotting program

long_description            Gnuplot is a command-driven interactive function \
                            plotting program. Plots any number of functions, \
                            built up of C operators, C library functions, and \
                            some things C doesn't have like **, sgn(), etc. \
                            Also support for plotting data files, to compare \
                            actual data to theoretical curves.

homepage                    http://gnuplot.sourceforge.net/
master_sites                sourceforge
distfiles-append            ${name}-${version}.pdf
extract.only                ${distname}.tar.gz
checksums                   ${distname}.tar.gz \
                            md5     296e2904363e508bd8cb7e8ea1d267e8 \
                            sha1    d4ac1d57aaf98b5ed72e754c0b5bf4f38e41d3c0 \
                            rmd160  260f42ff776cc4173cf912754d6f2e8b8c424ef6 \
                            ${name}-${version}.pdf \
                            md5     fcae08dc2dc41ebb1607df82bdb186f0 \
                            sha1    75e2769d99872f77bf26a94ab115a299f04bc649 \
                            rmd160  f5dc9ae03d8754c15b0e8e59f7c45badc146f6c1

depends_lib                 port:expat \
                            port:fontconfig \
                            port:gd2 \
                            port:jpeg \
                            port:pdflib \
                            port:libiconv \
                            port:libpng \
                            port:ncurses \
                            port:readline \
                            port:xpm \
                            port:zlib

platform darwin {
    depends_lib-append      port:aquaterm
    configure.cflags-append -DDEFAULTTERM='"aqua"'
}

minimum_xcodeversions       {9 3.1}

configure.args              --with-readline=${prefix} \
                            --with-gd=${prefix} \
                            --with-pdf=${prefix} \
                            --with-png=${prefix} \
                            --with-x \
                            --enable-datastrings \
                            --enable-histograms \
                            --infodir='\${prefix}/share/info' \
                            --mandir='\${prefix}/share/man' \
                            --disable-wxwidgets \
                            --without-latex \
                            --without-tutorial \
                            --without-cairo \
                            --without-lua

configure.ccache            no

variant no_x11 {
    depends_lib-delete      port:xpm
    configure.args-delete   --with-x
    configure.args-append   --without-x
}

variant wxwidgets description "Enable wxWidgets front-end" {
    depends_lib-append      port:wxWidgets
    configure.args-delete   --disable-wxwidgets
    configure.args-append   --with-wx-config=${prefix}/bin/wx-config
}

variant luaterm description "Enable Lua terminal" {
    depends_lib-append      port:lua
    configure.args-delete   --without-lua
    configure.args-append   --with-lua
}

variant tutorial description "Build the tutorial (requires a tex install)" {
    depends_lib-append      bin:tex:texlive
    configure.args-delete   --without-tutorial --without-latex
    configure.args-append   --with-tutorial
}

destroot.destdir            prefix=${destroot}${prefix}

post-destroot {
    xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
    xinstall -m 0644 ${distpath}/${name}-${version}.pdf \
        ${destroot}${prefix}/share/doc/${name}/
}
