# $Id$

PortSystem 1.0

name			gnuplot
version			4.2.3
categories		math science
maintainers		pguyot@kallisys.net
description		A command-driven interactive function plotting program
long_description	Gnuplot is a command-driven interactive function \
					plotting program. Plots any number of functions, \
					built up of C operators, C library functions, and \
					some things C doesn't have like **, sgn(), etc. \
					Also support for plotting data files, to compare \
					actual data to theoretical curves.
platforms		darwin
homepage		http://gnuplot.sourceforge.net/
master_sites	sourceforge
distfiles		${distname}.tar.gz \
				${name}.pdf
extract.only	${distname}.tar.gz
checksums		${distname}.tar.gz \
					md5 6b6d22662df5101b308c465a722c43ce \
					sha1 9f6239ef69ac5a6d68f40dc797f8a0b35b80f491 \
					rmd160 b4692db884c9da2f0d160f33f53c3d2aba65f36e \
				${name}.pdf \
					md5 0691424fd274b65eb8a8ab0dc52dbabe \
					sha1 8926d4cb9a1e2f71f95f69fad65473889f08638f \
					rmd160 6d92f3473b0896598436e6c993e56e5167b94af5

depends_lib		port:expat \
				port:fontconfig \
				port:freetype \
				port:gd2 \
				port:jpeg \
				port:pdflib \
				port:libiconv \
				port:libpng \
				port:ncurses \
				port:readline \
				lib:libX11.6:XFree86 \
				port:zlib

patchfiles		patch-share-LaTeX-Makefile.in

platform darwin {
	depends_lib-append		lib:libaquaterm.1:aquaterm
	configure.cflags-append	'-DDEFAULTTERM=\\"aqua\\"'
}

configure.cppflags-append	"-no-cpp-precomp"
configure.args	--with-readline=gnu --with-gd --with-png --with-pdf --with-x \
				--enable-datastrings --enable-histograms \
				--infodir='\${prefix}/share/info' \
				--mandir='\${prefix}/share/man' \
				--disable-wxwidgets

variant no_x11 {
	depends_lib-delete		lib:libX11.6:XFree86
	configure.args-delete	--with-x
	configure.args-append	--without-x
}

variant wxwidgets {
	depends_lib-append		port:wxWidgets
	configure.args-delete	--disable-wxwidgets
	configure.args-append	--with-wx-config=${prefix}/bin/wx-config
}

variant tutorial description "Build the tutorial (requires a tex install)" {
	depends_lib-append		bin:tex:texlive_base
	configure.args-delete	--without-tutorial
	configure.args-append	--with-tutorial
}

destroot.destdir	prefix=${destroot}${prefix}
post-destroot {
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	xinstall -m 0644 ${distpath}/gnuplot.pdf \
		${destroot}${prefix}/share/doc/${name}/
}
