--- Makefile.orig	2008-01-01 23:53:47.000000000 +0100
+++ Makefile	2008-01-02 11:15:00.000000000 +0100
@@ -1,7 +1,7 @@
 CXX? = g++
-CFLAGS = -Wall -O3 
+CFLAGS = -Wall -O3 -fno-common
 
-all: svm-train svm-predict svm-scale
+all: svm-train svm-predict svm-scale libsvm.a libsvm.dylib
 
 svm-predict: svm-predict.c svm.o
 	$(CXX) $(CFLAGS) svm-predict.c svm.o -o svm-predict -lm
@@ -11,5 +11,14 @@
 	$(CXX) $(CFLAGS) svm-scale.c -o svm-scale
 svm.o: svm.cpp svm.h
 	$(CXX) $(CFLAGS) -c svm.cpp
+libsvm.a: svm.o
+	ar rc libsvm.a svm.o
+	ranlib libsvm.a
+libsvm.dylib: svm.o
+	$(CXX) $(CFLAGS) -dynamiclib -install_name $(PREFIX)/lib/libsvm.dylib \
+                         -current_version $(VERSION) \
+                         -compatibility_version $(VERSION) \
+                         -o libsvm.$(VERSION).dylib svm.o
 clean:
 	rm -f *~ svm.o svm-train svm-predict svm-scale
+	rm -f *.a *.dylib
