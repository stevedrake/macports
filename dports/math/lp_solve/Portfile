# $Id$

PortSystem              1.0

name                    lp_solve
version                 5.5.0.15
set branch              [join [lrange [split ${version} .] 0 1] .]
categories              math
platforms               darwin
maintainers             nomaintainer

description             Linear Programming Solver

long_description        Mixed Integer Linear Programming (MILP) solver. \
                        lp_solve solves pure linear, (mixed) integer/binary, \
                        semi-continuous and special ordered sets (SOS) models. \
                        lp_solve is written in ANSI C and can be compiled on \
                        many different platforms like Mac OS X, Linux and Windows.

homepage                http://lpsolve.sourceforge.net/${branch}/
master_sites            sourceforge:lpsolve
distname                ${name}_${version}_source
worksrcdir              ${name}_${branch}

checksums               md5     2408c94893394f832469661c16b9f0d0 \
                        sha1    e4b80684e8c1fe996b6bc90c01ce5cf022d9ccfe \
                        rmd160  2a7d43c3c0627a49e03f9e1924932f0f0441e011

post-extract {
    xinstall -m 644 ${filespath}/Makefile ${worksrcpath}
}

patchfiles              patch-Wno-long-double.diff \
                        patch-CC.diff

use_configure           no

build.args              CC="${configure.cc} ${configure.cc_archflags}"

destroot {
    switch ${configure.build_arch} {
        x86_64 -
        ppc64 {
            set bits 64
        }
        i386 -
        ppc {
            set bits 32
        }
    }
    xinstall -m 755 -W ${worksrcpath}/lpsolve55/bin/osx${bits} \
        liblpsolve55.a liblpsolve55.dylib ${destroot}${prefix}/lib
    xinstall -m 755 -W ${worksrcpath}/lp_solve/bin/osx${bits} \
        lp_solve ${destroot}${prefix}/bin
    xinstall -m 755 -d ${destroot}${prefix}/include/lpsolve
    eval xinstall -m 644 [glob ${worksrcpath}/*.h] \
        ${destroot}${prefix}/include/lpsolve/
}

