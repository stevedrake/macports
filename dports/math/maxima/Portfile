# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name            maxima
version         5.14.0
revision        1
categories      math
maintainers     nomaintainer
platforms       darwin
description     The Maxima computer algebra system
long_description \
        The Maxima computer algebra system is a descendant \
        of DOE Macsyma, a version of MIT's Macsyma whose \
        development was supported by the U.S. Department of \
        Energy. \
        Through the effort of the late William Shelter of the \
        University of Texas, it was released under the GNU \
        General Public License. It is one of the more \
        comprehensive and powerful computer algebra systems \
        available as open source.

#bugs   The graphical interfaces (xmaxima and the maxima    \
#       session mode of TeXmacs) are still quite immature and   \
#       prone to hang.                      \
#                                   \
#       The not all of the printable documentation can be built \
#       from the top level makefile yet. The printable_doc  \
#       variant builds the reference manual in dvi format and   \
#       forces its installation into                \
#       ${prefix}/share/maxima/<version>/doc/dvi.       \

homepage        http://maxima.sourceforge.net/
master_sites    sourceforge
checksums       md5 8afd0efee916c983d875a396ec405ad2

depends_run     port:sbcl \
                port:tk \
                port:recode \
                port:gnuplot

worksrcdir      ${name}-${version}

configure.args  --infodir=${prefix}/share/info \
                --mandir=${prefix}/share/man \
                --enable-sbcl

variant clisp conflicts darwin i386 description {Use CLISP instead of SBCL for Lisp} {
    depends_build-delete  port:sbcl
    depends_build-append  port:clisp
    configure.args-delete --enable-sbcl
    configure.args-append --enable-clisp
}

default_variants +test

variant test description {Run tests} {
    test.run    yes
    test.target check
}

variant printable_doc description {Build printable documentation} {
    depends_build-append    bin:tex:texlive
    build.target            all pdf

    pre-destroot {
        system "install -d -m 755 ${destroot}${prefix}/share/${name}/${version}/doc/pdf"
        system "install -c -m 644 ${workpath}/${worksrcdir}/doc/info/maxima.pdf ${destroot}${prefix}/share/${name}/${version}/doc/pdf"
    }
}
