# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem			1.0

name                qrupdate
version             1.1.1
categories          math
maintainers         nomaintainer
description         library for fast updates of QR and Cholesky decompositions
long_description \
    a Fortran library for fast updates of QR and Cholesky decompositions
homepage            http://sourceforge.net/projects/${name}/
platforms           darwin
master_sites        sourceforge

checksums           md5     7782c7ee6c234e56a72d6b86c1856fa0 \
                    sha1    8fbaba202b0d4bf80852b2dc6c8d1d4b90b816d4 \
                    rmd160  fd63306abe91adcd5d47e408d9cd4af3e1b32b0c

use_configure       no 
build.target        lib
destroot {
    xinstall -m 644 ${worksrcpath}/lib${name}.a ${destroot}${prefix}/lib
    system "ranlib ${destroot}${prefix}/lib/lib${name}.a"
}

variant g95 conflicts gcc43 gcc44 description {build with g95} {
    depends_build-append    port:g95
    post-patch {
        reinplace "s|Makeconf|Makeconf.g95|" ${worksrcpath}/Makefile
        reinplace "s|Makeconf|Makeconf.g95|" ${worksrcpath}/src/Makefile
    }
}

variant gcc43 conflicts g95 gcc44 description {build with gcc43 fortran} {
    depends_build-append    port:gcc43
    post-patch {
        reinplace "s|gfortran|gfortran-mp-4.3|" ${worksrcpath}/Makeconf
    }
}
variant gcc44 conflicts g95 gcc43 description {build with gcc44 fortran} {
    depends_build-append    port:gcc44
    post-patch {
        reinplace "s|gfortran|gfortran-mp-4.4|" ${worksrcpath}/Makeconf
    }
}

if {![variant_isset gcc43] && ![variant_isset gcc44] && ![variant_isset g95]} {
    default_variants +gcc43
}

