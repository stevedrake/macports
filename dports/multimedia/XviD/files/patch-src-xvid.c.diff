--- src/xvid.c.orig	2009-06-11 09:40:19.000000000 -0700
+++ src/xvid.c	2009-06-11 09:42:45.000000000 -0700
@@ -27,6 +27,10 @@
 #include <stdlib.h>
 #include <string.h>
 #include <time.h>
+#if defined(_WIN32)
+#else
+  #include <unistd.h>
+#endif
 
 #include "xvid.h"
 #include "decoder.h"
@@ -675,8 +679,11 @@
 
 #else
 
-  #include <unistd.h>
+#ifndef _SC_NPROCESSORS_CONF
+  info->num_threads = 1;
+#else
   info->num_threads = sysconf(_SC_NPROCESSORS_CONF);	
+#endif
 
 #endif
 
