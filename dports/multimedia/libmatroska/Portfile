# $Id: Portfile,v 1.5 2005/08/29 08:44:02 pguyot Exp $

PortSystem			1.0
name				libmatroska
version				0.7.7
categories			multimedia
maintainers			pguyot@kallisys.net
description			Matroska is an extensible open standard audio/video container format.
long_description	\
					Matroska is an extensible open standard audio/video container \
					format. This library is there to support this format and has \
					been written by the Matroska project team.
				
homepage			http://www.matroska.org/
platforms			darwin
master_sites		http://dl.matroska.org/downloads/${name}/
checksums			md5 801a81baaa970595b3e9692ec4dd12f9 \
					sha1 2f0f52894bfe25b066704685b4f5e4e741df8ff0
#					rmd160 d08d23fb0333d927909d915fd8623fc51dd52531
use_bzip2			yes

depends_lib			lib:libebml.a:libebml

post-extract {
	cd "${worksrcpath}/make"
	system "cp -R linux darwin"
}

configure			{}

build.dir			${worksrcpath}/make/darwin
build.args			prefix=${prefix} \
					LIBEBML_INCLUDE_DIR=${prefix}/include \
					LIBEBML_LIB_DIR=${prefix}/lib

test.run			yes
test.cmd			./test6 && ./test8 && ./test9
test.target

# We need -p for install because ld will ask for ranlib if the modification date changes.
destroot.args		INSTALL_OPTS_LIB='-m 644 -p'
destroot.destdir	prefix=${destroot}${prefix}
