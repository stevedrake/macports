# $Id$

PortSystem      1.0

name            libtheora
version         1.0beta3
categories      multimedia
platforms       darwin
maintainers     nomaintainer
description     Xiph.org Foundation's open video codec

long_description \
	Theora is an open video codec being developed by the \
	Xiph.org Foundation as part of their Ogg project (It is \
	a project that aims to integrate On2's VP3 video codec, \
	Ogg Vorbis audio codec and Ogg multimedia container \
	formats into a multimedia solution that can compete \
	with MPEG-4 format).

homepage        http://www.theora.org/
master_sites    http://downloads.xiph.org/releases/theora/
use_bzip2       yes

checksums       md5 04b3e1055da49daba6afce93f3214b1f \
                sha1 01f0a5adcdde5bdc5b7e700b5975067af60b456c \
                rmd160 5308039be56064c7a54d464b0dc32f31542a34d8

patchfiles      patch-configure.ac.diff patch-configure.diff

post-patch {
    if {! [variant_isset doc]} {
        reinplace -E "s/^(all|install):.*/\\1:/" \
            ${worksrcpath}/doc/Makefile.in
    }
}

depends_build   port:pkgconfig
depends_lib     port:libvorbis \
                port:libogg

configure.args  --disable-oggtest \
                --disable-vorbistest

post-destroot {
    set docdir ${prefix}/share/doc/${name}-${version}
	if {! [variant_isset doc]} {
		xinstall -d ${destroot}${docdir}
	}
    xinstall -m 0644 -W ${worksrcpath} AUTHORS CHANGES COPYING LICENSE README \
        ${destroot}${docdir}
}

test.run        yes
test.target     check

variant doc description {Install extra documentation} {}

platform darwin 9 i386 {
    # http://trac.macports.org/projects/macports/ticket/13033
    configure.args-append   --disable-asm
}

livecheck.check regex
livecheck.url   ${master_sites}?C=M&O=D
livecheck.regex ${name}-(\\d+(?:\\.\\d+)*(?:\\w+\\d*)?)

