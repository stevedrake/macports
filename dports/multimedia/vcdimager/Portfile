# $Id: Portfile,v 1.5 2005/01/06 03:50:11 blb Exp $

PortSystem			1.0
name				vcdimager
version				0.7.20
revision			3
categories			multimedia
maintainers			blb@pobox.com
description			Free software (Super) video CD authoring solution
long_description \
	The GNU (Super)VideoCD authoring solution for mastering, extracting \
	and analyzing Video CDs and Super Video CDs.

platforms			darwin

homepage			http://www.vcdimager.org/
master_sites		${homepage}pub/vcdimager/vcdimager-0.7_UNSTABLE/ \
					ftp://ftp.vcdimager.org/pub/vcdimager/vcdimager-0.7_UNSTABLE/

checksums			md5 fc36c46e296671f2fc35b6811a1aeb52 \
					sha1 b75c9253bbd9f72f8b64b739e0c15bed5ac83bde

depends_lib			lib:libcdio.0:libcdio

# The patches for lib/info.c, frontends/cli/vcd-info.c, and
# frontends/xml/vcd_xml_rip.c get this to work with libcdio 0.71, as it's
# now current in DP, since the libcdio API changed
patchfiles			patch-libvcdinfo.pc.in patch-lib_image.c \
					patch-lib_info.c patch-frontends_cli_vcd-info.c \
					patch-frontends_xml_vcd_xml_rip.c


post-patch {
	reinplace "s| -Wl,--version-script=libvcdinfo.la.ver||" \
		${worksrcpath}/lib/Makefile.in
}

configure.env		CPPFLAGS="-I${prefix}/include" \
					LDFLAGS="-L${prefix}/lib -framework CoreFoundation \
							-framework IOKit"
configure.args		--infodir=${prefix}/share/info \
					--mandir=${prefix}/share/man \
					--without-cli-frontend --without-xml-frontend

post-destroot {
	xinstall -m 755 -d ${destroot}/${prefix}/share/doc/${name}
	xinstall -m 644 -W ${worksrcpath} AUTHORS BUGS COPYING FAQ HACKING \
		NEWS README THANKS TODO ${destroot}/${prefix}/share/doc/${name}
	file delete -force ${destroot}/${prefix}/share/info/dir
}

variant cliFE {
	depends_lib-append		lib:libpopt:popt
	configure.args-delete	--without-cli-frontend
	configure.args-append	--with-cli-frontend
}

variant xmlFE {
	depends_lib-append		lib:libxml2:libxml2
	configure.args-delete	--without-xml-frontend
	configure.args-append	--with-xml-frontend
}

