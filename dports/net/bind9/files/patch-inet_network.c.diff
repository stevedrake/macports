--- lib/bind/inet/inet_network.c:1.5	Wed Apr 27 04:56:21 2005
+++ lib/bind/inet/inet_network.c	Tue Jan 15 04:02:01 2008
@@ -84,9 +84,9 @@
	}
	if (!digit)
		return (INADDR_NONE);
+	if (pp >= parts + 4 || val > 0xffU)
+		return (INADDR_NONE);
	if (*cp == '.') {
-		if (pp >= parts + 4 || val > 0xffU)
-			return (INADDR_NONE);
		*pp++ = val, cp++;
		goto again;
	}

