# $Id: Portfile,v 1.8 2004/11/07 00:53:54 jkh Exp $

PortSystem 1.0
name             cvsync
version          0.24.14
categories       net
maintainers      toby@opendarwin.org
description      cvsync is a portable CVS repository synchronization utility 
long_description \
    cvsync is a portable CVS repository synchronization utility. \
    cvsync is freely available under the BSD license and is a \
    compelling, if not raw, replacement for CVSup written in C.
homepage         http://www.cvsync.org/
platforms        darwin
master_sites     ftp://ftp.cvsync.org/pub/cvsync/
checksums        md5 82a9e1b99d6fce6bd30d078b0df4ed2d

patch {
    reinplace s|/var/run|$prefix/var/run| $worksrcpath/cvsyncd/main.c
    reinplace s|/var/run|$prefix/var/run| $worksrcpath/cvsyncd/cvsyncd.1
}

configure.cmd    make
configure.pre_args configure
configure.args   HASH_TYPE=openssl \
                 PREFIX=${prefix}
build.args       CVSYNC_DEFAULT_CONFIG=${prefix}/etc/cvsync.conf \
                 CVSYNCD_DEFAULT_CONFIG=${prefix}/etc/cvsyncd.conf
destroot.args    ${build.args}
destroot.destdir PREFIX=${destroot}${prefix} \
                 MANDIR=${destroot}${prefix}/share/man


post-destroot {
    file mkdir ${destroot}${prefix}/share/doc/${name}
    file copy ${worksrcpath}/samples ${destroot}${prefix}/share/doc/${name}
    file mkdir ${destroot}${prefix}/var/run
    destroot.keepdirs ${destroot}${prefix}/var/run
}

post-install {
    ui_msg ""
    ui_msg "You must create two configuration files:"
    ui_msg "  ${prefix}/etc/cvsync.conf"
    ui_msg "  ${prefix}/etc/cvsyncd.conf"
    ui_msg ""
    ui_msg "For examples, see ${prefix}/share/doc/${name}/"
    ui_msg ""
}
