# $Id$

PortSystem          1.0

name                hdhomerun
version             20070423
categories          net multimedia
platforms           darwin

maintainers         ecronin@gizmolabs.org
description         HDHomeRun Software and Firmware
long_description    ${description}
homepage            http://www.silicondust.com

master_sites        http://download.silicondust.com/hdhomerun
distname            lib${name}_${version}
extract.suffix      .tgz
distfiles-append    ${name}_firmware_20070423.bin
extract.only        ${distname}${extract.suffix}
worksrcdir          lib${name}
checksums           ${distname}${extract.suffix} \
                        md5 06a3f5ddfdad5f19672463202f4c62f2 \
                        sha1 94a059a1c0b7a5ff1dc662952422fd2d9e680994 \
                        rmd160 342083addeefd6e43010b276e9e03acac1cd61e2 \
                    ${name}_firmware_20070423.bin \
                        md5 0c5168d9e1b1ad5cd6bcf5d74a922d21 \
                        sha1 13c0f8d1473e68c29ca8cd862e3de49565dd5874 \
                        rmd160 9d1a963a540f59d16231a12f00761198eea0562e

livecheck.check     regex
livecheck.url       http://www.silicondust.com/wiki/downloads
livecheck.regex     libhdhomerun_(\[0-9\]+)\\.tgz
configure { }

build.target         hdhomerun_config

destroot {
    xinstall -m 0755 ${worksrcpath}/hdhomerun_config \
        ${destroot}${prefix}/bin/hdhomerun_config
    xinstall -d -m 0755 ${destroot}${prefix}/share/${name}/
    xinstall -m 0644 ${distpath}/${name}_firmware_20070423.bin \
        ${destroot}${prefix}/share/${name}/${name}_firmware_20070423.bin
}

post-activate {
    ui_msg "to upgrade device firmware run:\n    hdhomerun_config <id> upgrade ${prefix}/share/${name}/${name}_firmware_20070423.bin"
}

