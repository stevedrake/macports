# $Id$

PortSystem          1.0

name                hdhomerun
version             20071015
categories          net multimedia
platforms           darwin

maintainers         ecronin
description         HDHomeRun Software and Firmware
long_description    ${description}
homepage            http://www.silicondust.com

master_sites        http://download.silicondust.com/hdhomerun
distname            lib${name}_${version}
extract.suffix      .tgz
distfiles-append    ${name}_firmware_${version}.bin
extract.only        ${distname}${extract.suffix}
worksrcdir          lib${name}
checksums           ${distname}${extract.suffix} \
                        md5 7d7ed3e4e9a3b64c4a6283fa99de741d \
                        sha1 137b5158dc661ce17f03c70d2784e65b7aa834d2 \
                        rmd160 090c383b760e6deeb8f90e3c2efb116e656b60ec \
                    ${name}_firmware_${version}.bin \
                        md5 0259c2e183d3f19b3af2100d24b5882b \
                        sha1 5d625e0f4b1ad45449341d64b5fb818481c5ab72 \
                        rmd160 26fa5f27ed126d294c5bffa912e9918c99362e69

livecheck.check     regex
livecheck.url       http://www.silicondust.com/wiki/downloads
livecheck.regex     libhdhomerun_(\[0-9\]+)\\.tgz
configure { }

build.target         hdhomerun_config

destroot {
    xinstall -m 0755 ${worksrcpath}/hdhomerun_config \
        ${destroot}${prefix}/bin/hdhomerun_config
    xinstall -d -m 0755 ${destroot}${prefix}/share/${name}/
    xinstall -m 0644 ${distpath}/${name}_firmware_${version}.bin \
        ${destroot}${prefix}/share/${name}/${name}_firmware_${version}.bin
    xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}/
    xinstall -m 0644 ${worksrcpath}/README \
        ${destroot}${prefix}/share/doc/${name}/README
}

post-activate {
    ui_msg "to upgrade device firmware run:"
    ui_msg "     hdhomerun_config <id> upgrade ${prefix}/share/${name}/${name}_firmware_${version}.bin"
}

