# $Id$

PortSystem 1.0
name                lftp
version             3.5.10
categories          net
maintainers         yeled@macports.org
description         Sophisticated file transfer program
long_description    LFTP is a shell-like command line ftp client. \
                    It is reliable: can retry operations and does reget \
                    automatically. It can do several transfers simultaneously \
                    in background. You can start a transfer in background and \
                    continue browsing the ftp site or another one. This all is \
                    done in one process. Background jobs will be completed in \
                    nohup mode if you exit or close modem connection. Lftp has \
                    reput, mirror, reverse mirror among its features.
homepage            http://lftp.yar.ru/
platforms           darwin 

depends_lib         port:expat port:libiconv port:ncurses port:readline

master_sites        ftp://lftp.yar.ru/lftp/ \
                    ftp://lftp.yar.ru/lftp/old/ \
                    ftp://ftp.wiretapped.net/pub/mirrors/${name}/ \
                    ftp://ftp.wiretapped.net/pub/mirrors/${name}/old/ \
                    ftp://ftp.cs.tu-berlin.de/pub/net/ftp/${name}/ \
                    http://ftp.yars.free.net/pub/source/${name}/
use_bzip2           yes
checksums           md5 c09e88fa4f595ac776dc6d307a5e5f21 \
                    sha1 4f2b26ce51356f91278ea0429ac342881a1c6d7f \
                    rmd160 e52cadfa18c9f40bb57a847f99d07d4c7b5ec55f

default_variants    +ssl

configure.env   CPPFLAGS="-I${prefix}/include" \
                LDFLAGS="-L${prefix}/lib"

configure.args  --without-openssl --without-gnutls --disable-nls

pre-configure {
	# look for ncurses first
	reinplace "s|curses ncurses|ncurses curses|g" ${worksrcpath}/configure
}

post-destroot { xinstall -d ${destroot}${prefix}/share/doc/${name}
                xinstall -m 644 -v -W ${worksrcpath} \
                BUGS ChangeLog COPYING FAQ FEATURES NEWS \
                README README.debug-levels README.modules \
		MIRRORS THANKS TODO \
                ${destroot}${prefix}/share/doc/${name}
}

variant ssl conflicts tls {
    configure.args-append --with-openssl --without-gnutls
    configure.args-delete --without-openssl --with-gnutls
    depends_lib-append port:openssl
}

variant tls conflicts ssl {
    configure.args-append --without-openssl --with-gnutls
    configure.args-delete --with-openssl --without-gnutls
    depends_lib-append port:gnutls
}

variant nls {
    patchfiles patch-po-Makefile.in.in
    configure.args-append --enable-nls
    configure.args-delete --disable-nls
    depends_lib-append port:gettext
}
