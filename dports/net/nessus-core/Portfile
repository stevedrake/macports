# $Id: Portfile,v 1.10 2004/10/08 04:11:56 ricci Exp $

PortSystem 1.0
name		nessus-core
version		2.0.12
revision	1
categories	net security
maintainers	opendarwin.org@darkart.com
description	Nessus security scanner
long_description Nessus is a security scanner that crawls across a network, looking \
		for well-known vulnerabilities and common misconfigurations.

homepage	http://www.nessus.org/
platforms	darwin
master_sites	ftp://ftp.nessus.org/pub/nessus/nessus-${version}/src/ \
		ftp://ftp.gwdg.de/pub/linux/misc/nessus/nessus-${version}/src/ \
                http://ftp.gwdg.de/pub/linux/misc/nessus/nessus-${version}/src/ \
                ftp://sunsite.cnlab-switch.ch/mirror/nessus/nessus-${version}/src/ \
                ftp://ftp.chg.ru/pub/security/nessus/nessus-${version}/src/ \
                ftp://ftp.sekure.net/pub/nessus/nessus-${version}/src/

checksums	md5 23017718a25848d3629e57ea2b72a421
worksrcdir      ${name}/
depends_lib     lib:libnessus.${version}:nessus-libraries \
		lib:libnasl.${version}:libnasl	\
		lib:libgtk.2:gtk2

pre-patch       { \
	system "mv ${worksrcpath}/include/includes.h ${worksrcpath}/include/nessus-core-includes.h" \
	}
patchfiles	patch_all_for_includes.h

configure.args  --mandir=\\\${prefix}/share/man \
		--infodir=\\\${prefix}/share/info

## XYZZY: These dirs are not showing up in the receipt,
## so they may not uninstall properly....
pre-install {
	xinstall -d ${prefix}/etc/nessus
	xinstall -d ${prefix}/var/nessus/logs
}

variant no_x11 {
	configure.args-append --disable-gtk
	depends_lib-delete lib:libgtk.2:gtk2
}
