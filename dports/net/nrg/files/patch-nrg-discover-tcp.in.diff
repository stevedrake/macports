--- discoverers/nrg-discover-tcp.in.org	2005-04-30 13:51:02.000000000 -0700
+++ discoverers/nrg-discover-tcp.in	2005-07-22 13:16:34.000000000 -0700
@@ -5,16 +5,16 @@
 
 @all_modes = qw(ftp http imap pop smtp ssh);
 %tests = ( 
-  ftp   => "21 220 \"USER anonymous\" 331",
-  http  => "80 \"\" \"GET / HTTP/1.0\\n\" HTTP",
+  ftp   => "21 220",
+  http  => "80 \"\" \"GET / HTTP/1.\\n\" HTTP",
   imap  => "143 \"\\* OK\" \"CMD NOOP\" \"CMD OK\"",
-  pop   => "110 \"\\+OK\" \"USER nrg\" \"\\+OK\"",
-  smtp  => "25 220 \"HELO nrg\" 250",
-  ssh   => "22 SSH NRG_PROBE \"Protocol mismatch\""
+  pop   => "110 \"\\+OK\"",
+  smtp  => "25 220",
+  ssh   => "22 SSH"
 );
 
 $html_print_template = '@prefix@/templates/discover-tcp.tm';
-$tcpresponse = '@prefix@/bin/nrg-tcpresponse';
+$tcpresponse = '@prefix@/bin/nrg-tcpresponse -t 5';
 
 foreach $i ( 0 .. $#ARGV ) {
   if ( $ARGV[$i] =~ /^-d|^--d|^--debug/ ) {
