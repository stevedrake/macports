# $Id$

PortSystem 1.0

name		pidgin
version		2.4.3
categories	net
maintainers	simon
homepage	http://www.pidgin.im/
description	Multi-protocol Instant Messaging client that allows you to use all of your IM accounts at once.

long_description Pidgin is an Open Source clone of America OnLine's \
		 Instant Messenger client that uses GTK+ version 2.  It \
		 features multiple groups, group chat, user information \
		 fetching and registration, time stamping, and more.  It \
		 also supports other IM protocols, including Yahoo!, \
		 MSN, ICQ, Jabber, Napster, IRC, and Zephyr via included \
		 plugins.
platforms	macosx
master_sites	sourceforge

checksums	md5 9e4a5f4ebda16a51fe91ec610286810a \
		sha1 c967ddda3cb4a8aecfb2566427e8cbd260f2c0de \
		rmd160 c5fa8f3f9e52ffffcc829d08a8b822cd9cdf5368

use_bzip2	yes

depends_lib	port:gtk2 port:libao port:audiofile port:p5-xml-parser port:libxml2 port:nspr port:nss

configure.ldflags-append	-bind_at_load
configure.cppflags-append	-no-cpp-precomp
configure.args	--disable-gtkspell --disable-screensaver --disable-sm \
		--mandir=${prefix}/share/man --disable-perl \
		--with-nss-libs=${prefix}/lib \
		--with-nss-includes=${prefix}/include/nss \
		--with-nspr-libs=${prefix}/lib \
		--with-nspr-includes=${prefix}/include/nspr \
		--enable-nss --disable-consoleui \
		--disable-screensaver \
		--disable-startup-notification \
		--disable-gstreamer \
		--disable-meanwhile \
		--disable-avahi \
		--disable-nm

patchfiles	patch-configure.diff patch-configure.ac.diff

post-activate {
    system "dbus-uuidgen --ensure"
}

variant no_x11 description {Build port without-x} {
	configure.args-append --without-x
}
variant quartz requires no_x11 description {Build port with gtk2 quartz} {
		patchfiles-append gtkdocklet-quartz.diff
		configure.args-append	--disable-gestures \
					--enable-gtkstatusicon
		depends_build	port:automake port:libtool port:autoconf \
				port:intltool
		post-patch {
			reinplace "s|@INTLTOOL_ICONV@|${prefix}/bin/iconv|g" \
				intltool-merge.in
		}
}

