# $Id$

PortSystem          1.0

name                pidgin
version             2.4.3
revision            1
categories          net
platforms           macosx
maintainers         simon openmaintainer
description         Multi-protocol Instant Messaging client
long_description    Pidgin is an Open Source clone of America OnLine's \
                    Instant Messenger client that uses GTK+ version 2.  It \
                    features multiple groups, group chat, user information \
                    fetching and registration, time stamping, and more.  It \
                    also supports other IM protocols, including Yahoo!, MSN, \
                    ICQ, Jabber, Napster, IRC, and Zephyr via included \
                    plugins.

homepage            http://www.pidgin.im/
master_sites        sourceforge
checksums           md5 9e4a5f4ebda16a51fe91ec610286810a \
                    sha1 c967ddda3cb4a8aecfb2566427e8cbd260f2c0de \
                    rmd160 c5fa8f3f9e52ffffcc829d08a8b822cd9cdf5368
use_bzip2           yes

depends_lib         port:audiofile \
                    port:dbus \
                    port:dbus-glib \
                    port:gtk2 \
                    port:libao \
                    port:libxml2 \
                    port:nspr \
                    port:nss \
                    port:p5-xml-parser

patchfiles          patch-configure.diff \
                    patch-configure.ac.diff

configure.args      --disable-avahi \
                    --disable-consoleui \
                    --disable-gstreamer \
                    --disable-gtkspell \
                    --disable-meanwhile \
                    --disable-nm \
                    --disable-perl \
                    --disable-screensaver \
                    --disable-sm \
                    --disable-startup-notification \
                    --enable-nss \
                    --mandir=${prefix}/share/man \
                    --with-nspr-includes=${prefix}/include/nspr \
                    --with-nspr-libs=${prefix}/lib \
                    --with-nss-includes=${prefix}/include/nss \
                    --with-nss-libs=${prefix}/lib
configure.ldflags-append    -bind_at_load
configure.cppflags-append   -no-cpp-precomp

post-activate {
    system "dbus-uuidgen --ensure"
}

variant no_x11 description {Build port without-x} {
    configure.args-append --without-x
}

variant quartz requires no_x11 description {Build port with gtk2 quartz} {
    patchfiles-append       gtkdocklet-quartz.diff

    configure.args-append   --disable-gestures \
                            --enable-gtkstatusicon

    depends_build           port:autoconf \
                            port:automake \
                            port:intltool \
                            port:libtool
    post-patch {
        reinplace "s|@INTLTOOL_ICONV@|${prefix}/bin/iconv|g" intltool-merge.in
    }
}

livecheck.distname  Pidgin
