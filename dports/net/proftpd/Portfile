# $Id: Portfile,v 1.8 2004/10/02 22:57:22 fkr Exp $

PortSystem 1.0
name		proftpd
version		1.2.10
categories	net
maintainers	fkr@opendarwin.org
description	Highly configurable ftp-server.	
long_description	ProFTPD is a highly configurable ftp daemon for unix \
			and unix-like operating systems. ProFTPD is designed \
			to be somewhat of a "drop-in" replacement for wu-ftpd \
			with a configuration format like Apache.	
homepage	http://proftpd.linux.co.uk/	
platforms	darwin freebsd
master_sites	ftp://ftp.proftpd.org/distrib/source/
checksums	md5 5feb4a7348e12faefc25e34fd92efdd6
use_bzip2	yes
depends_run	path:/Library/StartupItems/DarwinPortsStartup:DarwinPortsStartup
configure.args  --sysconfdir=${prefix}/etc --localstatedir=${prefix}/var/run \
		--mandir=${prefix}/share/man

pre-destroot { 	cd ${worksrcpath}
		reinplace "s|nogroup|nobody|g" sample-configurations/basic.conf 
		file mkdir ${destroot}${prefix}/var/run
		file mkdir ${destroot}${prefix}/var/run/proftpd
		system "cd ${destroot}${prefix}/var/run/proftpd/ && touch proftpd.scoreboard"}
		
post-destroot {	file mkdir ${destroot}${prefix}/etc/rc.d
		xinstall -o root -m 755 -v ${portpath}/files/proftpd.sh \
					${destroot}${prefix}/etc/rc.d
                reinplace "s|__PREFIX|${prefix}|g" ${destroot}${prefix}/etc/rc.d/proftpd.sh }

variant mysql {	depends_lib-append      lib:libmysqlclient:mysql
   		configure.args-append   --with-modules=mod_sql:mod_sql_mysql \
					--with-includes=${prefix}/include/mysql \
					--with-libraries=${prefix}/lib/mysql }


variant mysql4 {	
	depends_lib-append      lib:libmysqlclient:mysql4
   	configure.args-append   --with-modules=mod_sql:mod_sql_mysql \
				--with-includes=${prefix}/include/mysql \
				--with-libraries=${prefix}/lib/mysql 
}
