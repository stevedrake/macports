# $Id$

PortSystem          1.0

name                psi
version             0.11
revision            2
categories          net chat
maintainers         rowue@macports.org
description         jabber-based instant messaging client
long_description \
    Psi is a capable Jabber client aimed at experienced users.  Its design \
    goals are simplicity and stability.

platforms           darwin

homepage            http://psi.affinix.com/
master_sites        sourceforge
use_bzip2           yes

checksums           psi-0.11.tar.bz2 md5 6ccc81783eece7959140951289cf5310 \
                    psi-0.11.tar.bz2 sha1 834fac4b51d92e2502cb08d01d40f05ffcdce4a2 \
                    psi-0.11.tar.bz2 rmd160 0e4ce707d7659e02d29b16d6d95a4c4c8ba9850a

depends_lib         lib:libz:zlib \
                    port:qt4-mac


configure.args      --qtdir=${prefix}

destroot {
    xinstall -m 755 -d ${destroot}/Applications/MacPorts
    file copy ${worksrcpath}/src/psi.app ${destroot}/Applications/MacPorts
    system "strip \
        ${destroot}/Applications/MacPorts/psi.app/Contents/MacOS/psi"
}

variant externalqca description {Use external qca} {

configure.args-append   --disable-bundled-qca
depends_lib-append      port:qca-ossl \
                        port:qca-gnupg \
                        port:qca
}


variant plugins description {Build with experimental Plugin Support} {

patchfiles-append   patch-src_about.ui.diff \
                    patch-src_main.cpp.diff \
                    patch-src_main.h.diff \
                    patch-src_opt_plugins.cpp.diff \
                    patch-src_psiaccount.cpp.diff \
                    patch-src_pluginmanager.cpp.diff \
                    patch-src_psiplugin.h.diff \
                    patch-src_pluginmanager.h.diff \
                    patch-configure.diff

configure.args-append   --enable-plugins
}
