# $Id$

PortSystem	      1.0
PortGroup	      python24 1.0

name		      scapy
version		      1.0.5.20
revision	      1
categories	      net security python
maintainers	      pmq@macports.org

description	      A powerful packet manipulation tool
long_description      \
        Scapy is a powerful interactive packet manipulation program. It is \
        able to forge or decode packets of a wide number of protocols, send \
        them on the wire, capture them, match requests and replies, and much \
        more. It can easily handle most classical tasks like scanning, \
        tracerouting, probing, unit tests, attacks or network discovery (it \
        can replace hping, 85% of nmap, arpspoof, arp-sk, arping, tcpdump, \
        tethereal, p0f, etc.). It also performs very well at a lot of other \
        specific tasks that most other tools can't handle, like sending \
        invalid frames, injecting your own 802.11 frames, combining technics \
        (VLAN hopping+ARP cache poisoning, VOIP decoding on WEP encrypted \
        channel, ...), etc.

homepage	      http://www.secdev.org/projects/scapy
master_sites	      ${homepage}/all ${homepage}/files

distfiles	      ${distname}.py ethertypes
checksums	      ${distname}.py \
		          sha1 49f48ba46fc4bb80d14d272a2d33cc70dee03ad8 \
                      	  rmd160 5925b64f1f3cff1dbd11a00e37957952023c94cd \
        	      ethertypes \
		          sha1 6ed0fe2446666876d77b8971fd8edf495a9c0be3 \
                       	  rmd160 296b88fed911b25398b5f657cd6bb5c91e72e288
patchfiles	      patch-scapy.py.diff

depends_lib-append    port:py-readline port:py-pylibpcap port:py-libdnet \
		      port:py-crypto port:py-gnuplot port:py-pyx port:graphviz

extract {
    xinstall -m 775 -d ${worksrcpath}
    file copy ${distpath}/${distname}.py ${worksrcpath}/${name}.py
}

use_configure		no

build {
    # load sensible defaults in case the user has installed other network apps
    reinplace "s|/etc/p0f|${prefix}/share/p0f|" ${worksrcpath}/${name}.py
    reinplace "s|/usr/share/nmap|${prefix}/share/nmap|" ${worksrcpath}/${name}.py
    # there's no queso port, not altering the default queso.conf path
}

destroot  {
    xinstall -m 644 -W ${distpath} ethertypes ${destroot}${prefix}/etc
    xinstall -m 755 -W ${worksrcpath} scapy.py ${destroot}${prefix}/bin
}
