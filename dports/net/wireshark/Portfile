# $Id$

PortSystem 1.0
name		wireshark
version		0.99.6
revision	0
categories	net
maintainers	opendarwin.org@darkart.com
description	Graphical network analyzer and capture tool
homepage	http://wireshark.org/
platforms	darwin

long_description A network analyzer that lets you capture and \
		 interactively browse Ethernet frames. \
		 Packet data can be read from a file, or live from a local \
		 network interface.

master_sites	http://www.wireshark.org/download/src/

checksums	md5	e57a8c8b364c38df3da97e2ee9f0d0bc		\
		sha1	91f57158a75adca36c79c35525eb3cf57b927075	\
		rmd160	7c69e71e54d521d942bcbad9894547d9785f0948

use_bzip2	yes

depends_lib	port:glib2 \
		port:gtk2 \
		port:openssl \
		port:libpcap \
		port:zlib

configure.args	--enable-gtk2 \
		--with-net-snmp=no --with-ucd-snmp=no \
		--disable-usr-local \
		--without-adns \
		--without-pcre \
		--disable-ipv6 \
		--with-pcap=${prefix} \
		--with-ssl=${prefix} \
		--with-zlib=${prefix} \
		--mandir=\\\${prefix}/share/man \
		--infodir=\\\${prefix}/share/info \
		--disable-warnings-as-errors

configure.ldflags-append "-Wl,-search_paths_first"

platform darwin 6 {
	build.env-append	MACOSX_DEPLOYMENT_TARGET=10.2
	configure.env-append	MACOSX_DEPLOYMENT_TARGET=10.2
}

platform darwin 7 {
	build.env-append	MACOSX_DEPLOYMENT_TARGET=10.3
	configure.env-append	MACOSX_DEPLOYMENT_TARGET=10.3
}

platform darwin 8 {
	build.env-append	MACOSX_DEPLOYMENT_TARGET=10.4
	configure.env-append	MACOSX_DEPLOYMENT_TARGET=10.4
}

platform darwin 9 {
	build.env-append	MACOSX_DEPLOYMENT_TARGET=10.5
	configure.env-append	MACOSX_DEPLOYMENT_TARGET=10.5
}

variant adns {
	configure.args-append	--with-adns=${prefix}
	configure.args-delete	--without-adns
	depends_lib-append	port:adns
}

variant gnutls {
	configure.args-append	--with-libgnutls-prefix=${prefix}
	depends_lib-append	port:gnutls
}

variant ipv6 {
	configure.args-append	--enable-ipv6
	configure.args-delete	--disable-ipv6
}

variant net_snmp {
	configure.args-append	--with-net-snmp=${prefix}/bin/net-snmp-config
	configure.args-delete	--with-net-snmp=no
	depends_lib-append	port:net-snmp
}

variant pcre {
	configure.args-append	--with-pcre=${prefix}
	configure.args-delete	--without-pcre
	depends_lib-append	lib:libpcre:pcre
}

variant no_ssl {
	configure.args-append --without-ssl
	depends_lib-delete	port:openssl
}

variant no_x11	{
	depends_lib-delete	port:gtk2
	configure.args-delete	--disable-gtk2
	configure.args-append	--disable-wireshark
}

#
##EOF
