 # $Id: Portfile 20367 2006-11-02 18:31:04Z blair@macports.org $

PortSystem                      1.0
PortGroup                       perl5 1.0
perl5.setup                     CGI-SpeedyCGI 2.22

maintainers                     nomaintainer@macports.org
description                     Speed up perl CGI scripts by running them persistently
long_description                SpeedyCGI is a way to run perl scripts persistently, \
				which can make them run much more quickly. A script \
				can be made to to run persistently by changing the \
				interpreter line at the top of a script from: \
				  '#!/_prefix_/bin/perl' to '#!/_prefix_/bin/speedy'

platforms                       darwin
checksums                       md5 2f80df78874e3efa80f180923c4967a1

patchfiles			patch-Makefile.PL \
				patch-mod_speedycgi2.c \
				patch-src--SpeedyMake.pl \
				patch-src_speedy_main.c \
				patch-src-speedy_perl.h

variant apache2 {
	depends_lib-append	port:apache2
}

post-patch {
if { [variant_isset apache2]} {
	reinplace "s|apxs -q|${prefix}/apache2/bin/apxs -q|g" \
		${worksrcpath}/src/SpeedyMake.pl \
		${worksrcpath}/Makefile.PL
}
}

post-destroot {
	xinstall -m 4755 ${worksrcpath}/speedy/speedy ${destroot}${prefix}/bin/speedy_suidperl
}
