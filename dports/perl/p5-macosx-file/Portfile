# $Id: Portfile,v 1.1 2004/03/12 05:44:32 rshaw Exp $
PortSystem 1.0

name			p5-macosx-file
version			0.66
categories		perl sysutils
maintainers		rshaw@opendarwin.org
description		A collection of Perl modules to manipulate files on MacOS X
long_description	MacOSX::File is a collection of Perl modules that \
					allows you to do what binaries in /Developer/Tools \
					allows you to do directly via perl. You can \
					implement your own CpMac, MvMac, GetFileInfo and \
					SetFile without calling these binaries.
set perl_module	MacOSX-File
homepage		http://search.cpan.org/dist/${perl_module}/
master_sites	http://www.cpan.org/modules/by-authors/id/D/DA/DANKOGAI/
distname		${perl_module}-${version}
dist_subdir		perl5
checksums		md5 73f57106bf39ccb65ff1e4ce5b6bc2ea
platforms		darwin

# Use Perl from DarwinPorts explicitly 
set perl		${prefix}/bin/perl
set perllib		[lindex [glob -nocomplain ${prefix}/lib/perl5/5.8*] end]
if {[catch {set perlarch [lindex [split [exec ${perl} -V:archname] {'}] 1]}]} {
	set perlarch	${os.platform}
}
set perlarchlib	${perllib}/${perlarch}

depends_build	path:${perl}:perl5.8

# Depends on these Perl modules
# none

platform darwin 7 {
	patchfiles		patch-macosx-file.panther
}
post-patch {
	reinplace "s|/usr/local|${prefix}|g" ${worksrcpath}/Makefile.PL
}

configure.cmd		${perl}
configure.pre_args	Makefile.PL
configure.args		INSTALLDIRS=perl

test.run			yes

destroot.target		pure_install
post-destroot {
	foreach packlist [exec find ${destroot}${perllib} -name .packlist] {
		ui_info "Fixing packlist ${packlist}"
		reinplace "s|${destroot}||" ${packlist}
	}
}

