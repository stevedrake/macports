# $Id$
PortSystem 1.0
PortGroup perl5 1.0

perl5.setup		Mail-SpamAssassin 3.2.0
maintainers		nomaintainer@macports.org
categories-append	mail
description		mail filter to identify spam
long_description	SpamAssassin(tm) is a mail filter to identify spam. \
					Using its rule base, it uses a wide range of \
					heuristic tests on mail headers and body text to \
					identify spam, also known as unsolicited commercial \
					email.
homepage               http://spamassassin.apache.org/
# when updated to the latest version master_sites can be removed:
master_sites           http://archive.apache.org/dist/spamassassin/
checksums		md5 aed988bb6cf463afc868a64d4cd771a3
platforms		darwin

# Depends on these Perl modules
depends_lib-append	port:p5-digest-sha1 \
					port:p5-html-parser \
					port:p5-mailtools \
					port:p5-mail-audit \
					port:p5-net-dns \
					port:p5-net-ident \
					port:p5-archive-tar \
					port:p5-lwp-authen-wsse

startupitem.create      yes
startupitem.name        spamd
startupitem.executable  "${prefix}/bin/spamd"

post-patch {
	reinplace "s|return ''|return 'PRIV'|" ${worksrcpath}/Makefile.PL
}

set datadir		${prefix}/share/spamassassin
set confdir		${prefix}/etc/mail/spamassassin
set statedir		${prefix}/var

configure.args-append	CONTACT_ADDRESS=root@localhost \
						PREFIX=${prefix} \
						SYSCONFDIR=${prefix}/etc \
						DATADIR=${datadir} \
						LOCALSTATEDIR=${statedir} \
						CONFDIR=${confdir}

variant	razor {
	depends_lib-append		port:p5-razor-agents
	configure.args-append		RUN_RAZOR_TESTS=yes
}

variant	ssl {
	depends_lib-append		port:openssl \
					port:p5-io-socket-ssl
	configure.args-append		ENABLE_SSL=yes
}

variant bayes {
	depends_lib-append		port:p5-db_file
}

destroot.target-append	conf__install data__install
