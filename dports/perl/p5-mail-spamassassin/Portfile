# $Id$
PortSystem 1.0
PortGroup perl5 1.0


perl5.setup         Mail-SpamAssassin 3.2.3
maintainers         macports.org:simon
categories-append   mail
description         mail filter to identify spam
long_description    SpamAssassin(tm) is a mail filter to identify spam. \
                    Using its rule base, it uses a wide range of \
                    heuristic tests on mail headers and body text to \
                    identify spam, also known as unsolicited commercial \
                    email.
homepage            http://spamassassin.apache.org/
platforms           darwin

checksums           md5 2e356b70b9458b44a828c19f6e816521 \
                    sha1 93337a5cf6cc6f4980307c08ad65575fa08d1f54 \
                    rmd160 776ad00e8e23d31e9f5d563649d65c8e16a2de89

depends_lib-append  port:p5-digest-sha1 \
                    port:p5-html-parser \
                    port:p5-mailtools \
                    port:p5-mail-audit \
                    port:p5-net-dns \
                    port:p5-net-ident \
                    port:p5-archive-tar \
                    port:p5-lwp-authen-wsse

startupitem.create      yes
startupitem.name        spamd
startupitem.executable  "${prefix}/bin/spamd"

post-patch {
    reinplace "s|return ''|return 'PRIV'|" ${worksrcpath}/Makefile.PL
}

configure.args-append   CONTACT_ADDRESS=root@localhost \
                        PREFIX=${prefix} \
                        SYSCONFDIR=${prefix}/etc \
                        DATADIR=${prefix}/share/spamassassin \
                        LOCALSTATEDIR=${prefix}/var/spamassassin \
                        CONFDIR=${prefix}/etc/mail/spamassassin

variant razor {
    depends_lib-append      port:p5-razor-agents
    configure.args-append   RUN_RAZOR_TESTS=yes
}


variant ssl {
    depends_lib-append      port:openssl \
                            port:p5-io-socket-ssl
    configure.args-append   ENABLE_SSL=yes
}

variant bayes {
    depends_lib-append      port:p5-db_file
}

destroot.target-append      conf__install data__install
