# $Id: Portfile,v 1.1 2004/03/12 05:44:33 rshaw Exp $
PortSystem 1.0

name			p5-mimetools
version			5.411a
categories		perl
maintainers		rshaw@opendarwin.org
description		modules for parsing (and creating!) MIME entities
long_description	MIME-tools is a collection of Perl5 MIME:: modules \
					for parsing, decoding, *and generating* single- or \
					multipart (even nested multipart) MIME messages. \
					(Yes, kids, that means you can send messages with \
					attached GIF files).
set perl_module	MIME-tools
homepage		http://search.cpan.org/dist/${perl_module}/
master_sites	perl_cpan:MIME
distname		${perl_module}-${version}
dist_subdir		perl5
worksrcdir		${perl_module}-[strsed ${version} {g/[a-z]//}]
checksums		md5 e7cb1f8e146171103640e3a5516afb1a
platforms		darwin

# Use Perl from DarwinPorts explicitly 
set perl		${prefix}/bin/perl
set perllib		[lindex [glob -nocomplain ${prefix}/lib/perl5/5.8*] end]
if {[catch {set perlarch [lindex [split [exec ${perl} -V:archname] {'}] 1]}]} {
	set perlarch	${os.platform}
}
set perlarchlib	${perllib}/${perlarch}

depends_build	path:${perl}:perl5.8

# Depends on these Perl modules
depends_lib		path:${perllib}/IO/Stringy.pm:p5-io-stringy \
				path:${perllib}/File/Spec.pm:perl5.8 \
				path:${perllib}/Mail/Header.pm:p5-mailtools \
				path:${perlarchlib}/MIME/QuotedPrint.pm:perl5.8 \
				path:${perllib}/Mail/Field.pm:p5-mailtools \
				path:${perlarchlib}/MIME/Base64.pm:perl5.8 \
				path:${perllib}/File/Path.pm:perl5.8 \
				path:${perllib}/Mail/Internet.pm:p5-mailtools

configure.cmd		${perl}
configure.pre_args	Makefile.PL
configure.args		INSTALLDIRS=perl

test.run			yes

destroot.target		pure_install
post-destroot {
	foreach packlist [exec find ${destroot}${perllib} -name .packlist] {
		ui_info "Fixing packlist ${packlist}"
		reinplace "s|${destroot}||" ${packlist}
	}
}

