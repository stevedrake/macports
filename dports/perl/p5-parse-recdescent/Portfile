# $Id: Portfile,v 1.1 2004/03/12 05:44:34 rshaw Exp $
PortSystem 1.0

name			p5-parse-recdescent
version			1.94
categories		perl
maintainers		rshaw@opendarwin.org
description		Generate Recursive-Descent Parsers
long_description	RecDescent incrementally generates top-down \
					recursive-descent text parsers from simple yacc-like \
					grammar specifications. It provides: \
					* Regular expressions or literal strings as \
					terminals (tokens), \
					* Multiple (non-contiguous) productions for any rule, \
					* Repeated, optional and alternate subrules within \
					productions, \
					* Late-bound (run-time dispatched) subrules \
					* Full access to Perl within actions specified as \
					part of the grammar, \
					* Simple automated error reporting during parser \
					generation and parsing, \
					* The ability to commit to, uncommit to, or reject \
					particular productions during a parse, \
					* Incremental extension of the parsing grammar (even \
					during a parse), \
					* Precompilation of parser objects, \
					* User-definable reduce-reduce conflict resolution \
					via "scoring" of matching productions. \
					See the file "RecDescent.pod" for excruciating \
					detail on all of this.
set perl_module	Parse-RecDescent
homepage		http://search.cpan.org/dist/${perl_module}/
master_sites	perl_cpan:Parse
distname		${perl_module}-${version}
dist_subdir		perl5
checksums		md5 497600b337a501eae11f31195ccec9d4
platforms		darwin

# Use Perl from DarwinPorts explicitly 
set perl		${prefix}/bin/perl
set perllib		[lindex [glob -nocomplain ${prefix}/lib/perl5/5.8*] end]
if {[catch {set perlarch [lindex [split [exec ${perl} -V:archname] {'}] 1]}]} {
	set perlarch	${os.platform}
}
set perlarchlib	${perllib}/${perlarch}

depends_build	path:${perl}:perl5.8

# Depends on these Perl modules
depends_lib		path:${perllib}/Text/Balanced.pm:perl5.8

configure.cmd		${perl}
configure.pre_args	Makefile.PL
configure.args		INSTALLDIRS=perl

test.run			yes

destroot.target		pure_install
post-destroot {
	foreach packlist [exec find ${destroot}${perllib} -name .packlist] {
		ui_info "Fixing packlist ${packlist}"
		reinplace "s|${destroot}||" ${packlist}
	}
}

