# $Id$

PortSystem                  1.0
PortGroup                   perl5 1.0

epoch                       1
perl5.setup                 PerlMagick 6.7.2-0
set reasonable_version      [lindex [split ${version} -] 0]
set my_name                 ImageMagick
maintainers                 futurelab.ch:astricker
description                 Perl extension for calling ImageMagick's libMagick methods
long_description            ${description}
license                     ImageMagick
platforms                   darwin
use_7z                      yes

# we use the ImageMagick distribution version of PerlMagick to
# ensure it will always match ImageMagick version installed

master_sites                http://image_magick.veidrodis.com/image_magick/ \
                            http://imagemagick.linux-mirror.org/download/ \
                            ftp://ftp.imagemagick.net/pub/${name}/ \
                            ftp://ftp.fifi.org/pub/ImageMagick/

dist_subdir                 ImageMagick
distname                    ${my_name}-${version}
worksrcdir                  ${worksrcdir}/PerlMagick

checksums                   sha1    e270e3c91d20cb97194c383014b5efe0355cda2f \
                            rmd160  34aa79058170bd94db7dd635e8b7760e5bc88cf7
 
if {${perl5.major} != ""} {
depends_lib-append          port:ImageMagick
post-patch {
    if {[variant_isset universal]} {
        set archflags ${configure.universal_cflags}
    } else {
        set archflags ${configure.cc_archflags}
    }
    reinplace "s|@ARCHFLAGS@|${archflags}|g" ${worksrcpath}/Makefile.PL
    reinplace "s|@PREFIX@|${prefix}|g" ${worksrcpath}/Makefile.PL
}
}

livecheck.version           ${reasonable_version}
livecheck.type              regex
livecheck.url               http://ftp.surfnet.nl/pub/ImageMagick/
livecheck.regex             ${name}-(\\d+(?:\\.\\d+)*)(?:-\\d+)?
