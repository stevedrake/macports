# $Id: Portfile,v 1.1 2005/08/16 04:47:27 pguyot Exp $

PortSystem			1.0
name            	dvipdfmx
version         	20050815
description     	Multi-byte aware replacement for dvipdf
long_description	The DVIPDFMx project provides an eXtended version of the \
					dvipdfm, a DVI format to PDF translator developed by Mark \
					A. Wicks. The primary goal of this project is to support \
					multi-byte character encodings and large character sets \
					for East Asian languages by CID-keyed font technology. The \
					secondary goal is to support as many features as pdfTeX \
					developed by Hàn Thê Thành. This project is a combined \
					work of the dvipdfm-jpn project by Shunsaku Hirata and \
					its modified one, dvipdfm-kor by Jin-Hwan Cho. \
					\
					This port includes Omega font metric for Japanese Adobe \
					fonts.
platforms       	darwin
categories      	print
maintainers     	pguyot@kallisys.net
homepage			http://project.ktug.or.kr/dvipdfmx/
master_sites		${homepage}snapshot/current/:dvipdfmx \
					http://oku.edu.mie-u.ac.jp/~okumura/texfaq/japanese/:omrml
distfiles			[suffix ${distname}]:dvipdfmx \
					omrml.ofm:omrml
checksums			[suffix ${distname}] \
						md5 3ce511bd5223e142f28d9c386f2e6d84 \
						sha1 ffec958917dbb4896f7e6b14d940a207a7b35ab5 \
					omrml.ofm \
						md5 20802bf39ec990eadb9e349c64a47595 \
						sha1 eb91eb976a645f5975edfb27d9e3026728954c06
patchfiles			patch-data-config-cid-x.map
depends_lib			lib:libkpathsea:teTeX \
					lib:libpng:libpng \
					lib:libz:zlib
depends_run			port:ghostscript
configure.env		CFLAGS=-I${prefix}/include \
					LDFLAGS=-L${prefix}/lib

# only extract the tarball.
extract.only [suffix ${distname}]

post-destroot {
	# copy omrml.ofm where it belongs (as omrml.ofm & omgbm.ofm)
	file mkdir ${destroot}${prefix}/share/texmf-dist/fonts/ofm/public/japanese/
	xinstall ${distpath}/omrml.ofm \
		${destroot}${prefix}/share/texmf-dist/fonts/ofm/public/japanese/
	xinstall ${distpath}/omrml.ofm \
		${destroot}${prefix}/share/texmf-dist/fonts/ofm/public/japanese/omgbm.ofm
	# copy ghostscript encodings
	foreach encoding [glob ${prefix}/share/ghostscript/*/Resource/CMap/*] {
		set name [file tail $encoding]
		if {![file exists ${destroot}${prefix}/share/texmf/dvipdfm/CMap/$name]} {
			xinstall $encoding ${destroot}${prefix}/share/texmf/dvipdfm/CMap/
		}
	}
}
post-activate {
	system "mktexlsr"
}