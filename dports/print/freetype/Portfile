# $Id$

PortSystem          1.0

name                freetype
version             2.3.5
revision            1
categories          print graphics
maintainers         ryandesign
homepage            http://freetype.sourceforge.net/
use_bzip2           yes
platforms           darwin

description \
	A software font engine

long_description \
	FreeType2 is a software font engine that is designed to \
	be small, efficient, highly customizable and portable while \
	capable of producing high-quality output (glyph images). \
	It can be used in graphics libraries, display servers, font \
	conversion tools, text image generation tools, and many \
	other products as well.

master_sites \
	http://download.savannah.gnu.org/releases/freetype/ \
	sourceforge

set docdistfile \
	${name}-doc-${version}

checksums \
	[suffix ${distname}] \
		md5 65234327c5ac46ee00ebda15995d4c1c \
		sha1 45695d44c74be31944d807526a7e69a818e4afd2 \
		rmd160 2a97cb1c3d93572c094d5d2890d12445ef2786d4 \
	[suffix ${docdistfile}] \
		md5 8f443368764f7cd776749e0143f423dd \
		sha1 a3edb74195eee9384d0463104edde4881d73a308 \
		rmd160 d0a5cbe51eceb6c4a3a8eaaf4e3d99c2ca02266f

patchfiles \
	patch-modules.cfg.diff

depends_lib \
	port:zlib

configure.args \
	--with-old-mac-fonts

configure.universal_ldflags-append \
	-isysroot ${sysroot}

set docdir \
	${prefix}/share/doc/${name}-${version}

post-destroot {
	xinstall -m 0755 -d ${destroot}${docdir}
	
	xinstall -m 0644 -W ${worksrcpath} ChangeLog README ${destroot}${docdir}
	xinstall -m 0644 -W ${worksrcpath}/docs CHANGES FTL.TXT GPL.TXT LICENSE.TXT \
		PATENTS PROBLEMS TODO formats.txt raster.txt ${destroot}${docdir}
}

variant bytecode description {Build bytecode interpreter into the TrueType driver} {
	pre-configure {
		ui_msg "\n\n\
			You may want not to compile a bytecode interpreter into the\n\
			TrueType driver. Without this you will only compile the code\n\
			necessary to load TrueType glyphs without hinting.\n\n\
			Note that there are important patent issues related to the\n\
			use of the interpreter.\n\n"
	}
	patchfiles-append \
		patch-ftoption.h
	
	post-destroot {
		xinstall -m 0644 -W ${worksrcpath}/docs TRUETYPE ${destroot}${docdir}
	}
}

variant doc description {Install extra documentation} {
	distfiles-append [suffix ${docdistfile}]
	
	post-destroot {
		xinstall -m 0755 -d ${destroot}${docdir}/html
		xinstall -m 0644 -W ${worksrcpath}/docs ft2faq.html ${destroot}${docdir}/html
		
		foreach dir {design glyphs reference tutorial} {
			xinstall -m 0755 -d ${destroot}${docdir}/html/${dir}
			eval xinstall -m 0644 [glob ${worksrcpath}/docs/${dir}/*.*] \
				${destroot}${docdir}/html/${dir}
		}
	}
}

livecheck.check     sourceforge
livecheck.distname  ${name}[strsed ${version} {s/\..*//}]
