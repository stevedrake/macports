# $Id$

PortSystem              1.0

name                    freetype
version                 2.3.6
categories              print graphics
maintainers             ryandesign
homepage                http://freetype.sourceforge.net/
use_bzip2               yes
platforms               darwin

description \
    A software font engine

long_description \
    FreeType2 is a software font engine that is designed to \
    be small, efficient, highly customizable and portable while \
    capable of producing high-quality output (glyph images). \
    It can be used in graphics libraries, display servers, font \
    conversion tools, text image generation tools, and many \
    other products as well.

master_sites \
    http://download.savannah.gnu.org/releases/freetype/ \
    sourceforge

set docdistfile \
    ${name}-doc-${version}

checksums \
    [suffix ${distname}] \
        md5 fb182d508017cb608e9df8c7dca648dc \
        sha1 611bae913e8a593449a4dc60e0bf3300abc4f974 \
        rmd160 8047e734804191856a941e19f6acf82047099d66 \
    [suffix ${docdistfile}] \
        md5 f39aa6954d71193d2b62fab89a28b50d \
        sha1 0129f5ea7a6efe73d74a62f89a89ced17b042806 \
        rmd160 7c8ad54d46a9f22ca04d95a15ee21281451e96f7

patchfiles \
    patch-modules.cfg.diff

depends_lib \
    port:zlib

configure.args \
    --with-old-mac-fonts

configure.universal_ldflags-append \
    -isysroot ${sysroot}

set docdir \
    ${prefix}/share/doc/${name}-${version}

post-destroot {
    xinstall -m 0755 -d ${destroot}${docdir}
    
    xinstall -m 0644 -W ${worksrcpath} \
        ChangeLog \
        README \
        ${destroot}${docdir}
    xinstall -m 0644 -W ${worksrcpath}/docs \
        CHANGES \
        FTL.TXT \
        GPL.TXT \
        LICENSE.TXT \
        PATENTS \
        PROBLEMS \
        TODO \
        formats.txt \
        raster.txt \
        ${destroot}${docdir}
}

variant bytecode description {Build bytecode interpreter into the TrueType driver} {
    pre-configure {
        ui_msg "\n\n\
            You may want not to compile a bytecode interpreter into the\n\
            TrueType driver. Without this you will only compile the code\n\
            necessary to load TrueType glyphs without hinting.\n\n\
            Note that there are important patent issues related to the\n\
            use of the interpreter.\n\n"
    }
    patchfiles-append \
        patch-ftoption.h
    
    post-destroot {
        xinstall -m 0644 -W ${worksrcpath}/docs TRUETYPE ${destroot}${docdir}
    }
}

variant doc description {Install extra documentation} {
    distfiles-append [suffix ${docdistfile}]
    
    post-destroot {
        xinstall -m 0755 -d ${destroot}${docdir}/html
        xinstall -m 0644 -W ${worksrcpath}/docs ft2faq.html ${destroot}${docdir}/html
        
        foreach dir {design glyphs reference tutorial} {
            xinstall -m 0755 -d ${destroot}${docdir}/html/${dir}
            eval xinstall -m 0644 [glob ${worksrcpath}/docs/${dir}/*.*] \
                ${destroot}${docdir}/html/${dir}
        }
    }
}

livecheck.check         sourceforge
livecheck.distname      ${name}[strsed ${version} {s/\..*//}]
