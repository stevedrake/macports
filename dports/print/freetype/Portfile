# $Id$

PortSystem          1.0

name                freetype
version             2.3.4
revision            1
categories          print graphics
maintainers         ryandesign@macports.org openmaintainer@macports.org
homepage            http://freetype.sourceforge.net/
use_bzip2           yes
platforms           darwin

description \
	A software font engine

long_description \
	FreeType2 is a software font engine that is designed to \
	be small, efficient, highly customizable and portable while \
	capable of producing high-quality output (glyph images). \
	It can be used in graphics libraries, display servers, font \
	conversion tools, text image generation tools, and many \
	other products as well.

master_sites \
	http://download.savannah.gnu.org/releases/freetype/ \
	sourceforge

set docdistfile ${name}-doc-${version}

checksums \
    [suffix ${distname}] \
    	md5 1a6c59a7723d637c78672e7784da865d \
	    sha1 09b8f5ecbb3e06a14cc1c2f2dc7c04fe34c48eca \
	    rmd160 23b641c0b6e6102449e6f2512a131743d8836321 \
    [suffix ${docdistfile}] \
        md5 40cb37ba6c003845208c1b89cf507249 \
        sha1 48e59931b0b6909420a26f6901542efc820fe435 \
        rmd160 73e0f29dacd7a0d093518a3795bb0de18128f81e

patchfiles \
	patch-modules.cfg.diff

depends_lib \
	port:zlib

set docdir      ${prefix}/share/doc/${name}-${version}

post-destroot {
    xinstall -m 0755 -d ${destroot}${docdir}

    xinstall -m 0644 -W ${worksrcpath} ChangeLog README ${destroot}${docdir}
    xinstall -m 0644 -W ${worksrcpath}/docs CHANGES FTL.TXT GPL.TXT LICENSE.TXT PATENTS PROBLEMS \
        TODO formats.txt raster.txt ${destroot}${docdir}
}

variant bytecode description {Build bytecode interpreter into the TrueType driver} {
	pre-configure {
		ui_msg "\n\n\
			You may want not to compile a bytecode interpreter into the\n\
			TrueType driver. Without this you will only compile the code\n\
			necessary to load TrueType glyphs without hinting.\n\n\
			Note that there are important patent issues related to the\n\
			use of the interpreter.\n\n"
	}
	patchfiles-append patch-ftoption.h

    post-destroot {
        xinstall -m 0644 -W ${worksrcpath}/docs TRUETYPE ${destroot}${docdir}
    }
}

variant doc description {Install extra documentation} {
    distfiles-append [suffix ${docdistfile}]

    post-destroot {
        xinstall -m 0755 -d ${destroot}${docdir}/html
        xinstall -m 0644 -W ${worksrcpath}/docs ft2faq.html ${destroot}${docdir}/html

        foreach dir {design glyphs reference tutorial} {
            xinstall -m 0755 -d ${destroot}${docdir}/html/${dir}

            eval xinstall -m 0644 [glob ${worksrcpath}/docs/${dir}/*.*] \
                ${destroot}${docdir}/html/${dir}
        }
    }
}

livecheck.distname  ${name}[strsed ${version} {s/\..*//}]
