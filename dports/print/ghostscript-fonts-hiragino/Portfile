# $Id$

PortSystem      1.0
name            ghostscript-fonts-hiragino
version         8.60
revision        1
categories      print japanese
maintainers     takanori@macports.org
description     Japanese Hiragino fonts for ghostscript ${version}
long_description \
                ${description}
platforms       macosx
homepage
master_sites
distfiles
depends_lib     port:ghostscript

configure {}
build {}
destroot {
    if {[variant_isset darwin_9]} {
        set SystemLibraryFontsDir /Library/Fonts
    } else {
        set SystemLibraryFontsDir /System/Library/Fonts
    }
    set GSFontDir ${destroot}${prefix}/share/ghostscript/fonts/Resource/Font
    set GSCIDFontDir ${destroot}${prefix}/share/ghostscript/${version}/Resource/CIDFont
    set FontList {"ヒラギノ角ゴ Pro W3.otf" HiraKakuPro-W3 {GothicBBB-Medium}
                  "ヒラギノ角ゴ Pro W6.otf" HiraKakuPro-W6 {FutoGoB101-Bold}
                  "ヒラギノ角ゴ Std W8.otf" HiraKakuStd-W8 {}
                  "ヒラギノ丸ゴ Pro W4.otf" HiraMaruPro-W4 {Jun101-Light}
                  "ヒラギノ明朝 Pro W3.otf" HiraMinPro-W3 {Ryumin-Light}
                  "ヒラギノ明朝 Pro W6.otf" HiraMinPro-W6 {FutoMinA101-Bold}}
    set EncodeList {78-EUC-H
                    78-EUC-V
                    78-H
                    78-RKSJ-H
                    78-RKSJ-V
                    78-V
                    78ms-RKSJ-H
                    78ms-RKSJ-V
                    83pv-RKSJ-H
                    90ms-RKSJ-H
                    90ms-RKSJ-UCS2
                    90ms-RKSJ-V
                    90msp-RKSJ-H
                    90msp-RKSJ-V
                    90pv-RKSJ-H
                    90pv-RKSJ-UCS2
                    90pv-RKSJ-UCS2C
                    90pv-RKSJ-V
                    Add-H
                    Add-RKSJ-H
                    Add-RKSJ-V
                    Add-V
                    Adobe-Japan1-0
                    Adobe-Japan1-1
                    Adobe-Japan1-2
                    Adobe-Japan1-3
                    Adobe-Japan1-4
                    Adobe-Japan1-5
                    Adobe-Japan1-6
                    Adobe-Japan1-90ms-RKSJ
                    Adobe-Japan1-90pv-RKSJ
                    Adobe-Japan1-H-CID
                    Adobe-Japan1-H-Host
                    Adobe-Japan1-H-Mac
                    Adobe-Japan1-PS-H
                    Adobe-Japan1-PS-V
                    Adobe-Japan1-UCS2
                    EUC-H
                    EUC-V
                    Ext-H
                    Ext-RKSJ-H
                    Ext-RKSJ-V
                    Ext-V
                    H
                    Hankaku
                    Hiragana
                    Identity-H
                    Identity-V
                    Katakana
                    NWP-H
                    NWP-V
                    RKSJ-H
                    RKSJ-V
                    Roman
                    UniJIS-UCS2-H
                    UniJIS-UCS2-HW-H
                    UniJIS-UCS2-HW-V
                    UniJIS-UCS2-V
                    UniJIS-UTF16-H
                    UniJIS-UTF16-V
                    UniJIS-UTF32-H
                    UniJIS-UTF32-V
                    UniJIS-UTF8-H
                    UniJIS-UTF8-V
                    UniJISPro-UCS2-HW-V
                    UniJISPro-UCS2-V
                    UniJISPro-UTF8-V
                    UniJISX0213-UTF32-H
                    UniJISX0213-UTF32-V
                    V
                    WP-Symbol}

    xinstall -m 755 -d ${GSFontDir}
    xinstall -m 755 -d ${GSCIDFontDir}

    foreach {file font aliases} ${FontList} {
        if {![file exists ${SystemLibraryFontsDir}/${file}]} {
            return -code error "Please place \"${file}\" in ${SystemLibraryFontsDir} and restart the build."
        }

        ln -s ${SystemLibraryFontsDir}/${file} ${GSCIDFontDir}/${font}

        foreach encode ${EncodeList} {
            set fd [open [file join ${GSFontDir} ${font}-${encode}] w 0644]
            puts ${fd} "(${font}-${encode})"
            puts ${fd} "(${encode}) /CMap findresource"
            puts ${fd} "\[(${font}) /CIDFont findresource\]"
            puts ${fd} "composefont"
            puts ${fd} "pop"
            close ${fd}
        }

        if {![variant_isset no_alias]} {
            foreach alias ${aliases} {
                foreach encode ${EncodeList} {
                    set fd [open [file join ${GSFontDir} ${alias}-${encode}] w 0644]
                    puts ${fd} "(${alias}-${encode})"
                    puts ${fd} "(${encode}) /CMap findresource"
                    puts ${fd} "\[(${font}) /CIDFont findresource\]"
                    puts ${fd} "composefont"
                    puts ${fd} "pop"
                    close ${fd}
                }
            }
        }
    }
}

platform darwin 9 {}

variant no_alias description "Don't use Hiragino as an alternative to Morisawa's standard 5 fonts" {}
