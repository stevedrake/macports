# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name            gutenprint
version         5.1.7
set branch      [join [lrange [split ${version} .] 0 1] .]
categories      print
maintainers     devans
homepage        http://gimp-print.sourceforge.net/
platforms       darwin

description     Gimp Print Plugin
long_description \
    Gutenprint plugin for the Gimp.

master_sites    sourceforge:gimp-print
use_bzip2       yes

checksums       md5     9a6c0e382d570b6449d71bce567c7590 \
                sha1    7fb93b8b7a0ef1e5f7cf83700cb96b2448241195 \
                rmd160  7f85d64823006899dc41165fcdc97872f6519616

depends_lib     lib:libgimp-2.0:gimp2

pre-fetch {
    ui_msg "
            This port only installs the Gutenprint plugin for the Gimp.
            You can get the complete Gutenprint drivers and utilities - except the gimp plugin - from
            http://gimp-print.sourceforge.net
            "
}

configure.args  --disable-escputil \
                --disable-samples \
                --disable-test \
                --without-cups \
                --without-readline \
                --with-gimp2-as-gutenprint

post-configure {
    foreach i {iconv intl} {
        reinplace "s|${prefix}/lib/lib${i}.dylib|-l${i}|g" \
            ${worksrcpath}/src/main/Makefile
    }
}

livecheck.check         regex
livecheck.url           http://sourceforge.net/export/rss2_projfiles.php?project=gimp-print
livecheck.regex         <title>${name}-${branch} (\[0-9.\]+) released.*</title>

