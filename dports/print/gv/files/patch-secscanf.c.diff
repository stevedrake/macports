--- src/secscanf.c	2008-09-09 12:22:17.000000000 -0500
+++ src/secscanf.c	2008-09-26 18:53:19.000000000 -0500
@@ -32,6 +32,22 @@
 #include <string.h>
 #include <ctype.h>
 
+size_t strnlen(const char *s, size_t len)
+{
+size_t i;
+for(i=0; i<len && *(s+i); i++);
+return i;
+}
+char* strndup (char const *s, size_t n)
+{
+size_t len = strnlen (s, n);
+char *new = malloc (len + 1);
+if (new == NULL)
+return NULL;
+new[len] = '\0';
+return memcpy (new, s, len);
+}
+
 enum {
 	CONV_ANY,
 	CONV_STR,
