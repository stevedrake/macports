# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem      1.0

name            libpaper
set ver_main    1.1.23
set ver_sub     nmu2
version         ${ver_main}-${ver_sub}
categories      print
maintainers     nomaintainer
platforms       darwin
description     A library providing routines for paper size management
long_description \
                The paper library and accompanying files are intended \
                to provide a simple way for applications to take \
                actions based on a system- or user-specified paper size.

homepage        http://packages.qa.debian.org/libp/libpaper.html
master_sites    http://ftp.us.debian.org/debian/pool/main/libp/${name}/ \
                ftp://ftp.us.debian.org/debian/pool/main/libp/${name}/

distname        libpaper_${ver_main}+${ver_sub}
worksrcdir      libpaper-${ver_main}+${ver_sub}

checksums       rmd160 564b73752c01cc1f7d56cb7e54388e90d6f3aa4a

patchfiles      patch-config.guess.diff \
                patch-paper.c.diff  \
                patch-paperconf.c.diff  \
                patch-Makefile.in.diff

post-patch {
    set fd [open [file join ${worksrcpath}/lib paperspecs] a 0644]
    # additional paper sizes
    foreach {n x y} {jisb0 2920 4127
                     jisb1 2064 2920
                     jisb2 1460 2064
                     jisb3 1032 1460
                     jisb4  729 1032
                     jisb5  516  729
                     jisb6  363  516} {
        puts ${fd} "${n} ${x} ${y}"
    }
    close ${fd}
}

pre-configure {
    system "touch ${worksrcpath}/config.sub"
}

configure.args  --mandir=${prefix}/share/man    \
                --sysconfdir=${prefix}/etc

livecheck.type  regex
livecheck.url   http://ftp.us.debian.org/debian/pool/main/libp/${name}/
livecheck.regex "${name}_(\\d+(?:\\.\\d+)*)${extract.suffix}"
