# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
PortGroup           python 1.0

name                py-omniORBpy
version             3.6
categories          python devel
maintainers         stromnov openmaintainer
description         Python bindings for omniORB
long_description    omniORB is a robust high performance CORBA ORB for C++ and \
                    Python. omniORB is largely CORBA 2.6 compliant.
homepage            http://omniorb.sourceforge.net/
platforms           darwin
master_sites        sourceforge:omniorb

distname            omniORBpy-${version}

use_bzip2           yes
checksums           md5     a7ab4789b913313f18a1171ff7a140b7 \
                    sha1    2def5ded7cd30e8d298113ed450b7bd09eaaf26f \
                    rmd160  96b73cfcac7f2b8df2894c93b3e422bd85412251

# Use the python subports feature but omniORBpy uses make
# rather than setup.py for building since there are compiled libraries.
# So the build procedure must unravel the python PortGroup settings
# and revert to values compatible with a make environment.
# Ugly but it works.

python.versions     24 25 26 27
python.default_version 24

if {$subport != $name} {
    depends_lib         port:omniORB \
                        port:python${python.version}

    patchfiles          patch-dir.mk

    use_configure       yes

    build.type          gnu
    build.cmd           make
    build.target        all
    build.args          {}

    destroot.cmd        ${build.cmd}
    destroot.target     install
    destroot.args       {}
    destroot.destdir    DESTDIR=${destroot}

    variant ssl description {Enable SSL support} {
        configure.args-append   --with-openssl
        depends_lib-append      port:openssl
    }
    livecheck.type      none
} else {
    livecheck.type      regex
    livecheck.url       http://omniorb.sourceforge.net/releases/
    livecheck.regex     "omniORBpy-(\\d+(?:\\.\\d+)*)${extract.suffix}"
}
