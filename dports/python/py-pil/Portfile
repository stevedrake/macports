# $Id: Portfile,v 1.8 2005/07/04 11:24:11 mww Exp $
PortSystem		1.0
PortGroup		python24 1.0

name			py-pil
version			1.1.4
revision		4
maintainers		rshaw@opendarwin.org
description		Python Imaging Library
long_description	The Python Imaging Library (PIL) adds image \
					processing capabilities to your Python interpreter. \
					This library supports many file formats, and \
					provides powerful image processing and graphics \
					capabilities. 
categories-append	graphics
platforms		darwin freebsd
homepage		http://www.pythonware.com/
master_sites	http://effbot.org/downloads/
distname		Imaging-${version}
checksums		md5 d2c03c25a9a0128832137dd536da88da
patchfiles		patch-Makefile.in \
				patch-setup.py \
				patch-Image.py

depends_lib-append	lib:libjpeg:jpeg \
					lib:libfreetype.6:freetype \
					lib:libz.1:zlib

post-patch		{ reinplace s,@prefix@,${prefix},g ${worksrcpath}/setup.py }

use_configure	yes
configure.dir	${worksrcpath}/libImaging
configure.env   CFLAGS="-I${prefix}/include" \
                LDFLAGS="-L${prefix}/lib"

pre-build		{ system "cd ${configure.dir} && make all" }

post-destroot	{
	cd ${worksrcpath}
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	system "cp -R Doc ${destroot}${prefix}/share/doc/${name}/Doc"
	xinstall -m 0644 BUILDME CHANGES-114 CONTENTS README \
		${destroot}${prefix}/share/doc/${name}
}

variant tk {
	build.env			WITH_TK=yes ${configure.env}
	depends_lib-append	port:tk port:py-tkinter
}

