# $Id: Portfile,v 1.2 2004/06/06 05:31:15 rshaw Exp $
PortSystem		1.0
PortGroup		python 1.0
name			py-rdiff-backup
version			0.12.6
categories-append	net
maintainers		rshaw@opendarwin.org
description		backs up one directory to another, possibly over a network
long_description	rdiff-backup backs up one directory to another, \
					possibly over a network. The target directory ends \
					up a copy of the source directory, but extra reverse \
					diffs are stored in a special subdirectory of that \
					target directory, so you can still recover files \
					lost some time ago. The idea is to combine the best \
					features of a mirror and an incremental backup. \
					rdiff-backup also preserves subdirectories, hard \
					links, dev files, permissions, uid/gid ownership, \
					and modification times. Also, rdiff-backup can \
					operate in a bandwidth efficient manner over a pipe, \
					like rsync. Thus you can use rdiff-backup and ssh to \
					securely back a hard drive up to a remote location, \
					and only the differences will be transmitted. \
					Finally, rdiff-backup is easy to use and settings \
					have sensical defaults.
homepage		http://rdiff-backup.stanford.edu/
master_sites	${homepage}
distname		rdiff-backup-${version}
checksums		md5 49d7baedd303fb278a65682064ec8c64
platforms		darwin

depends_lib-append	lib:librsync:librsync

build.args		--librsync-dir=${prefix}

post-destroot {
	set docPath ${prefix}/share/doc/rdiff-backup-${version}
	xinstall -m 0644 ${worksrcpath}/examples.html ${destroot}${docPath}
	reinplace "s|included in .* distribution|installed in ${docPath}|" \
		${destroot}${prefix}/share/man/man1/rdiff-backup.1
}

variant devel {
	version		0.13.4
	checksums	md5 43a5e98751371fb1852fb2ebeed38e77
	distname	rdiff-backup-${version}
}

variant cvs {
	version			[clock format [clock seconds] -format %Y%m%d]
	fetch.type		cvs
	cvs.env			CVS_RSH=[binaryInPath ssh]
	cvs.root		:ext:anoncvs@savannah.nongnu.org:/cvsroot/rdiff-backup
	cvs.module		rdiff-backup
	post-fetch {
		cd ${workpath}/${cvs.module}
		system "${python.bin} dist/makedist ${version}"
		system "gunzip -c ${cvs.module}-${version}.tar.gz \
			| tar xvf - -C ${workpath}"
	}
	worksrcdir		${cvs.module}-${version}
}

