# -*- coding: utf-8; truncate-lines: t -*-
# $Id$

PortSystem       1.0
PortGroup        python24 1.0
name             py-scientific
version          2.6
categories       python science
maintainers      openmaintainer jochen
description      Scientific Python
long_description ScientificPython is a collection of Python modules that \
		 are useful for scientific computing.
homepage         http://dirac.cnrs-orleans.fr/plone/software/scientificpython/
master_sites	 http://sourcesup.cru.fr/frs/download.php/1034 \
                 http://www.mirrorservice.org/sites/www.ibiblio.org/gentoo/distfiles
distname         ScientificPython-${version}
checksums        md5 6ebd96fc8a4e015adab2c57826d52e9f \
                 sha1 db5b0d369e8254130312553a13a70888537e637e

depends_lib      port:netcdf \
		 port:py-numeric

build.env    	 CPPFLAGS="-I${prefix}/include/python2.4 \
		 -I${worksrcpath}/Include" \
		 NETCDF_PREFIX=${prefix}		 

variant mpi      {
        depends_lib-append port:lammpi

        post-build	 {
		 reinplace "s|%s %s -o mpipython|${prefix}/bin/%s -o mpipython -I${prefix}/include/python2.4 -I${worksrcpath}/Include|g" \
			${worksrcpath}/Src/MPI/compile.py
		 reinplace "s|-L%s -lpython%s|-L/Library/Frameworks/Python.framework/Versions/2.4/lib -L%s -lpython.%s|g" \
			${worksrcpath}/Src/MPI/compile.py
		 reinplace "s|cfgDict\\\[\'LINK|#cfgDict\\\[\'LINK|g" \
			${worksrcpath}/Src/MPI/compile.py
		 system "cd ${worksrcpath}/Src/MPI && python2.4 compile.py"
        }

        post-destroot    {
		 xinstall -m 0755 -W ${worksrcpath}/Src/MPI mpipython ${destroot}${prefix}/bin
        }
}
