# $Id$

PortSystem      1.0

PortGroup       python25 1.0
name            py25-scientific
version         2.6
categories      python science
maintainers     nomaintainer
description     Scientific Python

long_description \
    ScientificPython is a collection of Python modules that \
    are useful for scientific computing.

homepage        http://dirac.cnrs-orleans.fr/ScientificPython/
master_sites	http://sourcesup.cru.fr/frs/download.php/1034
distname        ScientificPython-${version}

checksums       md5 6ebd96fc8a4e015adab2c57826d52e9f

depends_lib     port:netcdf \
                port:py25-numeric

build.env    	CPPFLAGS="-I${prefix}/include/python2.5 \
	            -I${worksrcpath}/Include" \
                NETCDF_PREFIX=${prefix}

platform macosx {
    post-patch {
        copy -force ${filespath}/customize.py-macosx ${worksrcpath}/customize.py
    }
}

platform puredarwin {
    post-patch {
        copy -force ${filespath}/customize.py-puredarwin ${worksrcpath}/customize.py
    }
}

variant mpi {
    depends_lib-append  port:lammpi

    post-build {
        reinplace "s|%s %s -o mpipython|${prefix}/bin/%s -o mpipython -I${prefix}/include/python2.5 -I${worksrcpath}/Include|g" \
			${worksrcpath}/Src/MPI/compile.py
        reinplace "s|-L%s -lpython%s|-L/Library/Frameworks/Python.framework/Versions/2.5/lib -L%s -lpython.%s|g" \
			${worksrcpath}/Src/MPI/compile.py
        reinplace "s|cfgDict\\\[\'LINK|#cfgDict\\\[\'LINK|g" \
			${worksrcpath}/Src/MPI/compile.py

        system "cd ${worksrcpath}/Src/MPI && python2.5 compile.py"
    }

    post-destroot {
        xinstall -m 0755 -W ${worksrcpath}/Src/MPI mpipython ${destroot}${prefix}/bin
    }
}

livecheck.check regex
livecheck.url   http://sourcesup.cru.fr/projects/scientific-py/
livecheck.regex {<td>(\d+(?:\.\d+)*)}
