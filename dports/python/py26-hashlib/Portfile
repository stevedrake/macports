# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id: Portfile 448 2008-11-07 20:24:31Z macports $

PortSystem 1.0

#######################################################################################################
# PortGroup python26 1.0
#######################################################################################################
# Can be removed once MacPorts 1.7.0 is released
if {![info exists frameworks_dir]} {
    set frameworks_dir ${prefix}/Library/Frameworks
}

set python.bin	    ${prefix}/bin/python2.6
set python.lib	    ${frameworks_dir}/Python.framework/Versions/2.6/Python
set python.pkgd	    ${frameworks_dir}/Python.framework/Versions/2.6/lib/python2.6/site-packages
set python.include	${frameworks_dir}/Python.framework/Versions/2.6/include/python2.6

categories		python

dist_subdir		python

depends_lib		port:python26

use_configure	no

build.cmd		${python.bin} setup.py --no-user-cfg
build.target	build

destroot.cmd	           ${python.bin} setup.py --no-user-cfg
destroot.destdir	       --prefix=${frameworks_dir}/Python.framework/Versions/2.6 --root=${destroot}
configure.pkg_config_path  ${frameworks_dir}/Python.framework/Versions/2.6/lib/pkgconfig

pre-destroot	{
	xinstall -d -m 755 ${destroot}${prefix}/share/doc/${name}/examples
}
#######################################################################################################

name			py26-hashlib
version			2.6
set branch              [join [lrange [split ${version} .] 0 1] .]
categories		python
platforms		darwin
maintainers		mcalhoun openmaintainer
description		Python secure hash and message digest module
long_description	Python secure hash and message digest module MD5, SHA1, \
				SHA224, SHA256, SHA384, SHA512

homepage		http://www.python.org/doc/current/library/hashlib.html
master_sites	http://www.python.org/ftp/python/${version}/
distname		Python-${version}
dist_subdir		python26
checksums		md5 d16d29a77db2cd3af882a591f431a403 \
			sha1 d7fd08304b66cb4020786a7ee5aa452235046ecd \
			rmd160 b44d5cc7efa198b21f41e43e1d28af60875f0a4e
extract.suffix		.tgz

depends_lib-append	port:openssl

worksrcdir		${worksrcdir}/Modules

extract.post_args	"| tar -xf - ${distname}/Modules/_hashopenssl.c"
post-extract {
	file copy ${filespath}/setup.py ${worksrcpath}
}

configure {
	reinplace "s|__VERSION__|${version}|g" ${worksrcpath}/setup.py
	reinplace "s|__PREFIX__|${prefix}|g" ${worksrcpath}/setup.py
}

livecheck.check	regex
livecheck.url		http://www.python.org/download/releases/
livecheck.regex		Python (${branch}(?:\\.\\d+))*
