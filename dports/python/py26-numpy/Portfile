# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem              1.0

#######################################################################################################
# PortGroup python26 1.0
#######################################################################################################
# Can be removed once MacPorts 1.7.0 is released
if {![info exists frameworks_dir]} {
    set frameworks_dir ${prefix}/Library/Frameworks
}

set python.bin	    ${prefix}/bin/python2.6
set python.lib	    ${frameworks_dir}/Python.framework/Versions/2.6/Python
set python.pkgd	    ${frameworks_dir}/Python.framework/Versions/2.6/lib/python2.6/site-packages
set python.bindir	${frameworks_dir}/Python.framework/Versions/2.6/bin
set python.include	${frameworks_dir}/Python.framework/Versions/2.6/include/python2.6

categories		python

dist_subdir		python

depends_lib		port:python26

use_configure	no

build.cmd		${python.bin} setup.py --no-user-cfg
build.target	build

destroot.cmd	           ${python.bin} setup.py --no-user-cfg
destroot.destdir	       --prefix=${frameworks_dir}/Python.framework/Versions/2.6 --root=${destroot}
configure.pkg_config_path  ${frameworks_dir}/Python.framework/Versions/2.6/lib/pkgconfig

set env(PATH) "${python.bindir}:$env(PATH)"

pre-destroot	{
	xinstall -d -m 755 ${destroot}${prefix}/share/doc/${name}/examples
}
#######################################################################################################

name                    py26-numpy
version                 1.2.1
categories              python
platforms               darwin
maintainers             mcalhoun openmaintainer
description             The core utilities for the scientific library scipy for Python
long_description        ${description}

homepage                http://numpy.scipy.org/
master_sites            sourceforge:numpy
distname                numpy-${version}

checksums           md5 1bc6dbddaf4b48ded8a619c6438fff37 \
                    sha1 1aa706e733aea18eaffa70d93c0105718acb66c5 \
                    rmd160 7eb721d0d853f3b0b9b04a4f447353873d6c0997

patchfiles              patch-g95_link.diff \
                        patch-f2py_setup.py.diff

depends_lib-append      port:fftw-3 \
                        port:py26-nose

post-patch {
    reinplace "s|@@MPORTS_PYTHON_LIBRARY@@|${python.lib}|" ${worksrcpath}/numpy/distutils/fcompiler/g95.py
    reinplace "s|@@MPORTS_PYTHON@@|${python.bin}|" ${worksrcpath}/numpy/f2py/setup.py
}

post-destroot {
    set branch 2.6
    ln -s ${python.bindir}/f2py ${destroot}${prefix}/bin/f2py-${branch}
}

livecheck.distname      NumPy
