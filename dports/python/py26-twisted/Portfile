# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

#######################################################################################################
# PortGroup python26 1.0
#######################################################################################################
# Can be removed once MacPorts 1.7.0 is released
if {![info exists frameworks_dir]} {
    set frameworks_dir ${prefix}/Library/Frameworks
}

set python.bin	    ${prefix}/bin/python2.6
set python.lib	    ${frameworks_dir}/Python.framework/Versions/2.6/Python
set python.pkgd	    ${frameworks_dir}/Python.framework/Versions/2.6/lib/python2.6/site-packages
set python.bindir	${frameworks_dir}/Python.framework/Versions/2.6/bin
set python.include	${frameworks_dir}/Python.framework/Versions/2.6/include/python2.6

categories		python

dist_subdir		python

depends_lib		port:python26

use_configure	no

build.cmd		${python.bin} setup.py --no-user-cfg
build.target	build

destroot.cmd	           ${python.bin} setup.py --no-user-cfg
destroot.destdir	       --prefix=${frameworks_dir}/Python.framework/Versions/2.6 --root=${destroot}
configure.pkg_config_path  ${frameworks_dir}/Python.framework/Versions/2.6/lib/pkgconfig

set env(PATH) "${python.bindir}:$env(PATH)"

pre-destroot	{
	xinstall -d -m 755 ${destroot}${prefix}/share/doc/${name}/examples
}
#######################################################################################################

name			py26-twisted
version			8.1.0
categories		python devel net
platforms		darwin
maintainers		mcalhoun openmaintainer
description		An event-based Python framework for internet applications
long_description	Twisted is an event-driven networking framework \
				written in Python. Twisted supports TCP, UDP, SSL/TLS, \
				multicast, Unix sockets, a large number of protocols \
				(including HTTP, NNTP, SSH, IRC, FTP, and others), and \
				much more.

homepage		http://www.twistedmatrix.com/
master_sites	http://tmrc.mit.edu/mirror/twisted/Twisted/[join [lrange [split ${version} .] 0 1] .]
distname		Twisted-${version}
use_bzip2		yes
checksums \
    md5     a575f29ead4cc02c54e9061d0e6ac7c3 \
    sha1    b10e523ab96032f5055ee02687b22bcd7cb02951 \
    rmd160  1348f5e384a7d9d8591bd67e6b1f0d54aa18700e

depends_lib-append  port:py26-zopeinterface

post-destroot {
    set branch 2.6
    
    foreach bin [glob -tails -directory ${destroot}${python.bindir} *] {
        ln -s ${python.bindir} ${destroot}${prefix}/bin/${bin}-${branch}
	}
}

livecheck.check  regex
livecheck.url    http://twistedmatrix.com/trac/wiki/Downloads
livecheck.regex  "The current release is Twisted (\\d+(?:\\.\\d+)*)"
