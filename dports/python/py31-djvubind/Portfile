# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem                      1.0
PortGroup                       python31 1.0

name                            py31-djvubind
version                         1.0.2
platforms                       darwin
supported_archs                 noarch
maintainers                     raphael openmaintainer
license                         GPL-3+
categories                      python graphics
description                     A tool to create highly compressed djvu files with positional ocr, \
                                metadata, and bookmarks
homepage                        http://code.google.com/p/djvubind/
long_description                Djvubind facilitates creating high-quality djvu files, especially \
                                digital versions of scanned books. It functions as a wrapper that \
                                combines the djvulibre tools, minidjvu, and tesseract to provide a \
                                simple, single command creation of a djvu file.

depends_lib-append              port:djvulibre \
                                port:ImageMagick \
                                port:minidjvu \
                                port:tesseract \
                                port:cuneiform

distname                        djvubind-${version}
use_bzip2                       yes

master_sites                    googlecode:djvubind

checksums                       md5     a66de2d1f17e177565b98fb552552ef2 \
                                sha1    fac7d4e0e555402454c9ad025a1a59aeb3fc5bea \
                                rmd160  b88b396fbd50cb866ee56b9ae7328d82d693f57c

patchfiles                      patch-setup.py.diff
post-patch {                    reinplace "s|/usr/bin/env python3|${python.bin}|" ${worksrcpath}/bin/djvubind
}

python.link_binaries_suffix

post-destroot {                 ln -s "${python.prefix}/share/man/man1/djvubind.1.gz" "${destroot}${prefix}/share/man/man1/djvubind${python.link_binaries_suffix}.1.gz"
                                set docdir ${destroot}${prefix}/share/doc/${name}
                                xinstall -d ${docdir}
                                xinstall -m 644 -W ${worksrcpath} \
                                    README \
                                    docs/changelog \
                                    ${docdir}
                                set sysconfigdir ${destroot}${prefix}/etc/djvubind
                                xinstall -d ${sysconfigdir}
                                ln -s "${python.prefix}/etc/djvubind/config" "${sysconfigdir}/config"
}
