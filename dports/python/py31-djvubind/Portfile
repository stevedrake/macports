# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem                      1.0
PortGroup                       python31 1.0

name                            py31-djvubind
version                         1.0.1
platforms                       darwin
supported_archs                 noarch
maintainers                     raphael openmaintainer
license                         GPL-3+
categories                      python graphics
description                     A tool to create highly compressed djvu files with positional ocr, \
                                metadata, and bookmarks
homepage                        http://code.google.com/p/djvubind/
long_description                Djvubind facilitates creating high-quality djvu files, especially \
                                digital versions of scanned books. It functions as a wrapper that \
                                combines the djvulibre tools, minidjvu, and tesseract to provide a \
                                simple, single command creation of a djvu file.

depends_lib-append              port:djvulibre \
                                port:ImageMagick \
                                port:minidjvu \
                                port:tesseract \
                                port:cuneiform

distname                        djvubind-${version}
use_bzip2                       yes

master_sites                    googlecode:djvubind

checksums                       md5     16b9db4bd364c35babedd1eef188ca46 \
                                sha1    d167e7a1e4c947e75d404df0574d1bc82ed29b9c \
                                rmd160  b34e203afac927fe5eb3b4eba3582d5d9088886d

patchfiles                      patch-setup.py.diff
post-patch {                    reinplace "s|/usr/bin/env python3|${python.bin}|" ${worksrcpath}/bin/djvubind
}

python.link_binaries_suffix

post-destroot {                 ln -s "${python.prefix}/share/man/man1/djvubind.1.gz" "${destroot}${prefix}/share/man/man1/djvubind${python.link_binaries_suffix}.1.gz"
                                set docdir ${destroot}${prefix}/share/doc/${name}
                                xinstall -d ${docdir}
                                xinstall -m 644 -W ${worksrcpath} \
                                    README \
                                    docs/changelog \
                                    ${docdir}
                                set sysconfigdir ${destroot}${prefix}/etc/djvubind
                                xinstall -d ${sysconfigdir}
                                ln -s "${python.prefix}/etc/djvubind/config" "${sysconfigdir}/config"
}
