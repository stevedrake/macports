# $Id: Portfile,v 1.8 2004/10/13 22:02:46 rshaw Exp $
PortSystem		1.0
PortGroup		ruby 1.0

ruby.setup		{cocoa rubycocoa} 0.4.0 install.rb \
				{ReadMe.ascii.html doc sample}
revision		5
maintainers		rshaw@opendarwin.org
description		Ruby bindings for writing cocoa programs
long_description	RubyCocoa is a Ruby library for using Cocoa Objects \
					on Mac OS X in Ruby scripts. You can use RubyCocoa \
					to work with Cocoa objects in Ruby scripts, write \
					Cocoa applications with Ruby and Interface Builder, \
					develop small scale simple Cocoa applications and \
					such.
categories-append	devel
homepage		http://www.fobj.com/${ruby.project}/
master_sites	http://${ruby.project}.sourceforge.net/files/
extract.suffix	.tgz
checksums		md5 0582ec18473d9903fa0092a11f5d283a
platforms		darwin

patchfiles		patch-rubycocoa.darwin
post-patch {
	if {[catch {set xcodebuild [binaryInPath xcodebuild]}] == 0} {
		reinplace "s%pbxbuild%${xcodebuild}%" ${worksrcpath}/install.rb
	}
	if {[catch {set cpp [binaryInPath cpp-3.3]}] == 0} {
		reinplace "s%/usr/bin/cpp3%${cpp}%" ${worksrcpath}/tool/och_analyzer3.rb
	} elseif {[catch {set cpp [binaryInPath cpp3]}] == 0} {
		reinplace "s%/usr/bin/cpp3%${cpp}%" ${worksrcpath}/tool/och_analyzer3.rb
	} elseif {[catch {set cpp [binaryInPath cpp]}] == 0} {
		reinplace "s%/usr/bin/cpp3%${cpp}%" ${worksrcpath}/tool/och_analyzer3.rb
	}
}

configure.args		--install-prefix=${destroot}${prefix} \
					--install-root=${destroot}

variant cvs {
	version			0.4.1.d9
	distname		${ruby.project}-${version}

	fetch.type		cvs
	cvs.module		${ruby.project}
	cvs.root		:pserver:anonymous@cvs.sourceforge.net:/cvsroot/${cvs.module}
	cvs.tag			snapshot-[strsed $version {g/[.]/_/}]
	cvs.args		-d ${distname}

	patchfiles-delete	patch-rubycocoa.darwin
}

