# $Id$

PortSystem		1.0
PortGroup		ruby 1.0

ruby.setup		{cocoa rubycocoa} 1.0.0 install.rb {ChangeLog ReadMe.html ReadMe.ja.html}
revision		2
maintainers		kimuraw
description		Ruby bindings for writing cocoa programs
long_description	RubyCocoa is a Ruby library for using Cocoa Objects \
					on Mac OS X in Ruby scripts. You can use RubyCocoa \
					to work with Cocoa objects in Ruby scripts, write \
					Cocoa applications with Ruby and Interface Builder, \
					develop small scale simple Cocoa applications and \
					such.
categories-append	devel
homepage		http://${ruby.project}.sourceforge.net/
license			LGPL/Ruby
master_sites	sourceforge:${ruby.project}
distname		RubyCocoa-${version}
checksums		md5 96e6a69191e862f60915c11d4d9ea7c0 \
				rmd160 1b304748a3c15163090a71fbc67e9bfb0cfa692f \
				sha1 d20504c3f7785ac4aba0f0df6d8f68fa4ffe6b33
platforms		darwin

# fix #16928: allow non Mac OS X's make, like gmake
patchfiles-append	patch-ext-rubycocoa-extconf.rb.in.diff
# fix some errors 1.0.0 on Snow Leopard (1.0.0 to r2258)
patchfiles-append	patch-r2258.diff

configure.args		--install-prefix=${destroot}${prefix} \
					--install-root=${destroot} \
					--documentation=${prefix}/share/doc/${name} \
					--examples=${prefix}/share/examples/${name}
destroot.violate_mtree	yes

# see bug #21764
# install fails with gnu xargs from findutils+with_default_names.
# this problem was fixed RubyCocoa trunk r2268
post-patch {
	reinplace "s| xargs |  /usr/bin/xargs |" ${worksrcpath}/pre-install.rb
}

# apply universal_archs or build_arch
if {[variant_isset universal]} {
	if {[info exists universal_archs] && $universal_archs != ""} {
		configure.args-append --target-archs="${universal_archs}"
	}
} else {
	if {[info exists build_arch] && $build_arch != ""} {
		configure.args-append --target-archs="${build_arch}"
	}
}

# by default, do not install Xcode templates. #18708
variant xcode description {install project templates for Xcode} { }
if {![variant_isset xcode]} {
	configure.args-append \
		--xcode-extras="${prefix}/share/doc/${name}/project-templates"
}

#test.run yes
test.cmd ${ruby.bin}
test.target install.rb test

