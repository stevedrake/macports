# $Id: Portfile,v 1.2 2004/04/11 06:00:21 rshaw Exp $
PortSystem 1.0

name			rb-kwartz
version			2004-04-05
categories		ruby textproc
maintainers		shu@rufuran.org
description		A fast, clean, multi-language template system
long_description	Kwartz is a template system designed for web designers \
			and programmers. It can separate presentation logic \
			from a template, runs very fast, generates templates \
			in multiple languages, does not break HTML design, \
			handle any kind of text, and can auto-sanitize text.

homepage		http://www.kuwata-lab.com/webtech/kwartz/
platforms		darwin
master_sites		${homepage}
dist_subdir		ruby
distname		kwartz_${version}
worksrcdir		kwartz_${version}
checksums		md5 ae99496b15e76f29d709550d16aaed1f

set ruby ${prefix}/bin/ruby
depends_build		path:${ruby}:ruby

use_configure		no

build {
	reinplace "s|#!/usr/bin/ruby|#!${ruby}|g" ${worksrcpath}/kwartz
}

test.run		yes
test.dir		${worksrcpath}/test
test.cmd		${ruby} test.cmd.rb\; ${ruby} test.rb

destroot {
	set rubylibpath [exec ${ruby} -rrbconfig -e "print Config::CONFIG\['vendorlibdir'\]"]
	regsub ${prefix} ${rubylibpath} ${destroot}${prefix} rubylibpath

	xinstall -d -m 0755 ${destroot}${prefix}/bin
	xinstall -m 0755 ${worksrcpath}/kwartz ${destroot}${prefix}/bin
	xinstall -d -m 0755 ${rubylibpath}
	xinstall -m 0644 ${worksrcpath}/kwartz.rb ${rubylibpath}
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	system "cp -R ${worksrcpath}/util ${destroot}${prefix}/share/doc/${name}/util"
	system "cp -R ${worksrcpath}/users-guide ${destroot}${prefix}/share/doc/${name}/users-guide"
}
