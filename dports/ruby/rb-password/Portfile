# $Id: Portfile,v 1.1 2004/04/21 23:09:34 rshaw Exp $
PortSystem 1.0

name			rb-password
version			0.5.1
categories		ruby sysutils
maintainers		rshaw@opendarwin.org
description		password manipulation methods for Ruby
long_description	Ruby/Password comprises a set of useful methods for \
					creating, verifying and manipulating passwords. It \
					includes an interface to CrackLib, a library \
					commonly used for checking password strength.  The \
					target audience for this library is system \
					administrators who need to write Ruby programs that \
					prompt for, generate, verify and encrypt passwords. 
homepage		http://www.caliban.org/ruby/
master_sites	http://www.caliban.org/files/ruby/
dist_subdir		ruby
distname		ruby-password-${version}
checksums		md5 19b77a32335d96a0f876589b09672925
platforms		darwin

set ruby ${prefix}/bin/ruby
depends_build	path:${ruby}:ruby
depends_lib		lib:libcrack.2:cracklib \
				lib:XXX:rb-termios

patchfiles		patch-tc_password.rb
post-patch {
	cd ${worksrcpath}
	reinplace "s|^#!.*ruby|#!${ruby}|" example/example.rb example/pwgen
	reinplace "s|/usr/local|${prefix}|g" extconf.rb
	reinplace "s|pw_dict|cracklib/&|g" extconf.rb
}

configure.cmd	${ruby} -rvendor-specific extconf.rb

post-build {
	system "cd ${worksrcpath} && rdoc -x CVS rbcrack.c"
}

test.run		yes
test.cmd		${ruby} test/tc_password.rb

destroot.args	RUBY=${ruby}
post-destroot {
	cd ${worksrcpath}
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	set cmd "cp -R example ${destroot}${prefix}/share/doc/${name}/example"
	ui_info ${cmd}; system ${cmd}
	set cmd "cp -R doc ${destroot}${prefix}/share/doc/${name}/rdoc"
	ui_info ${cmd}; system ${cmd}
}

