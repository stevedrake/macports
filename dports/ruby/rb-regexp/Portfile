# $Id: Portfile,v 1.2 2004/04/28 02:57:08 rshaw Exp $
PortSystem 1.0

name			rb-regexp
version			0.9
categories		ruby textproc
maintainers		rshaw@opendarwin.org
description		regular expression engine
long_description	Here is an Regexp engine written entirely in Ruby. \
					It allows you to search in text with advanced search \
					patterns.  It supports Perl5 syntax... plus some \
					perl6 syntax (more to come in the future). Its \
					fairly compatible with Ruby's native regexp engine \
					(GNU), and when running against the Rubicon \
					testsuite, it passes 96.025% out of 1560 total \
					tests. \
					The implementation is simple, yet without any \
					optimizations.  Therefore speed is slow.. At some \
					point when optimizations are in place, I plan to do \
					a re-implementation in C++.  Because of the \
					simplicity, the code should be easy to grasp and \
					extend with your own custom code.
homepage		http://rubyforge.org/projects/aeditor/
master_sites	http://rubyforge.org/frs/download.php/581/
distname		re-${version}
worksrcdir		regexp-engine-${version}
dist_subdir		ruby
checksums		md5 3a84aaa09ba1988e072433278e68022e
platforms		darwin

set ruby ${prefix}/bin/ruby
depends_build	path:${ruby}:ruby
depends_lib		lib:XXX:rb-iterator \
				lib:XXX:rb-test-unit-mock

post-extract {
	file delete ${worksrcpath}/lib/iterator.rb
}

configure.cmd		${ruby} -rvendor-specific install.rb
configure.pre_args	config

build.cmd			${ruby} -rvendor-specific install.rb
build.target		setup

test.run		yes
test.dir		${worksrcpath}/test
test.cmd		${ruby} -I../lib test_all.rb

destroot.cmd		${ruby} -rvendor-specific install.rb
destroot.target		install
destroot.destdir
pre-destroot {
	reinplace "s|${prefix}|${destroot}${prefix}|g" ${worksrcpath}/config.save
}
post-destroot {
	cd ${worksrcpath}
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	set cmd "cp -R samples ${destroot}${prefix}/share/doc/${name}/samples"
	ui_info ${cmd}; system ${cmd}
}

