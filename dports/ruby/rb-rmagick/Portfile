# $Id: Portfile,v 1.1 2004/04/22 23:16:22 rshaw Exp $
PortSystem 1.0

name			rb-rmagick
version			1.5.0
categories		ruby graphics
maintainers		shu@rufuran.org
description		The Ruby interface to ImageMagick and GraphicsMagick
long_description	RMagick is an interface between the Ruby programming \
					language and the ImageMagick (tm) and GraphicsMagick \
					image processing libraries. It is fully featured and \
					has good documentation.
homepage		http://rmagicki.rubyforge.org/
master_sites	http://rubyforge.org/frs/download.php/550/
distname		RMagick-${version}
use_bzip2		yes
dist_subdir		ruby
checksums		md5 282164e8548262110a4d4fd6d9d4d4ff
platforms		darwin

set ruby ${prefix}/bin/ruby
depends_build	path:${ruby}:ruby
depends_lib		lib:libMagick:ImageMagick

pre-configure {
	foreach exe {wmf2eps gs} {
		if {[catch {set found [binaryInPath ${exe}]}] != 0} {
			ui_warn "${exe} is not installed, some RMagick examples will fail."
		} else {
			ui_info "${exe} found: ${found}"
		}
	}
	reinplace "s|\$(RUBY)|& -rvendor-specific|g" ${worksrcpath}/Makefile.in
}
configure.args	--with-doc-dir=${prefix}/share/doc/${name}/userguide \
				--enable-allow-example-errors

pre-destroot {
	reinplace "s|${prefix}|${destroot}${prefix}|g" ${worksrcpath}/config.save
}
post-destroot {
	cd ${worksrcpath}
	xinstall -m 0644 README.html ${destroot}${prefix}/share/doc/${name}
	xinstall -m 0644 README.txt ${destroot}${prefix}/share/doc/${name}
	set cmd "cp -R examples ${destroot}${prefix}/share/doc/${name}/examples"
	ui_info ${cmd}; system ${cmd}
}

