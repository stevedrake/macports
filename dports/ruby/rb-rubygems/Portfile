# $Id: Portfile,v 1.18 2006/07/31 04:42:07 pguyot Exp $
PortSystem		1.0
PortGroup		ruby 1.0
revision		1

ruby.setup		rubygems 0.8.11 setup.rb {README doc examples gemspecs} \
			rubyforge:5207
maintainers		yuhei@pop21.odn.ne.jp
description		a package management framework for Ruby
long_description	RubyGems is the Ruby standard for publishing and \
					managing third party libraries.
categories-append	devel
checksums		md5 aa363b428c4c1fc2e076a4ff77b957d7
extract.suffix		.tgz
platforms		darwin

post-patch {
	reinplace "s%Gem.dir%'${destroot}${prefix}/lib/ruby/gems'%" ${worksrcpath}/post-install.rb
}
set gems_libdir	${destroot}/${prefix}/lib/ruby/gems/${ruby.version}
destroot.keepdirs \
	${gems_libdir}/cache \
	${gems_libdir}/doc \
	${gems_libdir}/gems \
	${gems_libdir}/specifications
pre-destroot {
	xinstall -d -m 0755 ${gems_libdir}
	foreach gems_keepdir ${destroot.keepdirs} {
		xinstall -d -m 0755 $gems_keepdir
	}
}
post-destroot {
	foreach script {gem gem_server generate_yaml_index.rb update_rubygems} {
		reinplace "s%^#!.*ruby%#!${ruby.bin}%" ${destroot}${prefix}/bin/$script
	}
}
