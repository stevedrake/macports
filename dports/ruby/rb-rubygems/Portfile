# $Id: Portfile,v 1.1 2004/04/28 06:21:24 rshaw Exp $
PortSystem		1.0

name			rb-rubygems
version			0.2.0
categories		ruby devel
maintainers		rshaw@opendarwin.org
description		
long_description	
homepage		http://rubyforge.org/projects/rubygems/
master_sites	http://rubyforge.org/frs/download.php/414/
dist_subdir		ruby
distname		rubygems-${version}
checksums		md5 a3715fb835670ef9023830ed9138322d
platforms		darwin

set ruby ${prefix}/bin/ruby
depends_build	path:${ruby}:ruby

post-patch {
	cd ${worksrcpath}
	reinplace "s|site_ruby|vendor_ruby|" install.rb
	reinplace "s|^install_rb|\$site_libdir=DESTDIR+\$site_libdir;&|" install.rb
	reinplace "s/\\.rb/.(rb|cmd)/" install.rb
	reinplace "s|../lib|../&|" packages/sources/sources.gemspec
	file copy -force ${filespath}/destroot-install.rb .
}

use_configure	no
build			{}

destroot.env	DESTDIR=${destroot}
destroot.cmd	${ruby} -rvendor-specific -rdestroot-install install.rb
destroot.target
destroot.destdir
post-destroot {
	cd ${worksrcpath}
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	system "cp -R doc/* ${destroot}${prefix}/share/doc/${name}"
	system "cp -R example ${destroot}${prefix}/share/doc/${name}/example"
	system "cp -R gemspecs ${destroot}${prefix}/share/doc/${name}/gemspecs"
}

