# $Id: Portfile,v 1.1 2004/04/19 18:24:31 rshaw Exp $
PortSystem 1.0

name			rb-tapkit
version			0.5.0
categories		ruby databases
maintainers		rshaw@opendarwin.org
description		Object-Relational Bridge Framework
long_description	TapKit is an Object-Relational Bridge framework like \
					Enterprise Objects Framework in WebObjects of Apple \
					Computer, Inc. This framework services database \
					programming without SQL language.
homepage		http://www.spice-of-life.net/tapkit/index.html
master_sites	http://www.spice-of-life.net/tapkit/archive/
dist_subdir		ruby
distname		tapkit-${version}
checksums		md5 4cd5c84b16ae6f910c421c8d2c6f0ba4
platforms		darwin

set ruby ${prefix}/bin/ruby
depends_build	path:${ruby}:ruby
depends_lib		lib:XXX:rb-dbi

configure.cmd		${ruby} -rvendor-specific setup.rb
configure.pre_args	config
post-configure {
	reinplace "s|^#!.*ruby|#!${ruby}|" ${worksrcpath}/bin/modeler
}

build				{}

# Must have existing MySQL database running and have loaded test data
# from examples/sql into your database before tests can be run. If not,
# most tests will fail.
test.run			yes
test.dir			${worksrcpath}/test
test.cmd			${ruby} run.rb

destroot.cmd		${ruby} -rvendor-specific setup.rb
destroot.target		install
destroot.destdir
pre-destroot {
	reinplace "s|${prefix}|${destroot}${prefix}|g" ${worksrcpath}/config.save
}
post-destroot {
	cd ${worksrcpath}
	xinstall -d -m 0755 ${destroot}${prefix}/share/doc/${name}
	set cmd "cp -R examples ${destroot}${prefix}/share/doc/${name}/examples"
	ui_info ${cmd}; system ${cmd}
	set cmd "cp -R docs ${destroot}${prefix}/share/doc/${name}/docs"
	ui_info ${cmd}; system ${cmd}
}

