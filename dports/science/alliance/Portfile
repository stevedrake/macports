# $Id$

PortSystem          1.0

name                alliance
version             5.0-20110203
license             GPL
set version_number  [lindex [split ${version} -] 0]
categories          science
maintainers         and.damore openmaintainer
description         Alliance, CAD and libraries for VLSI design
long_description    Alliance is a complete set of free CAD tools and portable libraries for \
                    VLSI design. It includes a VHDL compiler and simulator, logic synthesis \
                    tools, and automatic place and route tools. A complete set of portable \
                    CMOS libraries is provided
platforms           darwin
homepage            http://www-soc.lip6.fr/en/recherche/cian/alliance/

master_sites        ftp://asim.lip6.fr/pub/alliance/distribution/latest

checksums           sha1    a1a9f84b5120ea262c989fcf42a6131ee54d5ec7 \
                    rmd160  be9554ae1c84c1f6d4cd49bf19e2fe997d9ec27b

depends_lib         port:xpm \
                    port:openmotif \
                    port:libpng

worksrcdir          ${name}-${version_number}

patchfiles          patch-distrib-etc-Makefile.in.diff

use_parallel_build  no
configure.args-append --mandir=${prefix}/share/man
configure.env-append  YACC='/usr/bin/yacc'
destroot.env-append YACC='/usr/bin/yacc'

if {${configure.compiler} == "clang" ||
    ${configure.compiler} == "llvm-gcc-4.2"} {
    configure.compiler gcc-4.2
    if {[vercmp $xcodeversion 4.2] >= 0 || ![file executable ${configure.cc}]} {
        depends_build-append port:apple-gcc42
        configure.compiler apple-gcc-4.2
    }
}

post-destroot {
    file mkdir  ${destroot}${prefix}/share/alliance
    file rename ${destroot}${prefix}/doc        ${destroot}${prefix}/share/alliance
    file rename ${destroot}${prefix}/examples   ${destroot}${prefix}/share/alliance
    file rename ${destroot}${prefix}/tutorials  ${destroot}${prefix}/share/alliance
    file rename ${destroot}${prefix}/cells      ${destroot}${prefix}/share/alliance
}

platform darwin {
    patchfiles-append patch-xgra-src-XSB_parse.c.diff
}

livecheck.type      regex
livecheck.url       [lindex ${master_sites} 0]
livecheck.regex     ${name}-(\[0-9.-\]+)\\.tar
