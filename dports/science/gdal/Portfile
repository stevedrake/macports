# $Id$

PortSystem 1.0
name		gdal
version		1.5.1
maintainers	seanasy@gmail.com
platforms	darwin
description	GDAL - Geospatial Data Abstraction Library
long_description	GDAL is a translator library for raster geospatial \
			data formats that is released under an X/MIT style \
			Open Source license. As a library, it presents a \
			single abstract data model to the calling application \
			for all supported formats. The related OGR library \
			(which lives within the GDAL source tree) provides a \
			similar capability for simple features vector data. 
homepage	http://www.gdal.org/
master_sites	http://www.gdal.org/dl/
categories		science
checksums		md5 76b53917142c5e9ad2d0ac20fb99890b

depends_lib	port:zlib port:libpng port:tiff port:libgeotiff port:jpeg \
			port:giflib port:proj

configure.args	--without-python --with-libz=${prefix} --with-png=${prefix} \
	--with-libtiff=${prefix} --with-geotiff=${prefix} --with-jpeg=${prefix} \
	--with-gif=${prefix} --without-pg --without-mysql --without-sqlite \
	--mandir=${prefix}/share/man --with-static-proj4=${prefix} --without-macosx-framework

# Patch to ensure that the python installation respects DESTDIR
patchfiles	patch-swig_python_GNUmakefile

# Set target to none
build.target

variant python24 {
	depends_lib-append		port:python24 \
					port:py-numpy
	configure.args-append		--with-python
	build.args-append		PYTHON=python2.4
}

variant python25 {
	depends_lib-append		port:python25 \
					port:py25-numpy
	configure.args-append		--with-python
	build.args-append		PYTHON=python2.5
}

variant geos {
	depends_lib-append		port:geos
	configure.args-append	--with-geos=${prefix}/bin/geos-config
}

variant hdf5 {
	depends_lib-append		port:hdf5
	configure.args-append	--with-hdf5=${prefix}
}

variant postgresql81 {
	depends_lib-append		port:postgresql81
	configure.args-delete	--without-pg
	configure.args-append	--with-pg=${prefix}/lib/postgresql81/bin/pg_config
}

variant postgresql82 {
	depends_lib-append		port:postgresql82
	configure.args-delete	--without-pg
	configure.args-append	--with-pg=${prefix}/lib/postgresql82/bin/pg_config
}

variant postgresql83 {
	depends_lib-append		port:postgresql83
	configure.args-delete	--without-pg
	configure.args-append	--with-pg=${prefix}/lib/postgresql83/bin/pg_config
}

variant sqlite3 {
	depends_lib-append		port:sqlite3
	configure.args-delete	--without-sqlite
	configure.args-append	--with-sqlite=${prefix}
}

variant framework {
	configure.args-append	--with-macosx-framework
}

post-destroot {
	xinstall -m 755 -d ${destroot}${prefix}/share/doc/${name}
	xinstall -m 644 -W ${worksrcpath} HOWTO-RELEASE NEWS VERSION \
		${destroot}${prefix}/share/doc/${name}
}
