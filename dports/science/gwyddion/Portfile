# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                gwyddion
version             2.13
categories          science x11
platforms           darwin
maintainers         rowue@macports.org yeti@gwyddion.net
description         Software for SPM Analysis

long_description \
    Gwyddion is a modular program for SPM (scanning probe microscopy) data \
    visualization and analysis. It uses gtk2 for the user interface.

homepage            http://gwyddion.net
master_sites        sourceforge
use_bzip2           yes
use_parallel_build  yes

checksums           md5     80c46b574d75c14fa3c0c2f863ebad0d \
                    sha1    ff383d15ee464c6c777770702e8a70c90a959b90 \
                    rmd160  7ba6e89828176d5d181b0256df3272283bb6a1d5

depends_lib         port:gtk2 \
                    port:libxml2 \
                    port:fftw-3

configure.args      --disable-desktop-file-update --without-gl

if {![variant_isset system_x11]} {
    configure.cflags-append     "-I${x11prefix}/include"
    configure.ldflags-append    "-L${x11prefix}/lib"
}

if {[variant_isset system_x11]} {
    default_variants    +system_x11
}


# deactivation because of gtkglext problems
# platform darwin 9 {
#     if {[variant_isset system_x11]} {
#         set darwin_9_glpath   /System/Library/Frameworks/OpenGL.framework/Versions/
#         configure.ldflags-append -Wl,-dylib_file,${darwin_9_glpath}/A/Libraries/libGL.dylib:\
#         ${darwin_9_glpath}/A/Libraries/libGL.dylib
#     }
# }

platform darwin 8 {
    if {[variant_isset system_x11]} {
        depends_lib-append      port:gtkglext
        configure.args-delete  --without-gl
    }
}

variant system_x11 description {Using system X11 libraries} {
    # dummy
}

post-activate {
        system "${prefix}/bin/update-mime-database ${prefix}/share/mime ; true"
}
