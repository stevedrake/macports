# -*- coding: utf-8; mode: tcl; c-basic-offset: 4; indent-tabs-mode: nil; tab-width: 4; truncate-lines: t -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                hdf5
version             1.6.7
categories          science
maintainers         nomaintainer

description         HDF5 general purpose library and file format for storing scientific data
long_description    ${description}
homepage            http://www.hdfgroup.org/HDF5/
master_sites        ftp://ftp.hdfgroup.org/HDF5/current16/src/
checksums           md5 79027c67188e2e4131c5573771f477ce \
                    sha1 9c26fe09cdad269c9a6757933f70ca164a47b8e8 \
                    rmd160 2dbbcccd32986dcd66ce804c5e90ac6c949b71f6

depends_lib         port:zlib				
patchfiles	        patch-commence.in patch-c-commence.in

use_parallel_build  yes
gconfigure.args      --enable-cxx --with-zlib=yes --with-szlib=no 
configure.ldflags   "-L${worksrcpath}/src/.libs -L${prefix}/lib"
destroot.destdir    prefix=${destroot}${prefix}
test.run            yes
test.target         check

variant szip {
    configure.args-delete	--with-szlib=no
	configure.args-append	--with-szlib=yes
	depends_lib-append	    port:szip
}

variant gcc43 description "Use GCC 4.3 for compilation of HDF-5 - optimized for host machine (+ Fotran support)" {
    depends_build-append        port:gcc43
    configure.args-append       --enable-fortran
    configure.compiler          macports-gcc-4.3
    configure.cflags-append     "-ftree-vectorize -march=native -O3"
    configure.cxxflags-append   "-ftree-vectorize -march=native -O3"
}
