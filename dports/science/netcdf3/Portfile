# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 32277 2007-12-23 15:14:56Z ryandesign@macports.org $

PortSystem                  1.0
name                        netcdf3
version                     3.6.2
maintainers                 takeshi
platforms                   darwin
categories                  science
distname                    netcdf-${version}
description                 NetCDF - Network Common Data Form
long_description \
    NetCDF is an interface for array-oriented data access           \
    and a library that provides an implementation of the interface. \
    The netCDF library also defines a machine-independent format    \
    for representing scientific data. Together, the interface,      \
    library, and format support the creation, access,               \
    and sharing of scientific data. The netCDF software was         \
    developed at the Unidata Program Center in Boulder, Colorado.

homepage                    http://unidata.ucar.edu/packages/netcdf/

master_sites                ftp://ftp.unidata.ucar.edu/pub/netcdf/ \
                            http://www.gfd-dennou.org/arch/netcdf/unidata-mirror/ \
                            ftp://www.gfd-dennou.org/arch/netcdf/unidata-mirror/
dist_subdir                 netcdf
checksums                   md5    1eca0ea1e81e14ebc5bb93e5dd25c364         \
                            sha1   ff2d11d2708df08a2370999b19e2c277607afc06 \
                            rmd160 2525b9186490050407422693ba0ede7e0497e212
use_bzip2                   yes

configure.cppflags-append   "-DNDEBUG -Df2cFortran"
configure.cxxflags-append   "-fno-common"
configure.cflags-append     "-fno-common"
configure.args              --prefix=${prefix}/lib/${name} --enable-shared

test.run                    yes
test.target                 check

destroot.destdir            prefix=${destroot}${prefix}/lib/${name} \
                            MANDIR=\\\${prefix}/lib/${name}/share/man

post-destroot {
    file delete -force ${destroot}${prefix}/share/man/whatis.db
}

variant g95 conflicts gcc43 description {enable fortran support with g95} {
    depends_lib             port:g95
    configure.fc            ${prefix}/bin/g95
    configure.env-append    FCFLAGS=-O2
}

variant gcc43 conflicts g95 description {enable fortran support with gfortran} {
    depends_lib             port:gcc43
    configure.fc            ${prefix}/bin/gfortran-mp-4.3
    configure.env-append    FCFLAGS=-O2
}
