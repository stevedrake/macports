# -*- coding: utf-8; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                weka
version             3.6.1
maintainers         mnick

categories          science java
description         Weka is a collection of machine learning algorithms for data mining tasks implemnted in java
long_description    ${description}. \
                    The algorithms can either be applied directly to a dataset or called from \
                    your own Java code. Weka contains tools for data pre-processing, classification, \
                    regression, clustering, association rules, and visualization. It is also \
                    well-suited for developing new machine learning schemes.
license             GPL

platforms           darwin

homepage            http://www.cs.waikato.ac.nz/ml/weka/
master_sites        sourceforge
use_zip             yes
distname            ${name}-3-6-1

checksums           md5     8a50b593ea0db4c45c163332ad2af799 \
                    sha1    4a1dfacb85edeb101b5aa942d152eb24d5f22c10 \
                    rmd160  87ff849025a1d0074f7b9f5b17c7678356a8522b

patchfiles          patch-build.xml.diff

use_configure       no
depends_build       port:jarbundler \
                    bin:ant:apache-ant

build.env-append    CLASSPATH=${prefix}/share/java/jarbundler.jar
build.cmd           ant
build.args          "compile release_sub_tasks osx_application"
build.pre_args      -Drelease='3-6-1'

post-extract {
    system "cd ${worksrcpath} && jar xf ./weka-src.jar"
    file copy ${portpath}/${filesdir}/weka_icon.icns ${worksrcpath}/src/main/java/weka/gui
}

pre-build {
    reinplace "s|wekadocs|${worksrcdir}|g" ${worksrcpath}/build.xml
}

destroot {
    file copy ${worksrcpath}/osx-distrib/weka-3-6-1.app ${destroot}${applications_dir}/Weka.app
}

# only check even minor versions for stable releases
livecheck.type     regex
livecheck.url       http://sourceforge.net/export/rss2_projfiles.php?project=weka
livecheck.regex     <title>${name}-\\d-\\d*\[24680\] (\\d.*) released .*</title>
