# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem			1.0

name				stunnel
version				4.27
categories			security net
maintainers			nomaintainer
description			SSL tunneling program
long_description	Stunnel is a program that allows you to encrypt arbitrary \
					TCP connections inside SSL (Secure Sockets Layer) available \
					on both Unix and Windows. Stunnel can allow you to secure \
					non-SSL aware daemons and protocols (like POP, IMAP, LDAP, \
					etc) by having Stunnel provide the encryption, requiring no \
					changes to the daemon's code.
platforms			darwin
homepage			http://www.stunnel.org/
master_sites		${homepage}download/stunnel/src/ \
                    ftp://stunnel.mirt.net/stunnel/
checksums           md5     3c655d815576f50046a1c28744b88681 \
                    sha1    2daf52fb0906de9fc5bd6a270e620e9316034fd4 \
                    rmd160  a0beb4dffbc40c5c4452af767840d6fa703868c9
depends_lib			bin:openssl:openssl
patchfiles			patch-configure \
					patch-tools-stunnel.cnf
configure.args		--mandir=${prefix}/share/man \
					--disable-libwrap
default_variants	+libwrap

post-destroot {
	# Create the ${prefix}/var/lib/stunnel directory.
	xinstall -d -m 770 "${destroot}${prefix}/var/lib/stunnel/"
	system "touch ${destroot}${prefix}/var/lib/stunnel/.turd"

	# Tell the user about the stupid fake certificate that we provide.
	ui_msg "A fake certificate has been installed as ${prefix}/etc/stunnel/stunnel.pem"
}

# This (default) variant will include libwrap feature.
# libwrap has been reported to introduce some problems with stunnel 4.18.
# See: http://svn.macosforge.org/projects/macports/ticket/11028
variant libwrap {
	configure.args-delete	"--disable-libwrap"
}
