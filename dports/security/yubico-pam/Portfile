# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id $

PortSystem      1.0
PortGroup       github 1.0

github.setup    Yubico yubico-pam 2.10
checksums       rmd160  ce0e375645a59c782224f248b5f9e5c906737630 \
                sha256  41fc3bcf8201cb348c3232b0c760e311d31713960201c10c880aab19ee3d550f

# I'm explicitly not marking this openmaintainer
maintainers     cal

categories      security
description     PAM module to authenticate against a Yubikey validation server or \
                via challenge-response against a local yubikey
long_description \
                The Yubico PAM module provides an easy way to integrate the Yubikey \
                into your existing user authentication infrastructure. The module can \
                be configured to validate Yubikeys against Yubico's YubiCloud \
                infrastructure, a custom Yubikey validation server or it can be used \
                for offline authentication with newer Yubikeys supporting a \
                challenge-response protocol.

platforms       darwin
license         BSD

patchfiles      pam_yubico.c.patch \
                util.c.patch \
                util.h.patch \
                Makefile.am.patch

variant debug description {Build with debugging support} {
    patchfiles-delete \
                util.h.patch \
                Makefile.am.patch
}

default_variants +debug

depends_lib     port:ykpers \
                port:yubico-c-client

use_autoreconf  yes

configure.args  --with-pam-dir=/usr/lib/pam \
                --without-ldap

destroot.violate_mtree \
                yes

post-destroot {
    file delete ${destroot}/usr/lib/pam/pam_yubico.la
}

