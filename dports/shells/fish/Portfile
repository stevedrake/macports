# $Id$

PortSystem 1.0

name                    fish
version                 1.22.3
revision                1
categories              shells
platforms               darwin
maintainers             eridius@macports.org openmaintainer
description             user friendly command line shell for UNIX-like operating systems
long_description        fish is a user friendly command line shell for UNIX-like \
                        operating systems like Darwin.

homepage                http://www.fishshell.org/
master_sites            http://www.fishshell.org/files/${version}/
checksums               md5 016a5944861ea48e363521c240834415
use_bzip2               yes

livecheck.check         regex
livecheck.regex         fish-(.*?).tar.bz2

depends_build   bin:doxygen:doxygen
depends_lib     lib:libiconv:libiconv lib:libncurses:ncurses lib:libintl:gettext

configure.args  --mandir=${prefix}/share/man --without-xsel

platform darwin 8 {
    # there's something wonky about the libiconv headers installed by
    # macports that prevents autoconf from detecting libiconv, so i
    # have to fake it. See
    # <http://permalink.gmane.org/gmane.comp.shells.fish.user/1217>
    # for details.
    pre-configure {
        reinplace "s|AC_SEARCH_LIBS( iconv_open|#AC_SEARCH_LIBS( iconv_open|g" "${worksrcpath}/configure.ac"
    }
    post-configure {
        reinplace "s|LDFLAGS= |LDFLAGS= -liconv |g" "${worksrcpath}/Makefile"
    }
    configure.compiler	gcc-4.0
}

variant xsel description "enable xsel support, only appropriate for use within X11" {
    configure.args-delete --without-xsel
}
