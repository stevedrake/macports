# $Id: Portfile,v 1.1 2006/01/29 19:31:35 olegb Exp $

PortSystem        1.0
name              FDclone
version           2.08
categories        sysutils
maintainers       tatyana-dports@miko.org
description       File & Directory Maintenance Tool
long_description  ${description}
homepage          http://hp.vector.co.jp/authors/VA012337/soft/fd/index.html
master_sites      http://hp.vector.co.jp/authors/VA012337/soft/fd/
distfiles         FD-${version}.tar.gz
checksums	  md5 05dcbd962a5c58c0ddeb08cd0bc032b9 \
		  sha1 f4813658eae221dec1b769bc7008816b69629591 \
		  rmd160 c99c39bcd24c23326bc902240031032b1a839a2c

worksrcdir        FD-${version}
patchfiles	  nojmaninstall.patch
post-patch	  {
		  reinplace "s|\$(TOPDIR)/man|\$(TOPDIR)/share/man|g" ${worksrcpath}/Makefile.in

		  if {[variant_isset nojpnmes]} {
		     system "echo \"#define _NOJPNMES\" >> ${worksrcpath}/config.hin"
		  }

		  if {[variant_isset emacs]} {
		     reinplace "s|\"vi\"|\"emacs\"|g" ${worksrcpath}/fd.h
		  }

		  if {[variant_isset lv]} {
		     reinplace "s|\"more%K\"|\"lv\"|g" ${worksrcpath}/fd.h
		  }

		  if {[variant_isset less]} {
		     reinplace "s|\"more%K\"|\"less\"|g" ${worksrcpath}/fd.h
		  }

		  if {[variant_isset jless]} {
		     reinplace "s|\"more%K\"|\"jless\"|g" ${worksrcpath}/fd.h
		  }

		  if {[variant_isset autosort]} {
		     reinplace "s|SORTTYPE\t0|SORTTYPE\t1|" ${worksrcpath}/fd.h
		     reinplace "s|DISPLAYMODE\t0|DISPLAYMODE\t3|" ${worksrcpath}/fd.h
		     reinplace "s|SORTTREE\t0|SORTTREE\t1|" ${worksrcpath}/fd.h
		  }
}
configure	  {}
build.args	  CONFDIR=${prefix}/etc PREFIX=${prefix}
destroot.args	  BUILD=${destroot} PREFIX=${prefix}

post-destroot   {
                xinstall -m 755 -d ${destroot}${prefix}/share/doc/${name}

                eval xinstall -m 644 [glob ${worksrcpath}/FAQ*] ${destroot}${prefix}/share/doc/${name}
                eval xinstall -m 644 [glob ${worksrcpath}/HISTORY*] ${destroot}${prefix}/share/doc/${name}
                eval xinstall -m 644 [glob ${worksrcpath}/Install*] ${destroot}${prefix}/share/doc/${name}
                eval xinstall -m 644 [glob ${worksrcpath}/LICENSES*] ${destroot}${prefix}/share/doc/${name}
                eval xinstall -m 644 [glob ${worksrcpath}/README*] ${destroot}${prefix}/share/doc/${name}
                eval xinstall -m 644 [glob ${worksrcpath}/TECHKNOW*] ${destroot}${prefix}/share/doc/${name}
                eval xinstall -m 644 [glob ${worksrcpath}/ToAdmin*] ${destroot}${prefix}/share/doc/${name}
}

variant nojpnmes {}
variant emacs {}
variant lv conflicts less conflicts jless {}
variant less conflicts lv conflicts jless {}
variant jless conflicts lv conflicts less {}
variant autosort {}
