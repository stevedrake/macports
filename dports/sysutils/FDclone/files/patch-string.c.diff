--- string.c.orig	2010-05-29 00:00:00.000000000 +0900
+++ string.c	2010-05-30 02:06:50.000000000 +0900
@@ -43,7 +43,10 @@
 {
 	for (; n-- > 0; s++) {
 		if (*s == c) return((char *)s);
-		else if (iswchar(s, 0)) s++;
+		else if (iswchar(s, 0)) {
+			if (n-- <= 0) break;
+			s++;
+		}
 	}
 
 	return(NULL);
