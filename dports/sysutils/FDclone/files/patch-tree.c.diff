--- tree.c.orig	2010-02-27 00:00:00.000000000 +0900
+++ tree.c	2010-05-13 22:55:09.000000000 +0900
@@ -852,7 +852,7 @@
 		path = _tree();
 	} while (path == fullpath);
 #ifdef	DEP_PSEUDOPATH
-	if (drvp && (*drvp = preparedrv(path, NULL, NULL)) < 0) {
+	if (drvp && path && (*drvp = preparedrv(path, NULL, NULL)) < 0) {
 		warning(-1, path);
 		Xfree(path);
 		path = NULL;
