# $Id: Portfile,v 1.1 2004/04/18 11:31:51 landonf Exp $
BROKEN			Not fully ported, throw an error for portindex
PortSystem 1.0
name			apt
version			0.5.24
platforms		darwin
categories		sysutils
maintainers		landonf@opendarwin.org
description		Advanced front-end for dpkg
long_description	Apt is Debian's next generation front-end for the \
			dpkg package manager. It provides the apt-get utility \
			and APT dselect method that provides a simpler, safer \
			way to install and upgrade packages.
homepage		http://www.debian.org/

master_sites		http://ftp.debian.org/debian/pool/main/a/apt/
checksums		md5 06f385f2317b633fd454b17a63290c1a
distname		${portname}_${portversion}
worksrcdir		${portname}-${portversion}

patchfiles		ostable.diff \
			soname-magic.diff

# Work around case insensitive file system issues
configure.cmd		../configure
configure.dir		${worksrcpath}/build
pre-configure		{ file mkdir ${worksrcpath}/build }

configure.env		CPPFLAGS="-I${prefix}/include -no-cpp-precomp" \
			CFLAGS="-L${prefix}/lib" LDFLAGS="-L${prefix}/lib" \
			CXXFLAGS="-D__USE_MISC"
configure.args		--without-sgml-doc --disable-rpath

### Target Overrides ###
post-patch {
	reinplace s|@PREFIX@|${prefix}|g \
			${worksrcpath}/buildlib/environment.mak.in
}

### Operating System Variants ###
variant darwin {
	depends_lib		lib:libintl.3:gettext
	# c++pragma.diff generated with the following, provided by
	# Peter O'Gorman:
	# for i in `grep -rl '#ifdef __GNUG__' .` ; do perl -pi -e 's/#ifdef
	# __GNUG__/#if defined(__GNUG__) && !defined(__APPLE_CC__)/' $i; done
	patchfiles-append	sig_t.diff \
				c++pragma.diff \
				darwinshlibs-hack.diff \
				use-libintl.diff
}

variant freebsd {
	depends_lib		lib:libintl.3:gettext
	patchfiles-append	sig_t.diff \
				use-libintl.diff
}
