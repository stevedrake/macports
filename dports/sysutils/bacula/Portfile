# $Id$

PortSystem 1.0

name			bacula
version			2.2.6
categories		sysutils
platforms		darwin
maintainers		nomaintainer
description		network based backup program
long_description	Bacula is a set of computer programs that permit you to \
			manage backup, recovery, and verification of computer data across \
			a network of computers of different kinds.

homepage		http://www.bacula.org/
master_sites	sourceforge
checksums		sha1 fc2f2d7605bd493b7d8b8423a0cbb24099674303

depends_build	port:gawk
depends_lib		port:zlib port:sqlite3 port:openssl port:libiconv port:gettext port:ncurses port:cdrtools

configure.args	--mandir=${prefix}/share/man --with-pid-dir=${prefix}/var/run \
				--with-subsys-dir=${prefix}/var/run/subsys \
				--sysconfdir=${prefix}/etc/${name} \
				--with-libintl-prefix=${prefix} --with-openssl=${prefix} \
				--with-libiconv-prefix=${prefix} --with-sqlite3=${prefix} \
				--archivedir=/var/tmp \
				--enable-smartalloc --enable-largefile \
				--without-postgresql --without-mysql \
				--disable-gnome --disable-wx-console --disable-tray-monitor 
configure.cppflags-append	-I${prefix}/ncurses
configure.ldflags-append	-lncurses

destroot.keepdirs	${destroot}${prefix}/var/run/subsys \
				${destroot}${prefix}/var/bacula/working

platform darwin 8 {
	configure.compiler	gcc-4.0
}

startupitem.create	yes
startupitem.init	\
"BIN=${prefix}/sbin/bacula-fd\nPID=${prefix}/var/run/bacula-fd.*.pid"
startupitem.start	\
"\[ -x \${BIN} \] && \${BIN} -c ${prefix}/etc/bacula/bacula-fd.conf"
startupitem.stop	\
"\[ -r \${PID} \] && /bin/kill \$(cat \${PID})"

