# $Id$

PortSystem 1.0
PortGroup	archcheck 1.0

name	    	cdrtools
version		2.01.01a77
categories  	sysutils
platforms		darwin
description     ISO 9660 filesystem and CD creation tools
long_description	The cdrtools software includes programs to create \
		 	and/or extract ISO 9660 filesystems, verify their \
			integrity, and write them to a disc. \
			Note, this port conflicts with the dvdrtools port.
homepage	http://cdrecord.berlios.de/old/private/cdrecord.html
maintainers	gmail.com:bytestorm openmaintainer
master_sites    ftp://ftp.berlios.de/pub/cdrecord/alpha/ \
		ftp://ftp.cs.tu-berlin.de/pub/misc/cdrecord/alpha/
checksums           md5     0564e79a18d9a6768dbbb02a7717c5ab \
                    sha1    ac15fefd0089e6125e5bf6198b222522ba94e8f5 \
                    rmd160  0fee3b8c9fab0462f9fd7dd4ed965a013c8f82e0

use_bzip2	yes

worksrcdir	cdrtools-2.01.01

depends_build	port:smake

depends_lib	port:gettext

archcheck.files	lib/libintl.dylib

post-patch {
	reinplace "s|/opt/schily|${prefix}|g" \
		${worksrcpath}/DEFAULTS/Defaults.darwin \
		${worksrcpath}/DEFAULTS/Defaults.mac-os10 \
		${worksrcpath}/DEFAULTS_ENG/Defaults.darwin \
		${worksrcpath}/DEFAULTS_ENG/Defaults.mac-os10 \
		${worksrcpath}/libfind/find.c \
		${worksrcpath}/libfind/find_main.c \
		${worksrcpath}/librscg/scsi-remote.c \
		${worksrcpath}/TEMPLATES/Defaults.gcc
}

use_configure	no

build.cmd	smake

use_parallel_build no

destroot.args   DEFINSUSR=root DEFINSGRP=wheel INS_BASE=${prefix} MANDIR=share/man

livecheck.url   ftp://ftp.berlios.de/pub/cdrecord/alpha/
livecheck.regex "${name}-((\\d+(?:\\.\\d+)*)a(\\d+))${extract.suffix}"
