# $Id: Portfile,v 1.9 2004/12/09 23:55:27 landonf Exp $

PortSystem 1.0
name			dpkg
version			1.10.25
revision		1
platforms		darwin
categories		sysutils archivers
maintainers		landonf@opendarwin.org
description		Debian package maintenance system
homepage		http://www.debian.org/

master_sites		http://ftp.debian.org/debian/pool/main/d/dpkg/
checksums		md5 cf5f5fe6cc7a9a55b9add607f6e3d841

# Use darwinports versions explicitly
depends_lib		lib:XXXlibintl.3:gettext \
			lib:XXXlibiconv.2:libiconv

distname		${portname}_${portversion}
worksrcdir		${portname}-${portversion}

patchfiles		patch-config.h.in \
			patch-configure.in \
			patch-configure \
			patch-lib_utils.c \
			patch-utils_Makefile.in

configure.args		--without-sgml-doc --with-libintl-prefix=${prefix} \
			--with-libiconv-prefix=${prefix}

post-patch {
	set scripts ${worksrcpath}/scripts
	reinplace s|/etc/dpkg/|${prefix}/etc/dpkg/| \
			${scripts}/dpkg-shlibdeps.pl \
			${scripts}/dpkg-source.1

	reinplace s|/etc/|${prefix}/etc/| \
			${scripts}/update-alternatives.8

	reinplace s|/etc/alternatives|${prefix}/etc/alternatives|g \
			${scripts}/update-alternatives.pl
}

pre-destroot {
	file mkdir ${destroot}${prefix}/share/doc/dpkg
}

variant darwin {
	patchfiles-append patch-utils_start-stop-daemon.c
}

