# $Id$

PortSystem 1.0

name			fcron
version			3.0.1
categories		sysutils
platforms		darwin
maintainers		nomaintainer@macports.org
description		fcron is an alternative scheduler aka cron daemon
long_description	fcron is a scheduler. It aims at replacing Vixie Cron, so \
					it implements most of its functionalities. But contrary to \
					Vixie Cron, fcron does not need your system to be up 7 \
					days a week, 24 hours a day : it also works well with \
					systems which are not running neither all the time nor \
					regularly (contrary to anacrontab).

homepage		http://fcron.free.fr/
master_sites	${homepage}/archives/
distname		${distname}.src
checksums		sha1 2c4bb80af3816fad20b6cd1f833d23dd3085328b
patchfiles		patch-configure

worksrcdir		${name}-${version}

configure.args	--with-etcdir=${prefix}/etc \
				--with-piddir=${prefix}/var/run/fcron \
				--with-fifodir=${prefix}/var/run/fcron \
				--with-spooldir=${prefix}/var/spool/fcron \
				--with-boot-install=no \
				--with-pam=no

startupitem.create	yes
startupitem.name	fcron
startupitem.start	"\[ -x ${prefix}/sbin/fcron \] && ${prefix}/sbin/fcron -b"
startupitem.stop	"\[ -r ${prefix}/var/run/fcron/fcron.pid \] \\" \
					"&& kill -KILL `cat ${prefix}/var/run/fcron/fcron.pid`"

pre-destroot	{
	# add user:group 'fcron:fcron'
	addgroup fcron
	set gid [existsgroup fcron]
	adduser fcron shell=/bin/sh gid=${gid} \
			home=${prefix}/var/run/fcron realname=fcron\ Server
}
post-destroot {
	set dp ${destroot}${prefix}
	xinstall -m 755 -d ${dp}/var/run/fcron/ ${dp}/var/spool/fcron
	system "touch ${dp}/var/spool/fcron/fcron ${dp}/var/run/fcron/fcron.pid"
	file attributes ${dp}/var/spool/fcron -owner fcron -group fcron
	file attributes ${dp}/var/spool/fcron/fcron -owner fcron -group fcron
	file attributes ${dp}/var/run/fcron/fcron.pid -owner root -group wheel
}

platform darwin 8 {
	configure.env CC=/usr/bin/gcc-4.0 CPP=/usr/bin/cpp-4.0 CXX=/usr/bin/g++-4.0
}

