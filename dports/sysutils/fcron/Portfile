# $Id$

PortSystem 1.0

name			fcron
version			3.0.2
categories		sysutils
platforms		darwin
maintainers		nomaintainer
description		fcron is an alternative scheduler aka cron daemon
long_description	fcron is a scheduler. It aims at replacing Vixie Cron, so \
					it implements most of its functionalities. But contrary to \
					Vixie Cron, fcron does not need your system to be up 7 \
					days a week, 24 hours a day : it also works well with \
					systems which are not running neither all the time nor \
					regularly (contrary to anacrontab).

homepage		http://fcron.free.fr/
master_sites	${homepage}/archives/
worksrcdir		${distname}
distname		${distname}.src
checksums		md5 f35e6af41d356ebcb38882f86a14fb94 \
				sha1 76df8bdfb874df78e81885eca90f1b9c91b0bd24 \
				rmd160 822f559550780c61c5822f4034fe99dd47577847
patchfiles		patch-configure


configure.args	--with-etcdir=${prefix}/etc \
				--with-piddir=${prefix}/var/run/fcron \
				--with-fifodir=${prefix}/var/run/fcron \
				--with-spooldir=${prefix}/var/spool/fcron \
				--with-boot-install=no \
				--with-pam=no

startupitem.create	yes
startupitem.name	fcron
startupitem.start	"\[ -x ${prefix}/sbin/fcron \] && ${prefix}/sbin/fcron -b"
startupitem.stop	"\[ -r ${prefix}/var/run/fcron/fcron.pid \] \\" \
					"&& kill -KILL `cat ${prefix}/var/run/fcron/fcron.pid`"

pre-destroot	{
	# add user:group 'fcron:fcron'
	addgroup fcron
	set gid [existsgroup fcron]
	adduser fcron shell=/bin/sh gid=${gid} \
			home=${prefix}/var/run/fcron realname=fcron\ Server
}
post-destroot {
	set dp ${destroot}${prefix}
	xinstall -m 755 -d ${dp}/var/run/fcron/ ${dp}/var/spool/fcron
	system "touch ${dp}/var/spool/fcron/fcron ${dp}/var/run/fcron/fcron.pid"
	file attributes ${dp}/var/spool/fcron -owner fcron -group fcron
	file attributes ${dp}/var/spool/fcron/fcron -owner fcron -group fcron
	file attributes ${dp}/var/run/fcron/fcron.pid -owner root -group wheel
}

platform darwin 8 {
	configure.compiler	gcc-4.0
}

