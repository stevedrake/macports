# $Id$

PortSystem              1.0

name                    gnuregex
set my_name             regex
version                 0.12
revision                2
categories              sysutils
maintainers             nomaintainer
homepage                http://www.gnu.org/directory/regex.html
platforms               darwin

description             GNU regex library
long_description        $description

master_sites            http://ftp.gnu.org/old-gnu/${my_name}/ \
                        ftp://ftp.gnu.org/old-gnu/${my_name}/

distname                ${my_name}-${version}
checksums               md5 6c25ca10e71adeede101e7646e796ebd

build.args              subdirs=test
post-build {
    set command "libtool -lSystem -dynamic -install_name ${prefix}/lib/libgnuregex.dylib -o libgnuregex.dylib regex.o"
    ui_info "$command"
    system "cd ${worksrcpath} && $command"
}

test.run                yes
test.args               ${build.args}
test.target             check

destroot {
    xinstall -m 755 -d ${destroot}${prefix}/include
    xinstall -m 644 ${worksrcpath}/regex.h ${destroot}${prefix}/include/gnuregex.h
    xinstall -m 755 ${worksrcpath}/libgnuregex.dylib ${destroot}${prefix}/lib
}

# Newer versions of GNU regex are available in the GNU libc tarball
# in the files posix/regex.c and posix/regex.h.
livecheck.check         none
