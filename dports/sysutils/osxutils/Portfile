# $Id: Portfile,v 1.12 2004/09/01 22:56:38 matt Exp $

PortSystem 1.0
name		osxutils
version		1.4
categories	sysutils
maintainers	waqar@opendarwin.org
description	Command line utilities for Finder commands
long_description	\
	osxutils is a package of potentially useful Mac-oriented command \
	line utilities for MacOS X version 10.0 or later. These tools \
	represent an effort in bringing command line control over certain \
	aspects of the MacOS, in particular file meta-data such as Finder \
	flags, heritage file Type and Creator codes, comments and \
	suffixes/file extensions.
homepage        http://sourceforge.net/projects/osxutils/
platforms	macosx
master_sites    sourceforge
extract.suffix	.tgz
distname	${name}-${version}-src
checksums	md5 d4592eb8d9d6d5e216bfd58f4c49d488
use_configure   no
build.type	pbx
build.target
set b_progs	"fileinfo geticon lsmac mkalias setfcomment setfctypes setfflags seticon setlabel setsuffix"
set i_progs	"cpath google trash"
patchfiles	patch-project.pbxproj.diff

configure	{
	reinplace "s|main.c|setfcomment.c|g"	\
		${worksrcpath}/setfcomment/setfcomment.pbproj/project.pbxproj
	reinplace "s|main.c|setlabel.c|g"	\
		${worksrcpath}/setlabel/setlabel.xcode/project.pbxproj

	foreach	man1File [glob ${worksrcpath}/*/*1] {
		reinplace "s|/usr/local|${prefix}|g" \
		${man1File}
	}

	foreach	projectfile [glob ${worksrcpath}/*/*/*.pbxproj] {
		reinplace "s|/usr/share/man|${prefix}/share/man|g" \
		${projectfile}
	}
}
build		{
	foreach prog ${b_progs} {
		cd ${worksrcpath}/${prog}
		system "${build.cmd} build"
	}
}	

destroot.destdir

destroot	{
	foreach prog ${i_progs} {
		system "cd ${worksrcpath}/${prog} && install -m 755 \
			${prog} ${destroot}${prefix}/bin/" 
		system "cd ${worksrcpath}/${prog} && install -m 644 \
			${prog}.1 ${destroot}/${prefix}/share/man/man1/"
	}
	foreach prog ${b_progs} {
		system "cd ${worksrcpath}/${prog} && ${build.cmd} install \
			INSTALL_PATH=${prefix}/bin DSTROOT=${destroot}"
	}
}

