# $Id$

PortSystem 1.0

name            tmux
version         1.0
revision        3
categories      sysutils
maintainers     toby
description     terminal multiplexer
long_description \
    tmux is a \"terminal multiplexer\", it enables a number of terminals \
    (or windows) to be accessed and controlled from a single terminal. \
    tmux is intended to be a simple, modern, BSD-licensed alternative \
    to programs such as GNU screen.
homepage        http://sourceforge.net/projects/tmux/
platforms       darwin
license         BSD
master_sites    sourceforge
checksums       md5 716b12d9ea052f57d917bf2869d419df \
                sha1 62bbea17e54cdacb48442e25eddf0463ab69ba61 \
                rmd160 3176447bf21dd1d5559d256ee3786d13771c20af

depends_lib     port:ncurses

patchfiles      GNUmakefile.diff \
                osdep-darwin.c.diff \
                server.c.diff \
                tmux.1.diff \
                tmux.h.diff

post-configure {
    reinplace "s|__PREFIX__|${prefix}|g" "${worksrcpath}/GNUmakefile" "${worksrcpath}/tmux.1" "${worksrcpath}/tmux.h"
    reinplace "s|__CC__|${configure.cc}|" "${worksrcpath}/GNUmakefile"
    reinplace "s|__CFLAGS__|${configure.cflags}|" "${worksrcpath}/GNUmakefile"
    reinplace "s|__LDFLAGS__|${configure.ldflags}|" "${worksrcpath}/GNUmakefile"
}

post-destroot {
    xinstall -m 0755 -d ${destroot}${prefix}/share/doc/tmux
    foreach file [glob ${worksrcpath}/examples/*] {
        xinstall -m 0644 $file ${destroot}${prefix}/share/doc/tmux
    }
}

variant screen description "behave more like screen" {
    post-destroot {
        xinstall -m 0644 ${worksrcpath}/examples/screen-keys.conf ${destroot}${prefix}/etc/tmux.conf
    }
}

livecheck.regex  tmux tmux-(\[^ \]+) released
