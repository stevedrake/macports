# $Id: Portfile,v 1.10 2005/08/25 03:34:33 jmpp Exp $

PortSystem 1.0
name		yum
version		2.2.2
revision	0
platforms	darwin
categories	sysutils archivers
maintainers	n3npq@mac.com
description	Automatic updater and package installer/remover for RPM
long_description	Yum is an automatic updater and package installer/remover for \
			rpm systems. It automatically computes dependencies and figures \
			out what things should occur to install packages. It makes it \
			easier to maintain groups of machines without having to manually \
			update each one using rpm.
homepage	http://linux.duke.edu/projects/yum/
master_sites	${homepage}download/2.2/
checksums	md5 734cc68e26c2fd07629616ab597acac6

patchfiles	patch-prefix.diff

depends_lib	lib:librpm:rpm	port:python24

patch {
		foreach patch $patchfiles {
			system "cd '${workpath}/${distname}' && \
			sed -e 's#@@PREFIX@@#${prefix}#g' '${portpath}/${filesdir}/${patch}' | patch -p0"
		}
		file delete ${workpath}/${distname}/INSTALL
		system "echo 'exit 0' > '${workpath}/${distname}/configure' && chmod +x '${workpath}/${distname}/configure'"
}

build.env	PYTHON="${prefix}/bin/python2.4"

post-destroot	{
		xinstall -d -m 755 ${destroot}${prefix}/var/cache/yum/base/headers
		xinstall -d -m 755 ${destroot}${prefix}/var/cache/yum/base/packages
		destroot.keepdirs ${destroot}${prefix}/var/cache/yum/base/headers \
		${destroot}${prefix}/var/cache/yum/base/packages ${destroot}${prefix}/var/log \
		${destroot}${prefix}/var/run
}
