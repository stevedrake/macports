# $Id$

PortSystem          1.0

name                latexmk
version             4.16a
categories          tex print
platforms           darwin
maintainers         vinc17 openmaintainer

description         Automates the process of generating a LaTeX document
long_description \
    Latexmk completely automates the process of generating a LaTeX document. \
    Essentially, it is a highly specialized cousin of the general make       \
    utility.  Given the source files for a document, latexmk issues the      \
    appropriate sequence of commands to generate a .dvi, .ps, .pdf or        \
    hardcopy version of the document.  It can also be set to run             \
    continuously with a previewer\; the latex program, etc, are rerun        \
    whenever one of the source files is modified.

homepage            http://www.ctan.org/tex-archive/support/latexmk/
master_sites        http://www.ctan.org/get/support
distname            latexmk
dist_subdir         ${name}/${version}
use_zip             yes

checksums           md5     f11333956bbeb1f51a087023e890841c \
                    sha1    925192f78f31cc966e5ed6beabb793e7a2742e3d \
                    rmd160  72bb264d884277d7bb0654ab73a52c28b9f5b2af

depends_lib         bin:latex:texlive

pre-configure {
    reinplace "s/\\(CPU usage\\.\\)\"/\\1\\\\n\"/" ${worksrcpath}/latexmk.pl
}

use_configure       no
build               {}

destroot {
    set bindir ${destroot}${prefix}/bin
    file mkdir ${bindir}
    xinstall -m 755 -v ${worksrcpath}/${name}.pl ${bindir}/${name}
    set mandir ${destroot}${prefix}/share/man/man1
    file mkdir ${mandir}
    xinstall -m 644 -v ${worksrcpath}/${name}.1 ${mandir}
    set docdir ${destroot}${prefix}/share/doc/${name}
    file mkdir ${docdir}
    xinstall -m 644 -v -W ${worksrcpath} \
        CHANGES COPYING README ${name}.pdf ${name}.txt ${docdir}
}

livecheck.type      regex
livecheck.url       http://mirror.ctan.org/support/latexmk/latexmk.pl
livecheck.regex     "version_num = '(\[0-9a-z.\]+)'"
