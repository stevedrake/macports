# $Id$

PortSystem 1.0

name            texlive_base
version         2007
revision        2
categories      tex
maintainers     milosh openmaintainer
description     TeX Live Binaries.
long_description    TeX Live is an easy way to get up and running with TeX. \
    It provides a comprehensive TeX system with binaries for most flavors \
    of Unix, including GNU/Linux, and also Windows. It includes all the \
    major TeX-related programs, macro packages, and fonts that are free \
    software, including support for many languages around the world.

homepage        http://www.tug.org/texlive/
platforms       darwin

master_sites    openbsd:distfiles \
				http://students.dec.bournemouth.ac.uk/ebarrett/texlive/distfiles/
distname        ${name}-${version}-src
worksrcdir      ${name}-${version}
use_bzip2       yes

checksums       md5 db006e9f0f63e9be72bd5c45d07905f6 \
                sha1 f6f0192c200473c361aedfa8d34691a99e4f7065
depends_lib     port:freetype port:fontconfig port:ncurses port:zlib \
                port:libpng port:texinfo port:texi2html port:ghostscript \
				lib:libX11:XFree86 port:texlive_texmf-minimal

depends_build   port:perl5.8

configure.args  --mandir=${prefix}/share/man \
                --infodir=${prefix}/share/info \
                --with-system-freetype2 --with-system-ncurses \
                --with-freetype2-libdir=${prefix}/lib \
                --with-freetype2-include=${prefix}/include \
                --with-system-pnglib --with-system-zlib \
                --with-system-gd --with-fontconfig=${prefix} \
                --disable-multiplatform --without-texinfo \
                --without-xdvipdfmx --without-texi2html \
                --without-psutils

post-destroot   {
    copy ${destroot}${prefix}/share/texmf/web2c/texmf.cnf \
        ${destroot}${prefix}/share/texmf/web2c/texmf.cnf-dist
    reinplace "s/^TEXMFSYSCONFIG = .*/TEXMFSYSCONFIG = \$TEXMFMAIN/g" \
        ${destroot}${prefix}/share/texmf/web2c/texmf.cnf
}

post-activate   {
        system "mktexlsr"
        system "fmtutil-sys --all"
        system "updmap-sys --syncwithtrees"
}

livecheck.check     regex
livecheck.url       ${homepage}acquire.html
livecheck.regex     "TeX Live (\[0-9\]+) "

pre-configure {
	reinplace "s|@echo|@/bin/echo|" ${worksrcpath}/libs/icu-xetex/config/mh-darwin
}

#Include all openBSD patches. Make texlive honor DESTDIR.
patchfiles      patch-Makefile_in\
    patch-libs_icu-xetex_Makefile_in\
    patch-libs_icu-xetex_layout_KernTable_cpp\
    patch-texk_afm2pl_Makefile_in\
    patch-texk_bibtex8_Makefile_in\
    patch-texk_cjkutils_conv_Makefile_in\
    patch-texk_cjkutils_hbf2gf_Makefile_in\
    patch-texk_cjkutils_scripts_Makefile_in\
    patch-texk_detex_Makefile_in\
    patch-texk_dtl_Makefile_in\
    patch-texk_dvi2tty_Makefile_in\
    patch-texk_dvidvi_Makefile_in\
    patch-texk_dviljk_Makefile_in\
    patch-texk_dvipdfm_Makefile_in\
    patch-texk_dvipos_Makefile_in\
    patch-texk_dvipsk_Makefile_in\
    patch-texk_gsftopk_Makefile_in\
    patch-texk_kpathsea_Makefile_in\
    patch-texk_lacheck_Makefile_in\
    patch-texk_make_man_mk\
    patch-texk_makeindexk_Makefile_in\
    patch-texk_musixflx_Makefile_in\
    patch-texk_ps2pkm_Makefile_in\
    patch-texk_seetexk_Makefile_in\
    patch-texk_tetex_Makefile_in\
    patch-texk_tetex_texlinks\
    patch-texk_tex4htk_Makefile_in\
    patch-texk_texlive_Makefile_in\
    patch-texk_ttf2pk_Makefile_in\
    patch-texk_web2c_Makefile_in\
    patch-texk_web2c_alephdir_aleph_mk\
    patch-texk_web2c_doc_Makefile_in\
    patch-texk_web2c_mpware_Makefile_in\
    patch-texk_web2c_omegadir_omega_mk\
    patch-texk_web2c_omegafonts_Makefile_in\
    patch-texk_web2c_otps_Makefile_in\
    patch-texk_web2c_pdftexdir_pdftex_mk\
    patch-texk_web2c_texmfmem_h\
    patch-texk_web2c_xetexdir_XeTeX_ext_c\
    patch-texk_web2c_xetexdir_XeTeX_ext_h\
    patch-texk_web2c_xetexdir_XeTeX_mac_c\
    patch-texk_web2c_xetexdir_jpegimage_c\
    patch-texk_web2c_xetexdir_xetex-new_ch\
    patch-texk_web2c_xetexdir_xetex_defines\
    patch-texk_web2c_xetexdir_xetex_h\
    patch-texk_web2c_xetexdir_xetex_mk\
    patch-texk_xdv2pdf_Makefile_in\
    patch-texk_xdvik_Makefile_in\
    patch-texk_xdvipdfmx_src_tt_cmap_c\
    patch-utils_dialog_Makefile_in\
    patch-utils_ps2eps_Makefile_in\
    patch-utils_psutils_Makefile_in\
    patch-texk_web2c_omegafonts_pl_l.diff
