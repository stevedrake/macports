# $Id$

PortSystem			1.0
name				asciidoc
version				8.2.3
categories			textproc
maintainers			boeyms openmaintainer
description			Formatter/translator for text files to numerous formats
long_description \
	AsciiDoc is a text document format for writing short documents, \
	articles, books and UNIX man pages. AsciiDoc files can be translated to \
	HTML (with or without stylesheets), DocBook and LinuxDoc markup using \
	the asciidoc(1) command.  AsciiDoc is highly configurable: both the \
	AsciiDoc source file syntax and the backend output markups (which can be \
	almost any type of SGML/XML markup) can be customized and extended by \
	the user.

platforms			darwin

homepage			http://www.methods.co.nz/asciidoc/
master_sites		sourceforge

checksums			md5 4238af0b3b7fef0b9fab254731f9a716 \
					sha1 c5f245e3cc98fc7785037e27b7002c7f6b071b96 \
					rmd160 f7327a463aa866c48d6af25a45ce7b81fdd9df0b

depends_run			port:python24 port:getopt port:docbook-xml-4.2 port:fop-0.20
use_configure		no

build				{}

destroot {
	cd ${worksrcpath}
	xinstall -m 755 -d ${destroot}${prefix}/share/${name} \
		${destroot}${prefix}/etc/${name}/images/

	xinstall -m 755 asciidoc.py ${destroot}${prefix}/bin/${name}
	xinstall -m 755 a2x ${destroot}${prefix}/bin/a2x

	eval file copy [glob *.conf] docbook-xsl filters javascripts stylesheets \
		${destroot}${prefix}/etc/${name}/
	file copy images/icons ${destroot}${prefix}/etc/${name}/images/

	# Note, doc and examples (per porthier(7)) should be in their own subdir
	# of ${prefix}/share, but asciidoc has quite a few symlinks in the
	# examples, so they go under ${prefix}/share/${name} to keep things working
	eval file copy doc examples images javascripts stylesheets BUGS BUGS.txt \
		CHANGELOG CHANGELOG.txt COPYING COPYRIGHT README README.txt \
		${destroot}${prefix}/share/${name}
	xinstall -m 644 doc/${name}.1 doc/a2x.1 \
		${destroot}${prefix}/share/man/man1

	reinplace "s|^#!/usr/bin/env python|#!${prefix}/bin/python|" \
		${destroot}${prefix}/bin/${name} \
		${destroot}${prefix}/etc/${name}/filters/code-filter.py
	reinplace "s|/etc/${name}|${prefix}/etc/${name}|" \
		${destroot}${prefix}/bin/${name} ${destroot}${prefix}/bin/a2x
}

