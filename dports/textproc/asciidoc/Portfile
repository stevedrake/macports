# $Id$

PortSystem			1.0

name				asciidoc
version				8.2.6
categories			textproc
maintainers			boeyms openmaintainer
description			Formatter/translator for text files to numerous formats
long_description \
	AsciiDoc is a text document format for writing short documents, \
	articles, books and UNIX man pages. AsciiDoc files can be translated to \
	HTML (with or without stylesheets), DocBook and LinuxDoc markup using \
	the asciidoc(1) command.  AsciiDoc is highly configurable: both the \
	AsciiDoc source file syntax and the backend output markups (which can be \
	almost any type of SGML/XML markup) can be customized and extended by \
	the user.

platforms			darwin

homepage			http://www.methods.co.nz/asciidoc/
master_sites		sourceforge

checksums			md5 1df4cee138a096131a94fe7d29066345 \
					sha1 cce98ed670c462a3a007b03b6f92d2108c5bc405 \
					rmd160 c07d2eaa04d16275c44756236023c0789cf54310

depends_run			port:python24 port:getopt port:docbook-xml-4.2 port:fop-0.20
use_configure		no

build				{}

destroot {
	xinstall -d \
		${destroot}${prefix}/share/${name} \
		${destroot}${prefix}/etc/${name}/images/

	xinstall -W ${worksrcpath} -m 755 asciidoc.py ${destroot}${prefix}/bin/${name}
	xinstall -W ${worksrcpath} -m 755 a2x ${destroot}${prefix}/bin/a2x

	eval file copy \
		[glob -d ${worksrcpath} *.conf] \
		${worksrcpath}/docbook-xsl \
		${worksrcpath}/filters \
		${worksrcpath}/javascripts \
		${worksrcpath}/stylesheets \
		${destroot}${prefix}/etc/${name}/
	file copy ${worksrcpath}/images/icons ${destroot}${prefix}/etc/${name}/images/

	# Note, doc and examples (per porthier(7)) should be in their own subdir
	# of ${prefix}/share, but asciidoc has quite a few symlinks in the
	# examples, so they go under ${prefix}/share/${name} to keep things working
	file copy \
		${worksrcpath}/doc \
		${worksrcpath}/examples \
		${worksrcpath}/images \
		${worksrcpath}/javascripts \
		${worksrcpath}/stylesheets \
		${destroot}${prefix}/share/${name}
	xinstall -W ${worksrcpath} \
		BUGS \
		BUGS.txt \
		CHANGELOG \
		CHANGELOG.txt \
		COPYING \
		COPYRIGHT \
		README \
		README.txt \
		${destroot}${prefix}/share/${name}
	xinstall -W ${worksrcpath} \
		doc/${name}.1 \
		doc/a2x.1 \
		${destroot}${prefix}/share/man/man1

	reinplace "s|^#!/usr/bin/env python|#!${prefix}/bin/python2.4|" \
		${destroot}${prefix}/bin/${name} \
		${destroot}${prefix}/etc/${name}/filters/code-filter.py
	reinplace "s|/etc/${name}|${prefix}/etc/${name}|" \
		${destroot}${prefix}/bin/${name} ${destroot}${prefix}/bin/a2x
}

