# -*- coding: utf-8; mode: tcl; tab-width: 4; truncate-lines: t; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:et:sw=4:ts=4:sts=4
# $Id$

PortSystem 1.0

name		        	aspell
version		            0.60.5
categories	            textproc
maintainers	            openmaintainer jochen
description	            Spell checker with better logic than ispell
homepage	            http://aspell.net/
platforms	            darwin

long_description        Aspell is a spell checker designed to eventually replace ispell. \
    Aspell's main feature is that it  does a much better job of coming up with \
    possible suggestions than ispell.

master_sites	        gnu freebsd

checksums	            md5 17fd8acac6293336bcef44391b71e337 \
		                sha1 170ff906bd909dba32144c972d322cfc8fbff41b \
		                rmd160 1efc56988a01e60d1fcff0143e910f5cb6618a76

depends_build           port:texinfo

configure.env	        LIBS="-L${prefix}/lib"
configure.cflags-append "-I${prefix}/include"
configure.args	        --enable-dict-dir="${prefix}/share/aspell" \
                        --enable-compile-in-filters \
                        --infodir=${destroot}${prefix}/share/info

post-destroot {
	file delete -force ${destroot}${prefix}/share/info/dir
    system "${prefix}/bin/install-info ${destroot}${prefix}/share/info/aspell.info ${prefix}/share/info/dir"
    system "${prefix}/bin/install-info ${destroot}${prefix}/share/info/aspell-dev.info ${prefix}/share/info/dir"
}

post-install {
    ui_msg "******************************************************************"
    ui_msg "You must install (at least) one of the language dictionaries after"
    ui_msg "installing this port in order for it to work."
    ui_msg "******************************************************************"
}

variant nls description "Include natural language support; conflicts with GNUstep" conflicts nonls {
    configure.args-delete --disable-nls
    configure.args-append --enable-nls
}

variant nonls description "Don't include natural language support (default on Mac OS X)" conflicts nls {
    configure.args-delete --enable-nls
    configure.args-append --disable-nls
}

platform macosx {
# gnustep-gui uses aspell and will not work if aspell is linked to gettext because
# gettext is linked to CoreFoundation which is itself linked to the Apple objc runtime
# (All we are saying, is give GNUstep a chance)
    if { ![variant_isset nls] } {
        default_variants        +nonls
    }
}
