--- Makefile.orig	2007-08-19 15:19:46.000000000 +0200
+++ Makefile	2007-11-08 14:38:50.000000000 +0100
@@ -1,6 +1,15 @@
 INSTALL_DIR=/usr/local/bin
 MAN_DIR=/usr/local/man/man1
 ETC_DIR=/etc
+.ifdef DESTROOT_DIR
+TARGET_INSTALL_DIR=$(DESTROOT_DIR)$(INSTALL_DIR)
+TARGET_MAN_DIR=$(DESTROOT_DIR)$(MAN_DIR)
+TARGET_ETC_DIR=$(DESTROOT_DIR)$(ETC_DIR)
+.else
+TARGET_INSTALL_DIR=$(INSTALL_DIR)
+TARGET_MAN_DIR=$(MAN_DIR)
+TARGET_ETC_DIR=$(ETC_DIR)
+.endif
 VERSION=1.0.7
 DIST_FILES=COPYING INSTALL Makefile README \
 	colordiff.pl colordiffrc colordiffrc-lightbg cdiff.sh BUGS TODO CHANGES colordiff.1 \
@@ -22,20 +31,19 @@
 
 etc:
 	sed -e "s%/etc%$(ETC_DIR)%g" colordiff.pl > colordiff.pl.for.install
+	sed -e "s%/etc%$(ETC_DIR)%g" colordiff.1 > colordiff.1.for.install
 
 install: etc
-	install -D colordiff.pl.for.install ${INSTALL_DIR}/colordiff
-	if [ ! -f ${INSTALL_DIR}/cdiff ] ; then \
-	  install cdiff.sh ${INSTALL_DIR}/cdiff; \
+	install colordiff.pl.for.install $(TARGET_INSTALL_DIR)/colordiff
+	if [ ! -f $(TARGET_INSTALL_DIR)/cdiff ] ; then \
+	  install cdiff.sh $(TARGET_INSTALL_DIR)/cdiff; \
 	fi
-	install -D colordiff.1 ${MAN_DIR}/colordiff.1
-	if [ -f ${ETC_DIR}/colordiffrc ]; then \
-	  mv -f ${ETC_DIR}/colordiffrc ${ETC_DIR}/colordiffrc.old; \
+	install colordiff.1.for.install $(TARGET_MAN_DIR)/colordiff.1
+	if [ -f $(TARGET_ETC_DIR)/colordiffrc ]; then \
+	  mv -f $(TARGET_ETC_DIR)/colordiffrc $(TARGET_ETC_DIR)/colordiffrc.old; \
 	fi
-	cp colordiffrc ${ETC_DIR}/colordiffrc
-	chown root.root ${ETC_DIR}/colordiffrc
-	chmod 644 ${ETC_DIR}/colordiffrc
-	rm -f colordiff.pl.for.install
+	cp colordiffrc{,-lightbg} $(TARGET_ETC_DIR)
+	rm -f colordiff.pl.for.install colordiff.1.for.install
 
 dist:
 	mkdir ${TMPDIR}
