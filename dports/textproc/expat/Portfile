# $Id$

PortSystem          1.0
name                expat
version             2.0.0
revision            1
categories          textproc devel
maintainers         ryandesign@macports.org openmaintainer@macports.org
description         XML 1.0 parser written in C
long_description    Expat is an XML parser library written in C. It is a \
                        stream-oriented parser in which an application \
                        registers handlers for things the parser might find \
                        in the XML document (like start tags). 
platforms           darwin freebsd
homepage            http://expat.sourceforge.net/
master_sites        sourceforge
checksums           md5 d945df7f1c0868c5c73cf66ba9596f3f \
                    sha1 9ff011a75a1f5b60145c4afdec520442cb398d93 \
                    rmd160 f52ccab26950d0148c3e8b644d7c9021734de318
configure.args      --mandir=\\\${prefix}/share/man
destroot.destdir    prefix=${destroot}${prefix}

pre-test {
    cd ${worksrcpath}/lib
    file copy -force expat.h expat_external.h ../tests
}
# extract from tests/README.txt: "Expat must be built and installed 
# before "make check" can be executed."
test.run            yes
test.target         check

post-destroot {
    xinstall -m 755 -d ${destroot}${prefix}/share/doc/${name} \
        ${destroot}${prefix}/share/examples/${name}
    xinstall -m 644 -W ${worksrcpath} COPYING Changes README \
        ${destroot}${prefix}/share/doc/${name}
    eval xinstall -m 644 [glob ${worksrcpath}/doc/*] \
        ${destroot}${prefix}/share/doc/${name}
    xinstall -m 644 -W ${worksrcpath}/examples elements.c outline.c \
        ${destroot}${prefix}/share/examples/${name}
    cd ${destroot}${prefix}/lib
    system "ln -s libexpat.1.dylib libexpat.0.dylib"
}

variant no_static {
    configure.args-append   --disable-static
}
