# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                extractopinion
version             1.0
categories          textproc japanese
platforms           darwin
maintainers         hum openmaintainer
license             BSD LGPL GPL

homepage            http://alaginrc.nict.go.jp/opinion/index.html
description         an opinion extraction tool for Japanese texts.
long_description    ${description}

master_sites        http://alaginrc.nict.go.jp/opinion/src/

checksums           sha1    208540479b7b0193bb0273aef99cfb4eebd4de7a \
                    rmd160  eb143e445c9a9ba50684df184f8fcf0e4c007e4b

depends_lib         port:crfpp \
                    port:nkf \
                    port:gawk \
                    port:juman \
                    port:knp

use_configure       no

pre-build {
    copy ${filespath}/Makefile ${worksrcpath}
}

variant universal {}
if {[variant_isset universal]} {
    set archflags ${configure.universal_cflags}
} else {
    set archflags ${configure.cflags}
}

build.args         CFLAGS="${archflags}"

destroot {
    reinplace "s|dir=`cd \$\(dirname \$0\) && pwd`|dir=${prefix}/share/${distname}|" \
        ${worksrcpath}/extract.sh
    reinplace "s|dir=|#dir=|" ${worksrcpath}/conf.sh
    foreach script {pol/out2tsv pol/par2dat pol/tsv2par \
                        src/makefv src/otag2tsv src/out2tsv src/tsv2tag src/tsvconv \
                        typ/makefv typ/out2tsv typ/tsvconv \
                        xpr/otag2tsv xpr/tsv2tag} {
        reinplace "s|/usr/bin/gawk|${prefix}/bin/gawk|" ${worksrcpath}/${script}.awk
    }
    copy ${worksrcpath}/extract.sh ${destroot}${prefix}/bin/extractopinion.sh
    copy ${worksrcpath}            ${destroot}${prefix}/share
}

livecheck.type      regex
livecheck.url       ${homepage}
livecheck.regex     ${name}-(\[0-9.\]+)\\.tar
