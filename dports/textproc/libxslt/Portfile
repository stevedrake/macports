# $Id$
PortSystem  1.0

name              libxslt
version	          1.1.22
description       gnome xslt library and xsltproc
categories        textproc
platforms         darwin
maintainers       nomaintainer

homepage          http://xmlsoft.org/XSLT/
master_sites      ftp://xmlsoft.org/${name}/

checksums         md5 d6a9a020a76a3db17848d769d6c9c8a9 \
                  sha1 55ce4dc659681d9a5ba2322c45cbdfe75b46639c \
                  rmd160 bc2d32a4d7fea777c3d4b0ce3f5a70c8ea3f8969

depends_lib       port:libiconv port:libxml2 port:zlib
configure.args	  --mandir=${prefix}/share/man --enable-static=no \
                    --with-libxml-prefix=${prefix} \
                    --without-python \
                    --without-crypto

pre-configure {
    reinplace s|need_relink=yes|need_relink=no| ${worksrcpath}/ltmain.sh
}

post-configure {
	if {! [variant_isset doc]} {
		reinplace -E "/^install-data-am:/s|install-data-local||" ${worksrcpath}/doc/Makefile
		reinplace -E "/^all:/s|web||" ${worksrcpath}/doc/Makefile
	}
}

post-destroot {
	set docdir ${prefix}/share/doc/${name}-${version}
	if {! [variant_isset doc]} {
		xinstall -d ${destroot}${docdir}
	}
	xinstall -m 0644 -W ${worksrcpath} AUTHORS COPYING ChangeLog Copyright FEATURES \
		NEWS README TODO ${destroot}${docdir}
}

test.run    yes
test.target check

variant doc description {Install extra documentation} {}

variant debug {
        configure.cflags-append -O0 -g
	configure.args-append --with-debugger
}

long_description \
Libxslt is the XSLT C library developed for the Gnome project. \
XSLT itself is a an XML language to define transformation for XML. \
Libxslt is based on libxml2 the XML C library developed for the Gnome project. \
It also implements most of the EXSLT set of processor-portable extensions \
functions and some of Saxon's evaluate and expressions extensions. 

livecheck.check regex
livecheck.url   ${homepage}news.html
livecheck.regex {<h3>(\d+(?:\.\d+)*): .*</h3>}

