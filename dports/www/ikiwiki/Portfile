PortSystem 1.0
PortGroup perl5 1.0

perl5.setup             ikiwiki 1.47
name                    ikiwiki
categories		www perl
description             A wiki compiler.
long_description        ${description}
homepage                http://ikiwiki.kitenet.net/
maintainers             paul.totterman@gmail.com
platforms               darwin
master_sites            http://ftp.debian.org/debian/pool/main/i/ikiwiki/
distname                ${name}_${version}
worksrcdir              ${name}
checksums		md5 2463a50af5b5587bc2444e89c2edcb46 \
			sha1 f4d6ecc2d16b96da57812e1dcb332bf8cacc2e2d \
			rmd160 fe5563ef36cd27fe258ac654bd1496e932b1c77f

depends_build           port:coreutils
depends_lib-append      port:p5-text-markdown port:p5-html-template \
                        port:p5-html-scrubber port:p5-uri port:p5-perlmagick \
			port:p5-cgi-formbuilder port:p5-timedate port:p5-mail-sendmail \
			port:p5-time-duration port:p5-xml-sax-expat

destroot.target         CP=gcp install
configure.args          INSTALLDIRS=vendor PREFIX=${prefix}

post-patch {
	reinplace "s|/usr/bin/perl|${prefix}/bin/perl|g" \
		${worksrcpath}/ikiwiki.in \
		${worksrcpath}/Makefile.PL \
		${worksrcpath}/ikiwiki-mass-rebuild \
		${worksrcpath}/ikiwiki-w3m.cgi \
		${worksrcpath}/ikiwiki.in \
		${worksrcpath}/mdwn2man \
		${worksrcpath}/pm_filter
}
