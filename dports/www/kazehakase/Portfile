# $Id$

PortSystem 1.0

name		kazehakase
version		0.5.3
categories	www
description	browser with gecko engine like Epiphany or Galeon.
long_description	${description}
homepage	http://kazehakase.sourceforge.jp/
platforms	darwin
maintainers	afb@macports.org openmaintainer
master_sites	http://osdn.dl.sourceforge.jp/kazehakase/29695/
checksums	md5 1635cc357f1a65c8fdcad56cdcd8bb9c \
		sha1 d516a80817ab04f27e860fd2a20974cc68fa978c \
		rmd160 e39a4e1bd9d00dd302735254cb0dddf4826bb8a9
depends_build	path:bin/pkg-config:pkgconfig
depends_lib	port:gtk2 \
		port:xulrunner \
		path:bin/glibtoolize:libtool

patchfiles	patch-missing.diff

configure.args \
	--with-gecko-engine=libxul \
	--disable-gtkmozembed

post-patch {
	reinplace "s/-D\[^ \]*_DISABLE_DEPRECATED=1//" \
		${worksrcpath}/ext/ruby/Makefile.am \
		${worksrcpath}/module/embed/gecko/Makefile.am \
		${worksrcpath}/module/embed/gtk-webcore/Makefile.am \
		${worksrcpath}/module/embed/ie/Makefile.am \
		${worksrcpath}/module/embed/webkit-gtk/Makefile.am \
		${worksrcpath}/module/search/Makefile.am \
		${worksrcpath}/src/actions/Makefile.am \
		${worksrcpath}/src/bookmarks/Makefile.am \
		${worksrcpath}/src/dialogs/Makefile.am \
		${worksrcpath}/src/Makefile.am \
		${worksrcpath}/src/net/Makefile.am \
		${worksrcpath}/src/prefs_ui/Makefile.am \
		${worksrcpath}/src/sidebar/Makefile.am \
		${worksrcpath}/src/utils/Makefile.am \
		${worksrcpath}/ext/ruby/Makefile.in \
		${worksrcpath}/module/embed/gecko/Makefile.in \
		${worksrcpath}/module/embed/gtk-webcore/Makefile.in \
		${worksrcpath}/module/embed/ie/Makefile.in \
		${worksrcpath}/module/embed/webkit-gtk/Makefile.in \
		${worksrcpath}/module/search/Makefile.in \
		${worksrcpath}/src/actions/Makefile.in \
		${worksrcpath}/src/bookmarks/Makefile.in \
		${worksrcpath}/src/dialogs/Makefile.in \
		${worksrcpath}/src/Makefile.in \
		${worksrcpath}/src/net/Makefile.in \
		${worksrcpath}/src/prefs_ui/Makefile.in \
		${worksrcpath}/src/sidebar/Makefile.in \
		${worksrcpath}/src/utils/Makefile.in
}

configure.cppflags-append "[exec ${prefix}/bin/pkg-config --cflags-only-I nss]"
configure.ldflags-append  "[exec ${prefix}/bin/pkg-config --libs-only-L nss]"

variant webkit description "use WebKit in addition to Gecko" {
	depends_lib-append port:webkit-gtk
}
