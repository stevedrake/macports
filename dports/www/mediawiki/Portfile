# $Id$

PortSystem          1.0

name                mediawiki
version             1.14.0
set branch          [join [lrange [split ${version} .] 0 1] .]
categories          www php
maintainers         nomaintainer
description         The wiki engine used by Wikipedia
long_description \
   MediaWiki is the collaborative editing software that runs Wikipedia, the \
   free encyclopedia, and other projects. It's designed to handle a large \
   number of users and pages without imposing too rigid a structure or \
   workflow.

homepage            http://www.mediawiki.org
distname            mediawiki-${version}
master_sites        http://download.wikimedia.org/mediawiki/${branch}/
checksums           md5     36bfd924e92b61a6f5fe70c6bc8e5aac \
                    sha1    47d98ead3ba1c5c28e7cd30806febf8db650e7f6 \
                    rmd160  11ef4698412f5ce716fe82e8d8e76742da1f7da1
platforms           darwin freebsd

depends_run \
   port:libiconv \
   port:jpeg \
   port:jasper \
   port:tiff \
   port:lcms \
   port:libpng \
   port:freetype \
   port:libxml2 \
   port:jbigkit \
   port:expat \
   port:fontconfig \
   port:ghostscript \
   port:ImageMagick \
   port:pkgconfig \
   port:aspell

depends_lib \
   port:php5 \
   port:mysql5

variant mysql4 conflicts postgresql83 description "use mysql4 instead of mysql5" {
   depends_lib-append   port:mysql4
   depends_lib-delete   port:mysql5
}

variant postgresql83 conflicts mysql4 description "Use postgreslq83 instead of mysql5" {
   depends_lib-append   port:postgresql83
   depends_lib-delete   port:mysql5
}

use_configure       no
build               {}

set docpath ${destroot}${prefix}/www/data

destroot {
   xinstall -d -m 0755 ${docpath}/mediawiki
   eval file copy [glob ${worksrcpath}/*] ${docpath}/mediawiki
}

