# $Id: Portfile,v 1.2 2005/04/04 10:08:39 jkh Exp $

PortSystem 1.0
name		mod_mono
version		1.0.6
categories	www
platforms	darwin
maintainers	jkh@opendarwin.org
description	an Apache plug-in for hosting the Mono System.Web classes
long_description	An Apache web server plug-in that hosts the Mono System.Web classes for running what is commonly known as ASP.NET

homepage	http://www.go-mono.com
master_sites	${homepage}/archive/
#checksums	md5 cc91371a20d0b1209fe844c0cfd540e3
depends_lib	bin:mcs:mono
patchfiles	patch-Makefile.in
depends_run	bin:xsp.exe:xsp

variant darwin {
	pre-configure {
		reinplace "s/libmod_mono.so/libmod_mono.dylib/" ${worksrcpath}/src/Makefile.in
	}
}

post-install {
	ui_msg ""
	ui_msg "To finish the configuration of this Apache module, you must add"
	ui_msg "the following (modulo site variations) to your httpd.conf file:"
	ui_msg ""
	ui_msg "AddType application/x-asp-net .aspx .ashx .asmx .ascx .asax .config .ascx"
	ui_msg "LoadModule mono_module libexec/httpd/mod_mono.so"
	ui_msg "MonoUnixSocket /tmp/mod_mono_server"
	ui_msg {Alias /mono "/usr/share/doc/xsp/test"}
	ui_msg ""
	ui_msg "Then do the following:"
	ui_msg ""
        ui_msg "cd ${prefix}/share/doc/xsp/test"
        ui_msg "mono ${prefix}/bin/mod-mono-server.exe --root . --applications /mono:."
	ui_msg ""
	ui_msg "Finally, restart apache (if running) and point a browser at:"
	ui_msg "http://127.0.0.1/mono/index.aspx to test ASP page-serving ability"
	ui_msg ""
}
