# $Id: Portfile,v 1.4 2004/05/03 19:35:04 mww Exp $

PortSystem 1.0

name		mod_python
version		3.1.3
categories	www python
platforms	darwin
maintainers	mww@opendarwin.org
description	Apache 2 module that embeds Python within the server
long_description	Mod_python is an Apache 2 module that embeds the \
			Python interpreter within the server. With mod_python \
			you can write web-based applications in Python that \
			will run many times faster than traditional CGI and \
			will have access to advanced features such as ability \
			to retain database connections and other data between \
			hits and access to Apache internals.

homepage	http://www.modpython.org/
master_sites	apache:httpd/modpython
extract.suffix	.tgz
checksums	md5 2e1983e35edd428f308b0dfeb1c23bfe

depends_lib	path:${prefix}/apache2/bin/apxs:apache2

build.env	CFLAGS=-Wno-long-double
configure.args	--with-apxs=${prefix}/apache2/bin/apxs \
		--with-python=/usr/bin/python \
		--enable-so

pre-destroot	{
	xinstall -d -m 755 ${destroot}${prefix}/apache2/modules
	xinstall -d ${destroot}${prefix}/share/doc
	file copy ${worksrcpath}/doc-html ${destroot}${prefix}/share/doc/${name}
}
post-destroot	{
	xinstall -d -m 755 ${destroot}/Library/Python/2.3/
	file rename ${destroot}/System/Library/Frameworks/Python.framework/Versions/2.3/lib/python2.3/site-packages/mod_python \
		${destroot}/Library/Python/2.3/mod_python
}

post-install	{
	ui_msg "############################"
	ui_msg "# to enable mod_python add"
	ui_msg "#  LoadModule python_module ${prefix}/libexec/apache2/mod_python.so"
	ui_msg "# to your apache2 config file (${prefix}/etc/apache2/httpd.conf)"
	ui_msg "#"
}
