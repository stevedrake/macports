# $Id: Portfile,v 1.16 2006/04/25 05:49:38 mww Exp $

PortSystem 1.0

name			mod_python
version			3.2.8
revision		1
categories		www python
platforms		darwin
maintainers		mww@opendarwin.org
description		Apache2 module that embeds Python within the server.
long_description	Mod_python is an Apache 2 module that embeds the \
				Python interpreter within the server. With mod_python \
				you can write web-based applications in Python that \
				will run many times faster than traditional CGI and \
				will have access to advanced features such as ability \
				to retain database connections and other data between \
				hits and access to Apache internals.

homepage		http://www.modpython.org/
master_sites	apache:httpd/modpython
extract.suffix	.tgz
checksums		sha1 879900c1dece20a2ed08bfc81c16bfe539ee63de

depends_build	port:flex
depends_lib		port:apache2 port:python24

# see http://comments.gmane.org/gmane.comp.version-control.subversion.trac.general/7316
patchfiles		apr.diff

configure.env	CFLAGS="-I${prefix}/include/python2.4" \
				LDFLAGS="-Wl,-F${prefix}/Library/Frameworks -L${prefix}/lib"
configure.args	--with-apxs=${prefix}/apache2/bin/apxs \
				--with-python=${prefix}/bin/python2.4 \
				--with-flex=${prefix}/bin/flex \
				--enable-so

pre-destroot {
	xinstall -d -m 755 ${destroot}${prefix}/apache2/modules \
		${destroot}${prefix}/share/doc
	file copy ${worksrcpath}/doc-html ${destroot}${prefix}/share/doc/${name}
}

post-install {
	ui_msg "########################################################"
	ui_msg "# to enable mod_python add"
	ui_msg "#  LoadModule python_module modules/mod_python.so"
	ui_msg "# to your apache2 config file:"
	ui_msg "#  ${prefix}/apache2/conf/httpd.conf"
	ui_msg "########################################################"
}
