diff -ru a/configure b/configure
--- a/configure	2011-07-20 08:09:48.000000000 -0700
+++ b/configure	2011-07-20 08:12:04.000000000 -0700
@@ -12789,6 +12789,8 @@
        done
      done
 
+  else
+    bdb_version=`sed -ne 's/^.*DB_VERSION_STRING.*Berkeley DB \(...\).*/\1/p' $bdb_include_dir/db.h`
   fi
 
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking BDB version" >&5
diff -ru a/configure.ac b/configure.ac
--- a/configure.ac	2011-07-20 08:09:48.000000000 -0700
+++ b/configure.ac	2011-07-20 08:11:41.000000000 -0700
@@ -283,6 +283,8 @@
        done
      done
 
+  else
+    bdb_version=`sed -ne 's/^.*DB_VERSION_STRING.*Berkeley DB \(...\).*/\1/p' $bdb_include_dir/db.h`
   fi
 
   AC_MSG_CHECKING(BDB version)
