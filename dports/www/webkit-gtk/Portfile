# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:filetype=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem	1.0

name		webkit-gtk
version		r29801
description	Apple's WebKit HTML Rendering library for GTK+
long_description	\
	The opensource HTML Rendering library from Apple for GTK+ \
	\n\n \
	This port is currently broken but has been included in the tree \
	for debugging and development purposes. \
	\n\n \
	See  http://bugs.webkit.org/show_bug.cgi?id=17001 for the upstream ticket.
maintainers	nomaintainer
categories	www gnome
platforms	darwin freebsd
homepage	http://webkit.org
master_sites    http://nightly.webkit.org/files/trunk/src/
distname	WebKit-${version}
use_bzip2	yes
checksums	\
	md5 a10208a436510898999082b58ddc9ad8 \
	sha1 36e3baa03ecdcaba80f32e93cbabf9ef52c217a5 \
	rmd160 a13b74811be0efd3198633cf18aa0e90c6d38d83

depends_lib	\
	port:curl \
	port:gnome-vfs \
	port:gstreamer \
	port:gtk2 \
	port:icu \
	port:libxslt \
	port:sqlite3 
depends_build	\
	port:libtool \
	port:pkgconfig

post-patch	{
	reinplace "s|aclocal |aclocal -I${prefix}/share/aclocal |" ${worksrcpath}/autogen.sh
	reinplace "s|libtoolize|glibtoolize|g" ${worksrcpath}/autogen.sh
	# temporary reinplaces until patch is committed upstream
	# see http://bugs.webkit.org/show_bug.cgi?id=17001
	# this reinplace should be removed for versions r29806 and above
	reinplace "s|!defined(__MACOS_CLASSIC__)|!defined(__MACOS_CLASSIC__) \\\&\\\& !defined(XP_UNIX)|" ${worksrcpath}/JavaScriptCore/bindings/npapi.h
}

configure.cmd	./autogen.sh
configure.env	LIBTOOLIZE=${prefix}/bin/glibtoolize
