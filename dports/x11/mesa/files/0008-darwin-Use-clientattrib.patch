From 6083736075892e89391ff41b02b8d66cc59bad04 Mon Sep 17 00:00:00 2001
From: Jeremy Huddleston <jeremyhu@apple.com>
Date: Fri, 2 Apr 2010 00:54:57 -0700
Subject: [PATCH 08/11] darwin: Use clientattrib

Signed-off-by: Jeremy Huddleston <jeremyhu@apple.com>
---
 src/glx/apple/Makefile |    2 +-
 src/glx/clientattrib.c |    2 ++
 src/glx/glxcmds.c      |    2 --
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git Mesa-7.8/src/glx/apple/Makefile Mesa-7.8/src/glx/apple/Makefile
index 4c05013..a3ee888 100644
--- Mesa-7.8/src/glx/apple/Makefile
+++ Mesa-7.8/src/glx/apple/Makefile
@@ -20,7 +20,7 @@ BUILD_DIR=builds
 
 all: $(BUILD_DIR)/libGL.1.2.dylib
 
-OBJECTS=glxext.o glxcmds.o glx_pbuffer.o glx_query.o glxcurrent.o glxextensions.o \
+OBJECTS=clientattrib.o glxext.o glxcmds.o glx_pbuffer.o glx_query.o glxcurrent.o glxextensions.o \
     appledri.o apple_glx_context.o apple_glx.o pixel.o \
     compsize.o apple_visual.o apple_cgl.o glxreply.o glcontextmodes.o \
     apple_xgl_api.o apple_glx_drawable.o xfont.o apple_glx_pbuffer.o \
diff --git Mesa-7.8/src/glx/clientattrib.c Mesa-7.8/src/glx/clientattrib.c
index a7dfb53..b26c179 100644
--- Mesa-7.8/src/glx/clientattrib.c
+++ Mesa-7.8/src/glx/clientattrib.c
@@ -35,6 +35,7 @@
 
 /*****************************************************************************/
 
+#ifndef GLX_USE_APPLEGL
 static void
 do_enable_disable(GLenum array, GLboolean val)
 {
@@ -123,6 +124,7 @@ __indirect_glPopClientAttrib(void)
       return;
    }
 }
+#endif
 
 void
 __glFreeAttributeState(__GLXcontext * gc)
diff --git Mesa-7.8/src/glx/glxcmds.c Mesa-7.8/src/glx/glxcmds.c
index 329b841..205ad07 100644
--- Mesa-7.8/src/glx/glxcmds.c
+++ Mesa-7.8/src/glx/glxcmds.c
@@ -539,9 +539,7 @@ __glXFreeContext(__GLXcontext * gc)
       XFree((char *) gc->version);
    if (gc->extensions)
       XFree((char *) gc->extensions);
-#ifndef GLX_USE_APPLEGL /* TODO: clientattrib */
    __glFreeAttributeState(gc);
-#endif
    XFree((char *) gc->buf);
    Xfree((char *) gc->client_state_private);
    XFree((char *) gc);
-- 
1.7.0.3

