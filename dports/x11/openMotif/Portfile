# $Id$

PortSystem      1.0

name            openmotif
version         2.3.0
revision        2
categories      x11
platforms       darwin
maintainers     nomaintainer
description     The Open Motif toolkit for X11

long_description \
    This is The Open Group's full version of Motif based on \
    the original OSF sources.

homepage        http://www.motifzone.net/
master_sites    ftp://ftp.ics.com/openmotif/[join [lrange [split ${version} .] 0 1] .]/${version}/
fetch.use_epsv  no

checksums       md5 99d0ecb84d3504da421021a19ff70500 \
                sha1 efb5f5fdc4cc43ef6065594f4ebe98953b7af15e \
                rmd160 317c8d13d59c6fdd4a9f0e3b63000695f6677b6c

# They updated the distfile from 2.3.0 beta to 2.3.0 final without changing
# the distfile's name! Remove this when updating to 2.3.1 or whatever's next.
dist_subdir     ${name}/2.3.0-final

depends_lib     port:jpeg \
                port:libpng \
                port:Xft2 \
                port:fontconfig \
                port:freetype \
                port:libiconv \
                port:xrender \
                port:zlib \
                lib:libX11.6:XFree86

post-patch {
    reinplace "s|iconv_open|libiconv_open|g" ${worksrcpath}/configure
    reinplace -E "/^LDFLAGS/s|\$| @LDFLAGS@|" ${worksrcpath}/lib/Xm/Makefile.in
}

configure.args  --mandir=${prefix}/share/man

build.env       LANG=C

post-destroot {
    set docdir ${prefix}/share/doc/${name}-${version}
    xinstall -d ${destroot}${docdir}
    xinstall -m 0644 -W ${worksrcpath} BUGREPORT COPYRIGHT.MOTIF ChangeLog LICENSE \
        README RELNOTES TODO ${destroot}${docdir}
}

platform darwin 7 {
    patchfiles-append   patch-freetype.diff
}

platform darwin 8 {
    configure.compiler  gcc-4.0
}

livecheck.check none
