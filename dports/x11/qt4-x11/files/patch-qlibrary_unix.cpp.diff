--- src/corelib/plugin/qlibrary_unix.cpp.orig	2008-05-12 07:19:29.000000000 -0600
+++ src/corelib/plugin/qlibrary_unix.cpp	2008-05-12 07:22:48.000000000 -0600
@@ -50,7 +50,7 @@
 
 #ifndef QT_NO_LIBRARY
 
-#ifdef Q_OS_MAC
+#ifdef Q_WS_MAC
 #  include <private/qcore_mac_p.h>
 #endif
 
@@ -163,8 +163,9 @@
         if (!fullVersion.isEmpty()) {
             suffixes << QString::fromLatin1(".%1.bundle").arg(fullVersion);
             suffixes << QString::fromLatin1(".%1.dylib").arg(fullVersion);
+            suffixes << QString::fromLatin1(".%1.so").arg(fullVersion);
         } else {
-            suffixes << QLatin1String(".bundle") << QLatin1String(".dylib");
+            suffixes << QLatin1String(".bundle") << QLatin1String(".dylib") << QLatin1String(".so");
         }
 #endif
     }
@@ -179,7 +180,7 @@
     } 
 #if !defined(Q_OS_CYGWIN)
     else {
-#if defined(Q_OS_MAC)
+#if defined(Q_WS_MAC)
         if (QSysInfo::MacintoshVersion >= QSysInfo::MV_10_4)
 #endif        
         dlFlags |= RTLD_LOCAL;
@@ -218,7 +219,7 @@
         }
     }
 
-#ifdef Q_OS_MAC
+#ifdef Q_WS_MAC
     if (!pHnd) {
         if (CFBundleRef bundle = CFBundleGetBundleWithIdentifier(QCFString(fileName))) {
             QCFType<CFURLRef> url = CFBundleCopyExecutableURL(bundle);
@@ -248,7 +249,7 @@
     return true;
 }
 
-#ifdef Q_OS_MAC
+#ifdef Q_WS_MAC
 Q_CORE_EXPORT void *qt_mac_resolve_sys(void *handle, const char *symbol)
 {
     return dlsym(handle, symbol);
