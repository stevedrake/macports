--- dlls/secur32/schannel_macosx.c.orig	2011-10-10 12:58:48.000000000 -0500
+++ dlls/secur32/schannel_macosx.c	2011-10-12 10:11:54.000000000 -0500
@@ -680,7 +680,11 @@
 
     TRACE("(%p/%p, %p)\n", s, s->context, cert);
 
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= 1050
     status = SSLCopyPeerCertificates(s->context, &certs);
+#else
+    status = SSLGetPeerCertificates(s->context, &certs);
+#endif
     if (status == noErr && certs)
     {
         SecCertificateRef mac_cert;
@@ -705,7 +709,11 @@
         CFRelease(certs);
     }
     else
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= 1050
         WARN("SSLCopyPeerCertificates failed: %ld\n", (long)status);
+#else
+        WARN("SSLGetPeerCertificates failed: %ld\n", (long)status);
+#endif
 
     return ret;
 }
