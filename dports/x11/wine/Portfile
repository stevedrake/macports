# $Id$

PortSystem          1.0

name                wine
version             0.9.43
categories          x11
maintainers         ryandesign openmaintainer@macports.org
homepage            http://www.winehq.com/
platforms           darwin
distname            wine-${version}
use_bzip2           yes
build.target        depend all

description \
	Wine Is Not an Emulator

long_description \
	Wine is an implementation of the Windows APIs on top of X11.

master_sites \
	sourceforge:wine \
	http://ibiblio.org/pub/linux/system/emulators/wine/

checksums \
	md5 7b9133e717ef6ca1ab220512670d9786 \
	sha1 4ad8e81f6e5437e160c7c15c8d2f684e9a7e18a1 \
	rmd160 48e668c1ce2e262334c4b16966df4a2e87e0d9a5

depends_lib \
	lib:libX11.6:XFree86 \
	port:expat \
	port:fontconfig \
	port:fontforge \
	port:freetype \
	port:jpeg \
	port:libiconv \
	port:libxml2 \
	port:libxslt \
	port:ncurses \
	port:openssl \
	port:render \
	port:xrender \
	port:zlib

depends_build \
	port:pkgconfig

configure.ldflags-append \
	-framework CoreServices \
	-lz

configure.args \
	--x-includes=${x11prefix}/include/

pre-fetch {
	if { [string compare ${os.endian} "little"] != 0 } {
		return -code error "${name} only runs on little-endian computers, such as an Intel Mac."
	}
}

post-destroot {
	file rename ${destroot}${prefix}/bin/wine ${destroot}${prefix}/bin/wine-real
	xinstall -m 755 ${filespath}/winewrapper.sh ${destroot}${prefix}/bin/wine
	reinplace s|@PREFIX@|${prefix}|g ${destroot}${prefix}/bin/wine
}

livecheck.check     sourceforge
livecheck.regex     "<title>Source Packages (.*) released.*</title>"
