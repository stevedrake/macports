--- Makefile.orig	2010-03-12 04:59:41.000000000 -0600
+++ Makefile	2010-04-12 17:08:03.000000000 -0500
@@ -30,7 +30,7 @@
 
 CFLAGS+=-std=c99 $(INC)
 
-all: xdotool xdotool.1 libxdo.so libxdo.so.$(MAJOR)
+all: xdotool xdotool.1 libxdo.dylib libxdo.$(MAJOR).dylib
 
 install: pre-install installlib installprog installman installheader
 
@@ -41,10 +41,10 @@
 	install -d $(DINSTALLBIN)
 	install -m 755 xdotool $(DINSTALLBIN)/
 
-installlib: libxdo.so
+installlib: libxdo.dylib
 	install -d $(DINSTALLLIB)
-	install libxdo.so $(DINSTALLLIB)/libxdo.so.$(MAJOR)
-	ln -sf libxdo.so.$(MAJOR) $(DINSTALLLIB)/libxdo.so
+	install libxdo.dylib $(DINSTALLLIB)/libxdo.$(MAJOR).dylib
+	ln -sf libxdo.$(MAJOR).dylib $(DINSTALLLIB)/libxdo.dylib
 
 installheader: xdo.h
 	install -d $(DINSTALLINCLUDE)
@@ -77,13 +77,13 @@
 xdo.c: xdo.h
 xdotool.c: xdo.h
 
-libxdo.so: xdo.o xdo_search.o
-	$(CC) $(LDFLAGS) -shared -Wl,-soname=libxdo.so.$(MAJOR) xdo.o xdo_search.o -o $@ $(LIBS)
+libxdo.dylib: xdo.o xdo_search.o
+	$(CC) $(LDFLAGS) -dynamiclib -Wl,-install_name,$(INSTALLLIB)/libxdo.$(MAJOR).dylib xdo.o xdo_search.o -o $@ $(LIBS)
 
-libxdo.so.$(MAJOR): libxdo.so
+libxdo.$(MAJOR).dylib: libxdo.dylib
 	ln -s $< $@
 
-xdotool: xdotool.o libxdo.so 
+xdotool: xdotool.o libxdo.dylib 
 	$(CC) -o $@ xdotool.o -L. -lxdo $(LDFLAGS) 
 
 xdotool.1: xdotool.pod
@@ -91,7 +91,7 @@
 
 package: test-package-build create-package
 
-test: xdotool libxdo.so.$(MAJOR)
+test: xdotool libxdo.$(MAJOR).dylib
 	$(MAKE) -C t
 
 xdo_version.h:
