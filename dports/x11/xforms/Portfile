# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0

name                xforms
version             1.0.92sp2
categories          x11
maintainers         raphael openmaintainer
description         A graphical user interface toolkit for X based on the X11 \
                    Xlib library
long_description    XForms is a graphical user interface toolkit for X based on \
                    the X11 Xlib library. It's written in C and allows to easily \
                    write GUIs for programs. For that it comes with a lot of \
                    widgets (buttons, menus, input fields, scrollbars, you name \
                    it) as well as fdesign, a tool that lets you create a GUI \
                    using a GUI. In addition, the library is extensible and new \
                    objects can easily be created and added to the library.
homepage            http://xforms-toolkit.org/
license             LGPL-2.1
platforms           darwin
master_sites        savannah
livecheck.url       http://download.savannah.gnu.org/releases-noredirect/${name}/
livecheck.regex     "${name}-(\[0-9\\.\]+)\\${extract.suffix}"

distfiles-append    ${name}.html${extract.suffix} \
                    ${name}.pdf
dist_subdir         ${name}/${version}

checksums           ${distname}${extract.suffix} \
                        md5     3c2806dff3022c536eabd93d32e3dab7 \
                        sha1    32753ccafa591537ca8eb002809d279d04db5a54 \
                        rmd160  4b5739dd8232a5d018240717ea28fb9df7b36aa4 \
                    ${name}.html${extract.suffix} \
                        md5     46fb9e845b1fb9ed6b6bb34074e4d257 \
                        sha1    1ca4d77d7060c8a59f21c8e4bad4f83d9b9fdb14 \
                        rmd160  4668e204e161b1c5749e6977aa58dcce628904be \
                    ${name}.pdf \
                        md5     b713c627bf64f46fd958c6b56eb279a2 \
                        sha1    aaed71323173e47396998f9fee6f7fb590c1f84e \
                        rmd160  a968d3bbeaebd56066027100d19c33c1660940db

depends_lib         port:xorg-libsm \
	            port:xorg-libXau \
                    port:xorg-libXdmcp \
                    port:xorg-libX11 \
                    port:xpm \
                    port:gettext \
                    port:libiconv \
                    port:mesa \
	            port:jpeg
depends_build       port:automake \
                    port:autoconf

extract.only-delete ${name}.pdf

patchfiles          patch-lib_Makefile.am.diff \
                    patch-gl_Makefile.am.diff \
                    patch-image_Makefile.am.diff

pre-configure {     system "cd ${worksrcpath} && ./autogen.sh"
}
configure.args      --enable-demos

post-destroot {     set docdir ${destroot}${prefix}/share/doc/${name}
                    xinstall -d ${docdir}
                    xinstall -m 644 -W ${worksrcpath} \
                        COPYING.LIB \
                        ChangeLog \
                        Copyright \
                        NEWS \
                        README \
                        ${docdir}
                    copy ${workpath}/${name}.html ${docdir}
                    copy ${prefix}/var/macports/distfiles/${dist_subdir}/${name}.pdf ${docdir}
                    system "cd ${worksrcpath}/demos && make mostlyclean"
                    xinstall -d ${destroot}${prefix}/share/${name}
                    copy ${worksrcpath}/demos \
                        ${destroot}${prefix}/share/${name}/
}

# not trivial to autoreconf
universal_variant no
