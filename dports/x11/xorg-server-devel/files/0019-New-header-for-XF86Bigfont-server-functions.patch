From abf4e0b7e349b0238b2b97a16b8a308b5026af31 Mon Sep 17 00:00:00 2001
From: Yaakov Selkowitz <yselkowitz@users.sourceforge.net>
Date: Mon, 22 Mar 2010 00:44:28 -0500
Subject: [PATCH 19/37] New header for XF86Bigfont server functions

Xext/xf86bigfont.c contains three non-static functions which are called
elsewhere in the server.  This creates a new header containing these
declarations in order to fix several warnings:

xf86bigfont.c:285: warning: no previous prototype for `XF86BigfontFreeFontShm'
dixfonts.c:502: warning: implicit declaration of function `XF86BigfontFreeFontS$
dixfonts.c:502: warning: nested extern declaration of `XF86BigfontFreeFontShm'
log.c:436: warning: implicit declaration of function `XF86BigfontCleanup'
log.c:436: warning: nested extern declaration of `XF86BigfontCleanup'

Signed-off-by: Yaakov Selkowitz <yselkowitz@users.sourceforge.net>
Reviewed-by: Julien Cristau <jcristau@debian.org>
---
 Xext/Makefile.am      |    2 +-
 Xext/xf86bigfont.c    |    1 +
 Xext/xf86bigfontsrv.h |   34 ++++++++++++++++++++++++++++++++++
 dix/dixfonts.c        |    3 +--
 os/log.c              |    3 +--
 5 files changed, 38 insertions(+), 5 deletions(-)
 create mode 100644 Xext/xf86bigfontsrv.h

diff --git xorg-server-1.7.99.902/Xext/Makefile.am xorg-server-1.7.99.902/Xext/Makefile.am
index 193d6e5..53cbc1f 100644
--- xorg-server-1.7.99.902/Xext/Makefile.am
+++ xorg-server-1.7.99.902/Xext/Makefile.am
@@ -107,7 +107,7 @@ MODULE_SRCS  += $(MULTIBUFFER_SRCS)
 endif
 
 # XF86 Big Font extension
-BIGFONT_SRCS = xf86bigfont.c
+BIGFONT_SRCS = xf86bigfont.c xf86bigfontsrv.h
 if XF86BIGFONT
 BUILTIN_SRCS += $(BIGFONT_SRCS)
 endif
diff --git xorg-server-1.7.99.902/Xext/xf86bigfont.c xorg-server-1.7.99.902/Xext/xf86bigfont.c
index ce33fda..a4eb3f6 100644
--- xorg-server-1.7.99.902/Xext/xf86bigfont.c
+++ xorg-server-1.7.99.902/Xext/xf86bigfont.c
@@ -74,6 +74,7 @@
 #include "protocol-versions.h"
 
 #include <X11/extensions/xf86bigfproto.h>
+#include "xf86bigfontsrv.h"
 
 static void XF86BigfontResetProc(
     ExtensionEntry *	/* extEntry */
diff --git xorg-server-1.7.99.902/Xext/xf86bigfontsrv.h xorg-server-1.7.99.902/Xext/xf86bigfontsrv.h
new file mode 100644
index 0000000..2c78dc4
--- /dev/null
+++ xorg-server-1.7.99.902/Xext/xf86bigfontsrv.h
@@ -0,0 +1,34 @@
+/*
+ * Copyright Â© 2010 Yaakov Selkowitz
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining
+ * a copy of this software and associated documentation files (the
+ * "Software"), to deal in the Software without restriction, including
+ * without limitation the rights to use, copy, modify, merge, publish,
+ * distribute, sublicense, and/or sell copies of the Software, and to
+ * permit persons to whom the Software is furnished to do so, subject to
+ * the following conditions:
+ *
+ * The above copyright notice and this permission notice (including the
+ * next paragraph) shall be included in all copies or substantial portions
+ * of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
+ * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+ * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
+ * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
+ * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
+ * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
+ * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+ */
+
+#ifndef _XF86BIGFONTSRV_H_
+#define _XF86BIGFONTSRV_H_
+
+#include <X11/fonts/font.h>
+
+extern void XFree86BigfontExtensionInit(void);
+extern void XF86BigfontFreeFontShm(FontPtr);
+extern void XF86BigfontCleanup(void);
+
+#endif
diff --git xorg-server-1.7.99.902/dix/dixfonts.c xorg-server-1.7.99.902/dix/dixfonts.c
index 329318d..6dc8193 100644
--- xorg-server-1.7.99.902/dix/dixfonts.c
+++ xorg-server-1.7.99.902/dix/dixfonts.c
@@ -71,8 +71,7 @@ Equipment Corporation.
 #endif
 
 #ifdef XF86BIGFONT
-#define _XF86BIGFONT_SERVER_
-#include <X11/extensions/xf86bigfont.h>
+#include "xf86bigfontsrv.h"
 #endif
 
 #define QUERYCHARINFO(pci, pr)  *(pr) = (pci)->metrics
diff --git xorg-server-1.7.99.902/os/log.c xorg-server-1.7.99.902/os/log.c
index 0002e59..f4832c1 100644
--- xorg-server-1.7.99.902/os/log.c
+++ xorg-server-1.7.99.902/os/log.c
@@ -99,8 +99,7 @@ OR PERFORMANCE OF THIS SOFTWARE.
 #endif
 
 #ifdef XF86BIGFONT
-#define _XF86BIGFONT_SERVER_
-#include <X11/extensions/xf86bigfont.h>
+#include "xf86bigfontsrv.h"
 #endif
 
 #ifdef DDXOSVERRORF
-- 
1.7.0.2

