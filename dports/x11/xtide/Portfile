# $Id: Portfile,v 1.1 2005/10/19 04:07:31 jberry Exp $

PortSystem 1.0

name					xtide
version					2.8.2

categories				x11 science
platforms				darwin
maintainers				darwinports@opendarwin.org jberry@darwinports.org

description				Tide prediction software, with a large database of locations.
long_description		XTide is a package that provides tide and current predictions \
						in a wide variety of formats.Â  Graphs, text listings, and calendars \
						can be generated, or a tide clock can be provided on your desktop. \
						For x11, plain command line, and as an http server.

homepage				http://www.flaterco.com/xtide
master_sites			ftp://www.flaterco.com/xtide

set harmonics_version	20050905
set harmonics_file		harmonics-dwf-${harmonics_version}.tcd.gz

distfiles				${distname}${extract.suffix} \
						${harmonics_file}
checksums				${distname}${extract.suffix} md5 3218480ad7e147549b56cfa9fa103b50 \
						${harmonics_file} md5 48a952a7705bcb6a964e95d87b4059e2
patchfiles				patch-Makefile.in
extract.only			${distname}${extract.suffix}

depends_lib				port:libpng
configure.args			--mandir=${prefix}/share/man

post-patch {
	# Make the default harmonics path conveniently point to our file
	reinplace s|harmonics.tcd|${prefix}/share/${name}/harmonics.tcd| ${worksrcpath}/TideContext.cc
}

post-destroot {
	xinstall -d -m 755 ${destroot}${prefix}/share/xtide
	xinstall -m 644 ${distpath}/${harmonics_file} ${destroot}${prefix}/share/${name}/harmonics.tcd.gz
	system "gzip -d ${destroot}${prefix}/share/${name}/harmonics.tcd.gz"
}